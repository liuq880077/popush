var VERSION="1.0.3";var SOCKET_IO="/";var SAVE_TIME_OUT=1e3;var ENABLE_RUN=true;var ENABLE_DEBUG=true;(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p="1.9.1",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,E=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,j=/^-ms-/,D=/-([\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(o.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,"@").replace(A,"]").replace(E,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,"ms-").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call("﻿ ")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),"complete"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{o.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e="string"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),r=d.getElementsByTagName("a")[0],!n||!r||!n.length)return{};s=o.createElement("select"),l=s.appendChild(o.createElement("option")),a=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,b(function(){var n,r,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(o.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)}),n=s=u=l=r=a=null,t}();var O=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u="string"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(B,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=b._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\t\r\n]/g,U=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?"addClass":"removeClass"](o)}else(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o="":"number"==typeof o?o+="":b.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(U,""):null==n?"":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&"get"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&"set"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),o="boolean"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(w)||[""],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),u=0>g.indexOf(":")&&"on"+g,n=n[b.expando]?n:new b.Event(g,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,"events")||{})[n.type]&&b._data(l,"handle"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===g&&b.nodeName(i,"a")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,"events")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x="sizzle"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=F.replace("w","w#"),B="([*^$|!~]?=)",P="\\["+_+"*("+F+")"+_+"*(?:"+B+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+O+")|)|)"+_+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+P.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),$=RegExp("^"+_+"*,"+_+"*"),I=RegExp("^"+_+"*([\\x20\\t\\r\\n\\f>+~])"+_+"*"),z=RegExp(R),X=RegExp("^"+O+"$"),U={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+R),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),needsContext:RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,Y=/^[^{]+\{\s*\[native code/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute("id"))?g=f.replace(K,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(",")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute("id")}}}return wt(e.replace(W,"$1"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),T.attributes=at(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),T.getByClassName=at(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[":focus"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+_+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||h.push(":checked")}),at(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&h.push("[*^$]="+_+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",R)}),h=RegExp(h.join("|")),g=RegExp(g.join("|")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,"='$1']"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+" "];return t||(t=RegExp("(^|"+_+")"+e+"("+_+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[x]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,"$1"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&"parentNode"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+" "+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,"$1"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG("*",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&"ID"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[":"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\[\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(o),Dt=jt.appendChild(o.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||"string"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,"tr"),s=b.map(Ot(l,"script"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,"script"))),r.call(n&&b.nodeName(this[c],"table")?Lt(this[c],"tbody"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,"script"),r.length>0&&Mt(r,!u&&Ot(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),u=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o="table"!==u||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],"tbody")&&!l.childNodes.length&&o.removeChild(l)}b.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),"script"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+x+")(.*)$","i"),Yt=RegExp("^("+x+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+x+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=b._data(r,"olddisplay",un(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||b.cssNumber[u]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left="fontSize"===n?"1em":u,u=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===u?"auto":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=b.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=b.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=b.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=b.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),"none"!==n&&n||(Pt=(Pt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==b.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=a.href}catch(Ln){yn=o.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return"string"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o["*"]&&s("*")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&b.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks("once memory"),m=p.statusCode||{},y={},v={},x=0,T="canceled",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||"*").toLowerCase().match(w)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&N.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader("Content-Type",p.contentType),N.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T="abort";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger("ajaxSend",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort("timeout")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||"",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader("Last-Modified"),T&&(b.lastModified[o]=T),T=N.getResponseHeader("etag"),T&&(b.etag[o]=T)),204===e?(c=!0,C="nocontent"):304===e?(c=!0,C="notmodified"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+"",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?"ajaxSuccess":"ajaxError",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger("ajaxComplete",[N,p]),--b.active||b.event.trigger("ajaxStop")))}return N},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while("*"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+" "+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if("*"!==r){if("*"!==l&&l!==r){if(i=a[l+" "+r]||a["* "+r],!i)for(n in a)if(o=n.split(" "),o[1]===r&&(i=a[l+" "+o[0]]||a["* "+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+l+" to "+r}}}l=r}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||b("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||b.expando+"_"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&"withCredentials"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),"string"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+x+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||".5",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn["*"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&"expand"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==un(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||"toggle"===a,a===(m?"hide":"show"))continue;g.push(i)}if(o=g.length){s=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,"fxshow");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),o=i.offset(),a=b.css(e,"top"),s=b.css(e,"left"),u=("absolute"===r||"fixed"===r)&&b.inArray("auto",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),"using"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})})(window);(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){var pluses=/\+/g;function raw(s){return s}function decoded(s){return decodeURIComponent(s.replace(pluses," "))}function converted(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return config.json?JSON.parse(s):s}catch(er){}}var config=$.cookie=function(key,value,options){if(value!==undefined){options=$.extend({},config.defaults,options);if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=config.json?JSON.stringify(value):String(value);return document.cookie=[config.raw?key:encodeURIComponent(key),"=",config.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}var decode=config.raw?raw:decoded;var cookies=document.cookie.split("; ");var result=key?undefined:{};for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("=");var name=decode(parts.shift());var cookie=decode(parts.join("="));if(key&&key===name){result=converted(cookie);break}if(!key){result[name]=converted(cookie)}}return result};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,"",$.extend({},options,{expires:-1}));return true}return false}});var io="undefined"==typeof module?{}:module.exports;(function(){(function(a,b){var c=a;c.version="0.9.11",c.protocol=1,c.transports=[],c.j=[],c.sockets={},c.connect=function(a,d){var e=c.util.parseUri(a),f,g;b&&b.location&&(e.protocol=e.protocol||b.location.protocol.slice(0,-1),e.host=e.host||(b.document?b.document.domain:b.location.hostname),e.port=e.port||b.location.port),f=c.util.uniqueUri(e);var h={host:e.host,secure:"https"==e.protocol,port:e.port||("https"==e.protocol?443:80),query:e.query||""};c.util.merge(h,d);if(h["force new connection"]||!c.sockets[f])g=new c.Socket(h);return!h["force new connection"]&&g&&(c.sockets[f]=g),g=g||c.sockets[f],g.of(e.path.length>1?e.path:"")}})("object"==typeof module?module.exports:this.io={},this),function(a,b){var c=a.util={},d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];c.parseUri=function(a){var b=d.exec(a||""),c={},f=14;while(f--)c[e[f]]=b[f]||"";return c},c.uniqueUri=function(a){var c=a.protocol,d=a.host,e=a.port;return"document"in b?(d=d||document.domain,e=e||(c=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(d=d||"localhost",!e&&c=="https"&&(e=443)),(c||"http")+"://"+d+":"+(e||80)},c.query=function(a,b){var d=c.chunkQuery(a||""),e=[];c.merge(d,c.chunkQuery(b||""));for(var f in d)d.hasOwnProperty(f)&&e.push(f+"="+d[f]);return e.length?"?"+e.join("&"):""},c.chunkQuery=function(a){var b={},c=a.split("&"),d=0,e=c.length,f;for(;d<e;++d)f=c[d].split("="),f[0]&&(b[f[0]]=f[1]);return b};var f=!1;c.load=function(a){if("document"in b&&document.readyState==="complete"||f)return a();c.on(b,"load",a,!1)},c.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},c.request=function(a){if(a&&"undefined"!=typeof XDomainRequest&&!c.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!a||c.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(b){}return null},"undefined"!=typeof window&&c.load(function(){f=!0}),c.defer=function(a){if(!c.ua.webkit||"undefined"!=typeof importScripts)return a();c.load(function(){setTimeout(a,100)})},c.merge=function(b,d,e,f){var g=f||[],h=typeof e=="undefined"?2:e,i;for(i in d)d.hasOwnProperty(i)&&c.indexOf(g,i)<0&&(typeof b[i]!="object"||!h?(b[i]=d[i],g.push(d[i])):c.merge(b[i],d[i],h-1,g));return b},c.mixin=function(a,b){c.merge(a.prototype,b.prototype)},c.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c},c.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},c.intersect=function(a,b){var d=[],e=a.length>b.length?a:b,f=a.length>b.length?b:a;for(var g=0,h=f.length;g<h;g++)~c.indexOf(e,f[g])&&d.push(f[g]);return d},c.indexOf=function(a,b,c){for(var d=a.length,c=c<0?c+d<0?0:c+d:c||0;c<d&&a[c]!==b;c++);return d<=c?-1:c},c.toArray=function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(a[c]);return b},c.ua={},c.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(b){return!1}return a.withCredentials!=undefined}(),c.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),c.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(a,b){function c(){}a.EventEmitter=c,c.prototype.on=function(a,c){return this.$events||(this.$events={}),this.$events[a]?b.util.isArray(this.$events[a])?this.$events[a].push(c):this.$events[a]=[this.$events[a],c]:this.$events[a]=c,this},c.prototype.addListener=c.prototype.on,c.prototype.once=function(a,b){function d(){c.removeListener(a,d),b.apply(this,arguments)}var c=this;return d.listener=b,this.on(a,d),this},c.prototype.removeListener=function(a,c){if(this.$events&&this.$events[a]){var d=this.$events[a];if(b.util.isArray(d)){var e=-1;for(var f=0,g=d.length;f<g;f++)if(d[f]===c||d[f].listener&&d[f].listener===c){e=f;break}if(e<0)return this;d.splice(e,1),d.length||delete this.$events[a]}else(d===c||d.listener&&d.listener===c)&&delete this.$events[a]}return this},c.prototype.removeAllListeners=function(a){return a===undefined?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},c.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),b.util.isArray(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},c.prototype.emit=function(a){if(!this.$events)return!1;var c=this.$events[a];if(!c)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof c)c.apply(this,d);else{if(!b.util.isArray(c))return!1;var e=c.slice();for(var f=0,g=e.length;f<g;f++)e[f].apply(this,d)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function f(a){return a<10?"0"+a:a}function date(a,b){return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i instanceof Date&&(i=date(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict";if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,typeof JSON!="undefined"?JSON:undefined),function(a,b){var c=a.parser={},d=c.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],e=c.reasons=["transport not supported","client not handshaken","unauthorized"],f=c.advice=["reconnect"],g=b.JSON,h=b.util.indexOf;c.encodePacket=function(a){var b=h(d,a.type),c=a.id||"",i=a.endpoint||"",j=a.ack,k=null;switch(a.type){case"error":var l=a.reason?h(e,a.reason):"",m=a.advice?h(f,a.advice):"";if(l!==""||m!=="")k=l+(m!==""?"+"+m:"");break;case"message":a.data!==""&&(k=a.data);break;case"event":var n={name:a.name};a.args&&a.args.length&&(n.args=a.args),k=g.stringify(n);break;case"json":k=g.stringify(a.data);break;case"connect":a.qs&&(k=a.qs);break;case"ack":k=a.ackId+(a.args&&a.args.length?"+"+g.stringify(a.args):"")}var o=[b,c+(j=="data"?"+":""),i];return k!==null&&k!==undefined&&o.push(k),o.join(":")},c.encodePayload=function(a){var b="";if(a.length==1)return a[0];for(var c=0,d=a.length;c<d;c++){var e=a[c];b+="�"+e.length+"�"+a[c]}return b};var i=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;c.decodePacket=function(a){var b=a.match(i);if(!b)return{};var c=b[2]||"",a=b[5]||"",h={type:d[b[1]],endpoint:b[4]||""};c&&(h.id=c,b[3]?h.ack="data":h.ack=!0);switch(h.type){case"error":var b=a.split("+");h.reason=e[b[0]]||"",h.advice=f[b[1]]||"";break;case"message":h.data=a||"";break;case"event":try{var j=g.parse(a);h.name=j.name,h.args=j.args}catch(k){}h.args=h.args||[];break;case"json":try{h.data=g.parse(a)}catch(k){}break;case"connect":h.qs=a||"";break;case"ack":var b=a.match(/^([0-9]+)(\+)?(.*)/);if(b){h.ackId=b[1],h.args=[];if(b[3])try{h.args=b[3]?g.parse(b[3]):[]}catch(k){}}break;case"disconnect":case"heartbeat":}return h},c.decodePayload=function(a){if(a.charAt(0)=="�"){var b=[];for(var d=1,e="";d<a.length;d++)a.charAt(d)=="�"?(b.push(c.decodePacket(a.substr(d+1).substr(0,e))),d+=Number(e)+1,e=""):e+=a.charAt(d);return b}return[c.decodePacket(a)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b){function c(a,b){this.socket=a,this.sessid=b}a.Transport=c,b.util.mixin(c,b.EventEmitter),c.prototype.heartbeats=function(){return!0},c.prototype.onData=function(a){this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout();if(a!==""){var c=b.parser.decodePayload(a);if(c&&c.length)for(var d=0,e=c.length;d<e;d++)this.onPacket(c[d])}return this},c.prototype.onPacket=function(a){return this.socket.setHeartbeatTimeout(),a.type=="heartbeat"?this.onHeartbeat():(a.type=="connect"&&a.endpoint==""&&this.onConnect(),a.type=="error"&&a.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(a),this)},c.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}},c.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},c.prototype.onConnect=function(){return this.socket.onConnect(),this},c.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},c.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},c.prototype.packet=function(a){this.send(b.parser.encodePacket(a))},c.prototype.onHeartbeat=function(a){this.packet({type:"heartbeat"})},c.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},c.prototype.onClose=function(){var a=this;this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},c.prototype.prepareUrl=function(){var a=this.socket.options;return this.scheme()+"://"+a.host+":"+a.port+"/"+a.resource+"/"+b.protocol+"/"+this.name+"/"+this.sessid},c.prototype.ready=function(a,b){b.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(a){this.options={port:80,secure:!1,document:"document"in c?document:!1,resource:"socket.io",transports:b.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},b.util.merge(this.options,a),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||b.util.ua.hasCORS)){var d=this;b.util.on(c,"beforeunload",function(){d.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function e(){}a.Socket=d,b.util.mixin(d,b.EventEmitter),d.prototype.of=function(a){return this.namespaces[a]||(this.namespaces[a]=new b.SocketNamespace(this,a),a!==""&&this.namespaces[a].packet({type:"connect"})),this.namespaces[a]},d.prototype.publish=function(){this.emit.apply(this,arguments);var a;for(var b in this.namespaces)this.namespaces.hasOwnProperty(b)&&(a=this.of(b),a.$emit.apply(a,arguments))},d.prototype.handshake=function(a){function f(b){b instanceof Error?(c.connecting=!1,c.onError(b.message)):a.apply(null,b.split(":"))}var c=this,d=this.options,g=["http"+(d.secure?"s":"")+":/",d.host+":"+d.port,d.resource,b.protocol,b.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!b.util.ua.hasCORS){var h=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src=g+"&jsonp="+b.j.length,h.parentNode.insertBefore(i,h),b.j.push(function(a){f(a),i.parentNode.removeChild(i)})}else{var j=b.util.request();j.open("GET",g,!0),this.isXDomain()&&(j.withCredentials=!0),j.onreadystatechange=function(){j.readyState==4&&(j.onreadystatechange=e,j.status==200?f(j.responseText):j.status==403?c.onError(j.responseText):(c.connecting=!1,!c.reconnecting&&c.onError(j.responseText)))},j.send(null)}},d.prototype.getTransport=function(a){var c=a||this.transports,d;for(var e=0,f;f=c[e];e++)if(b.Transport[f]&&b.Transport[f].check(this)&&(!this.isXDomain()||b.Transport[f].xdomainCheck(this)))return new b.Transport[f](this,this.sessionid);return null},d.prototype.connect=function(a){if(this.connecting)return this;var c=this;return c.connecting=!0,this.handshake(function(d,e,f,g){function h(a){c.transport&&c.transport.clearTimeouts(),c.transport=c.getTransport(a);if(!c.transport)return c.publish("connect_failed");c.transport.ready(c,function(){c.connecting=!0,c.publish("connecting",c.transport.name),c.transport.open(),c.options["connect timeout"]&&(c.connectTimeoutTimer=setTimeout(function(){if(!c.connected){c.connecting=!1;if(c.options["try multiple transports"]){var a=c.transports;while(a.length>0&&a.splice(0,1)[0]!=c.transport.name);a.length?h(a):c.publish("connect_failed")}}},c.options["connect timeout"]))})}c.sessionid=d,c.closeTimeout=f*1e3,c.heartbeatTimeout=e*1e3,c.transports||(c.transports=c.origTransports=g?b.util.intersect(g.split(","),c.options.transports):c.options.transports),c.setHeartbeatTimeout(),h(c.transports),c.once("connect",function(){clearTimeout(c.connectTimeoutTimer),a&&typeof a=="function"&&a()})}),this},d.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);if(this.transport&&!this.transport.heartbeats())return;var a=this;this.heartbeatTimeoutTimer=setTimeout(function(){a.transport.onClose()},this.heartbeatTimeout)},d.prototype.packet=function(a){return this.connected&&!this.doBuffer?this.transport.packet(a):this.buffer.push(a),this},d.prototype.setBuffer=function(a){this.doBuffer=a,!a&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},d.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},d.prototype.disconnect=function(){if(this.connected||this.connecting)this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted");return this},d.prototype.disconnectSync=function(){var a=b.util.request(),c=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,b.protocol,"",this.sessionid].join("/")+"/?disconnect=1";a.open("GET",c,!1),a.send(null),this.onDisconnect("booted")},d.prototype.isXDomain=function(){var a=c.location.port||("https:"==c.location.protocol?443:80);return this.options.host!==c.location.hostname||this.options.port!=a},d.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},d.prototype.onOpen=function(){this.open=!0},d.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},d.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)},d.prototype.onError=function(a){a&&a.advice&&a.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",a&&a.reason?a.reason:a)},d.prototype.onDisconnect=function(a){var b=this.connected,c=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1;if(b||c)this.transport.close(),this.transport.clearTimeouts(),b&&(this.publish("disconnect",a),"booted"!=a&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},d.prototype.reconnect=function(){function e(){if(a.connected){for(var b in a.namespaces)a.namespaces.hasOwnProperty(b)&&""!==b&&a.namespaces[b].packet({type:"connect"});a.publish("reconnect",a.transport.name,a.reconnectionAttempts)}clearTimeout(a.reconnectionTimer),a.removeListener("connect_failed",f),a.removeListener("connect",f),a.reconnecting=!1,delete a.reconnectionAttempts,delete a.reconnectionDelay,delete a.reconnectionTimer,delete a.redoTransports,a.options["try multiple transports"]=c}function f(){if(!a.reconnecting)return;if(a.connected)return e();if(a.connecting&&a.reconnecting)return a.reconnectionTimer=setTimeout(f,1e3);a.reconnectionAttempts++>=b?a.redoTransports?(a.publish("reconnect_failed"),e()):(a.on("connect_failed",f),a.options["try multiple transports"]=!0,a.transports=a.origTransports,a.transport=a.getTransport(),a.redoTransports=!0,a.connect()):(a.reconnectionDelay<d&&(a.reconnectionDelay*=2),a.connect(),a.publish("reconnecting",a.reconnectionDelay,a.reconnectionAttempts),a.reconnectionTimer=setTimeout(f,a.reconnectionDelay))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var a=this,b=this.options["max reconnection attempts"],c=this.options["try multiple transports"],d=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(f,this.reconnectionDelay),this.on("connect",f)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a,b){this.socket=a,this.name=b||"",this.flags={},this.json=new d(this,"json"),this.ackPackets=0,this.acks={}}function d(a,b){this.namespace=a,this.name=b}a.SocketNamespace=c,b.util.mixin(c,b.EventEmitter),c.prototype.$emit=b.EventEmitter.prototype.emit,c.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},c.prototype.packet=function(a){return a.endpoint=this.name,this.socket.packet(a),this.flags={},this},c.prototype.send=function(a,b){var c={type:this.flags.json?"json":"message",data:a};return"function"==typeof b&&(c.id=++this.ackPackets,c.ack=!0,this.acks[c.id]=b),this.packet(c)},c.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),c=b[b.length-1],d={type:"event",name:a};return"function"==typeof c&&(d.id=++this.ackPackets,d.ack="data",this.acks[d.id]=c,b=b.slice(0,b.length-1)),d.args=b,this.packet(d)},c.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},c.prototype.onPacket=function(a){function d(){c.packet({type:"ack",args:b.util.toArray(arguments),ackId:a.id})}var c=this;switch(a.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?this.socket.onDisconnect(a.reason||"booted"):this.$emit("disconnect",a.reason);break;case"message":case"json":var e=["message",a.data];a.ack=="data"?e.push(d):a.ack&&this.packet({type:"ack",ackId:a.id}),this.$emit.apply(this,e);break;case"event":var e=[a.name].concat(a.args);a.ack=="data"&&e.push(d),this.$emit.apply(this,e);break;case"ack":this.acks[a.ackId]&&(this.acks[a.ackId].apply(this,a.args),delete this.acks[a.ackId]);break;case"error":a.advice?this.socket.onError(a):a.reason=="unauthorized"?this.$emit("connect_failed",a.reason):this.$emit("error",a.reason)}},d.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},d.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(a){b.Transport.apply(this,arguments)}a.websocket=d,b.util.inherit(d,b.Transport),d.prototype.name="websocket",d.prototype.open=function(){var a=b.util.query(this.socket.options.query),d=this,e;return e||(e=c.MozWebSocket||c.WebSocket),this.websocket=new e(this.prepareUrl()+a),this.websocket.onopen=function(){d.onOpen(),d.socket.setBuffer(!1)},this.websocket.onmessage=function(a){d.onData(a.data)},this.websocket.onclose=function(){d.onClose(),d.socket.setBuffer(!0)},this.websocket.onerror=function(a){d.onError(a)},this},b.util.ua.iDevice?d.prototype.send=function(a){var b=this;return setTimeout(function(){b.websocket.send(a)},0),this}:d.prototype.send=function(a){return this.websocket.send(a),this},d.prototype.payload=function(a){for(var b=0,c=a.length;b<c;b++)this.packet(a[b]);return this},d.prototype.close=function(){return this.websocket.close(),this},d.prototype.onError=function(a){this.socket.onError(a)},d.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},d.check=function(){return"WebSocket"in c&&!("__addTask"in WebSocket)||"MozWebSocket"in c},d.xdomainCheck=function(){return!0},b.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(){b.Transport.websocket.apply(this,arguments)}a.flashsocket=c,b.util.inherit(c,b.Transport.websocket),c.prototype.name="flashsocket",c.prototype.open=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.open.apply(a,c)}),this},c.prototype.send=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.send.apply(a,c)}),this},c.prototype.close=function(){return WebSocket.__tasks.length=0,b.Transport.websocket.prototype.close.call(this),this},c.prototype.ready=function(a,d){function e(){var b=a.options,e=b["flash policy port"],g=["http"+(b.secure?"s":"")+":/",b.host+":"+b.port,b.resource,"static/flashsocket","WebSocketMain"+(a.isXDomain()?"Insecure":"")+".swf"];c.loaded||(typeof WEB_SOCKET_SWF_LOCATION=="undefined"&&(WEB_SOCKET_SWF_LOCATION=g.join("/")),e!==843&&WebSocket.loadFlashPolicyFile("xmlsocket://"+b.host+":"+e),WebSocket.__initialize(),c.loaded=!0),d.call(f)}var f=this;if(document.body)return e();b.util.load(e)},c.check=function(){return typeof WebSocket!="undefined"&&"__initialize"in WebSocket&&!!swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},c.xdomainCheck=function(){return!0},typeof window!="undefined"&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),b.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);if("undefined"!=typeof window)var swfobject=function(){function A(){if(t)return;try{var a=i.getElementsByTagName("body")[0].appendChild(Q("span"));a.parentNode.removeChild(a)}catch(b){return}t=!0;var c=l.length;for(var d=0;d<c;d++)l[d]()}function B(a){t?a():l[l.length]=a}function C(b){if(typeof h.addEventListener!=a)h.addEventListener("load",b,!1);else if(typeof i.addEventListener!=a)i.addEventListener("load",b,!1);else if(typeof h.attachEvent!=a)R(h,"onload",b);else if(typeof h.onload=="function"){var c=h.onload;h.onload=function(){c(),b()}}else h.onload=b}function D(){k?E():F()}function E(){var c=i.getElementsByTagName("body")[0],d=Q(b);d.setAttribute("type",e);var f=c.appendChild(d);if(f){var g=0;(function(){if(typeof f.GetVariable!=a){var b=f.GetVariable("$version");b&&(b=b.split(" ")[1].split(","),y.pv=[parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10)])}else if(g<10){g++,setTimeout(arguments.callee,10);return}c.removeChild(d),f=null,F()})()}else F()}function F(){var b=m.length;if(b>0)for(var c=0;c<b;c++){var d=m[c].id,e=m[c].callbackFn,f={success:!1,id:d};if(y.pv[0]>0){var g=P(d);if(g)if(S(m[c].swfVersion)&&!(y.wk&&y.wk<312))U(d,!0),e&&(f.success=!0,f.ref=G(d),e(f));else if(m[c].expressInstall&&H()){var h={};h.data=m[c].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));I(h,i,d,e)}else J(g),e&&e(f)}else{U(d,!0);if(e){var n=G(d);n&&typeof n.SetVariable!=a&&(f.success=!0,f.ref=n),e(f)}}}}function G(c){var d=null,e=P(c);if(e&&e.nodeName=="OBJECT")if(typeof e.SetVariable!=a)d=e;else{var f=e.getElementsByTagName(b)[0];f&&(d=f)}return d}function H(){return!u&&S("6.0.65")&&(y.win||y.mac)&&!(y.wk&&y.wk<312)}function I(b,c,d,e){u=!0,r=e||null,s={success:!1,id:d};var g=P(d);if(g){g.nodeName=="OBJECT"?(p=K(g),q=null):(p=g,q=d),b.id=f;if(typeof b.width==a||!/%$/.test(b.width)&&parseInt(b.width,10)<310)b.width="310";if(typeof b.height==a||!/%$/.test(b.height)&&parseInt(b.height,10)<137)b.height="137";i.title=i.title.slice(0,47)+" - Flash Player Installation";var j=y.ie&&y.win?["Active"].concat("").join("X"):"PlugIn",k="MMredirectURL="+h.location.toString().replace(/&/g,"%26")+"&MMplayerType="+j+"&MMdoctitle="+i.title;typeof c.flashvars!=a?c.flashvars+="&"+k:c.flashvars=k;if(y.ie&&y.win&&g.readyState!=4){var l=Q("div");d+="SWFObjectNew",l.setAttribute("id",d),g.parentNode.insertBefore(l,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}()}L(b,c,d)}}function J(a){if(y.ie&&y.win&&a.readyState!=4){var b=Q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(K(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(K(a),a)}function K(a){var c=Q("div");if(y.win&&y.ie)c.innerHTML=a.innerHTML;else{var d=a.getElementsByTagName(b)[0];if(d){var e=d.childNodes;if(e){var f=e.length;for(var g=0;g<f;g++)(e[g].nodeType!=1||e[g].nodeName!="PARAM")&&e[g].nodeType!=8&&c.appendChild(e[g].cloneNode(!0))}}}return c}function L(c,d,f){var g,h=P(f);if(y.wk&&y.wk<312)return g;if(h){typeof c.id==a&&(c.id=f);if(y.ie&&y.win){var i="";for(var j in c)c[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?d.movie=c[j]:j.toLowerCase()=="styleclass"?i+=' class="'+c[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+c[j]+'"'));var k="";for(var l in d)d[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+d[l]+'" />');h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",n[n.length]=c.id,g=P(c.id)}else{var m=Q(b);m.setAttribute("type",e);for(var o in c)c[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?m.setAttribute("class",c[o]):o.toLowerCase()!="classid"&&m.setAttribute(o,c[o]));for(var p in d)d[p]!=Object.prototype[p]&&p.toLowerCase()!="movie"&&M(m,p,d[p]);h.parentNode.replaceChild(m,h),g=m}}return g}function M(a,b,c){var d=Q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function N(a){var b=P(a);b&&b.nodeName=="OBJECT"&&(y.ie&&y.win?(b.style.display="none",function(){b.readyState==4?O(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function O(a){var b=P(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function P(a){var b=null;try{b=i.getElementById(a)}catch(c){}return b}function Q(a){return i.createElement(a)}function R(a,b,c){a.attachEvent(b,c),o[o.length]=[a,b,c]}function S(a){var b=y.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function T(c,d,e,f){if(y.ie&&y.mac)return;var g=i.getElementsByTagName("head")[0];if(!g)return;var h=e&&typeof e=="string"?e:"screen";f&&(v=null,w=null);if(!v||w!=h){var j=Q("style");j.setAttribute("type","text/css"),j.setAttribute("media",h),v=g.appendChild(j),y.ie&&y.win&&typeof i.styleSheets!=a&&i.styleSheets.length>0&&(v=i.styleSheets[i.styleSheets.length-1]),w=h}y.ie&&y.win?v&&typeof v.addRule==b&&v.addRule(c,d):v&&typeof i.createTextNode!=a&&v.appendChild(i.createTextNode(c+" {"+d+"}"))}function U(a,b){if(!x)return;var c=b?"visible":"hidden";t&&P(a)?P(a).style.visibility=c:T("#"+a,"visibility:"+c)}function V(b){var c=/[\\\"<>\.;]/,d=c.exec(b)!=null;return d&&typeof encodeURIComponent!=a?encodeURIComponent(b):b}var a="undefined",b="object",c="Shockwave Flash",d="ShockwaveFlash.ShockwaveFlash",e="application/x-shockwave-flash",f="SWFObjectExprInst",g="onreadystatechange",h=window,i=document,j=navigator,k=!1,l=[D],m=[],n=[],o=[],p,q,r,s,t=!1,u=!1,v,w,x=!0,y=function(){var f=typeof i.getElementById!=a&&typeof i.getElementsByTagName!=a&&typeof i.createElement!=a,g=j.userAgent.toLowerCase(),l=j.platform.toLowerCase(),m=l?/win/.test(l):/win/.test(g),n=l?/mac/.test(l):/mac/.test(g),o=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof j.plugins!=a&&typeof j.plugins[c]==b)r=j.plugins[c].description,r&&(typeof j.mimeTypes==a||!j.mimeTypes[e]||!!j.mimeTypes[e].enabledPlugin)&&(k=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h[["Active"].concat("Object").join("X")]!=a)try{var s=new(window[["Active"].concat("Object").join("X")])(d);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:f,pv:q,wk:o,ie:p,win:m,mac:n}}(),z=function(){if(!y.w3)return;(typeof i.readyState!=a&&i.readyState=="complete"||typeof i.readyState==a&&(i.getElementsByTagName("body")[0]||i.body))&&A(),t||(typeof i.addEventListener!=a&&i.addEventListener("DOMContentLoaded",A,!1),y.ie&&y.win&&(i.attachEvent(g,function(){i.readyState=="complete"&&(i.detachEvent(g,arguments.callee),A())}),h==top&&function(){if(t)return;try{i.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}A()}()),y.wk&&function(){if(t)return;if(!/loaded|complete/.test(i.readyState)){setTimeout(arguments.callee,0);return}A()}(),C(A))}(),W=function(){y.ie&&y.win&&window.attachEvent("onunload",function(){var a=o.length;for(var b=0;b<a;b++)o[b][0].detachEvent(o[b][1],o[b][2]);var c=n.length;for(var d=0;d<c;d++)N(n[d]);for(var e in y)y[e]=null;y=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(y.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,m[m.length]=e,U(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(y.w3)return G(a)},embedSWF:function(c,d,e,f,g,h,i,j,k,l){var m={success:!1,id:d};y.w3&&!(y.wk&&y.wk<312)&&c&&d&&e&&f&&g?(U(d,!1),B(function(){e+="",f+="";var n={};if(k&&typeof k===b)for(var o in k)n[o]=k[o];n.data=c,n.width=e,n.height=f;var p={};if(j&&typeof j===b)for(var q in j)p[q]=j[q];if(i&&typeof i===b)for(var r in i)typeof p.flashvars!=a?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(S(g)){var s=L(n,p,d);n.id==d&&U(d,!0),m.success=!0,m.ref=s}else{if(h&&H()){n.data=h,I(n,p,d,l);return}U(d,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){x=!1},ua:y,getFlashPlayerVersion:function(){return{major:y.pv[0],minor:y.pv[1],release:y.pv[2]}},hasFlashPlayerVersion:S,createSWF:function(a,b,c){return y.w3?L(a,b,c):undefined},showExpressInstall:function(a,b,c,d){y.w3&&H()&&I(a,b,c,d)},removeSWF:function(a){y.w3&&N(a)},createCSS:function(a,b,c,d){y.w3&&T(a,b,c,d)},addDomLoadEvent:B,addLoadEvent:C,getQueryParamValue:function(a){var b=i.location.search||i.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return V(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return V(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(u){var a=P(f);a&&p&&(a.parentNode.replaceChild(p,a),q&&(U(q,!0),y.ie&&y.win&&(p.style.display="block")),r&&r(s)),u=!1}}}}();(function(){if("undefined"==typeof window||window.WebSocket)return;var a=window.console;if(!a||!a.log||!a.error)a={log:function(){},error:function(){}};if(!swfobject.hasFlashPlayerVersion("10.0.0")){a.error("Flash Player >= 10.0.0 is required.");return}location.protocol=="file:"&&a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(a,b,c,d,e){var f=this;f.__id=WebSocket.__nextId++,WebSocket.__instances[f.__id]=f,f.readyState=WebSocket.CONNECTING,f.bufferedAmount=0,f.__events={},b?typeof b=="string"&&(b=[b]):b=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(f.__id,a,b,c||null,d||0,e||null)})},0)},WebSocket.prototype.send=function(a){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var b=WebSocket.__flash.send(this.__id,encodeURIComponent(a));return b<0?!0:(this.bufferedAmount+=b,!1)},WebSocket.prototype.close=function(){if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING)return;this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id)},WebSocket.prototype.addEventListener=function(a,b,c){a in this.__events||(this.__events[a]=[]),this.__events[a].push(b)},WebSocket.prototype.removeEventListener=function(a,b,c){if(!(a in this.__events))return;var d=this.__events[a];for(var e=d.length-1;e>=0;--e)if(d[e]===b){d.splice(e,1);break}},WebSocket.prototype.dispatchEvent=function(a){var b=this.__events[a.type]||[];for(var c=0;c<b.length;++c)b[c](a);var d=this["on"+a.type];d&&d(a)},WebSocket.prototype.__handleEvent=function(a){"readyState"in a&&(this.readyState=a.readyState),"protocol"in a&&(this.protocol=a.protocol);var b;if(a.type=="open"||a.type=="error")b=this.__createSimpleEvent(a.type);else if(a.type=="close")b=this.__createSimpleEvent("close");else{if(a.type!="message")throw"unknown event type: "+a.type;var c=decodeURIComponent(a.message);b=this.__createMessageEvent("message",c)}this.dispatchEvent(b)},WebSocket.prototype.__createSimpleEvent=function(a){if(document.createEvent&&window.Event){var b=document.createEvent("Event");return b.initEvent(a,!1,!1),b}return{type:a,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(a,b){if(document.createEvent&&window.MessageEvent&&!window.opera){var c=document.createEvent("MessageEvent");return c.initMessageEvent("message",!1,!1,b,null,null,window,null),c}return{type:a,data:b,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(a){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(a)})},WebSocket.__initialize=function(){if(WebSocket.__flash)return;WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation);if(!window.WEB_SOCKET_SWF_LOCATION){a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}var b=document.createElement("div");b.id="webSocketContainer",b.style.position="absolute",WebSocket.__isFlashLite()?(b.style.left="0px",b.style.top="0px"):(b.style.left="-100px",b.style.top="-100px");var c=document.createElement("div");c.id="webSocketFlash",b.appendChild(c),document.body.appendChild(b),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(b){b.success||a.error("[WebSocket] swfobject.embedSWF failed")})},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var a=0;a<WebSocket.__tasks.length;++a)WebSocket.__tasks[a]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{var b=WebSocket.__flash.receiveEvents();for(var c=0;c<b.length;++c)WebSocket.__instances[b[c].webSocketId].__handleEvent(b[c])}catch(d){a.error(d)}},0),!0},WebSocket.__log=function(b){a.log(decodeURIComponent(b))},WebSocket.__error=function(b){a.error(decodeURIComponent(b))},WebSocket.__addTask=function(a){WebSocket.__flash?a():WebSocket.__tasks.push(a)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var a=window.navigator.mimeTypes["application/x-shockwave-flash"];return!a||!a.enabledPlugin||!a.enabledPlugin.filename?!1:a.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))})(),function(a,b,c){function d(a){if(!a)return;b.Transport.apply(this,arguments),this.sendBuffer=[]}function e(){}a.XHR=d,b.util.inherit(d,b.Transport),d.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},d.prototype.payload=function(a){var c=[];for(var d=0,e=a.length;d<e;d++)c.push(b.parser.encodePacket(a[d]));this.send(b.parser.encodePayload(c))},d.prototype.send=function(a){return this.post(a),this},d.prototype.post=function(a){function d(){this.readyState==4&&(this.onreadystatechange=e,b.posting=!1,this.status==200?b.socket.setBuffer(!1):b.onClose())}function f(){this.onload=e,b.socket.setBuffer(!1)}var b=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),c.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=f:this.sendXHR.onreadystatechange=d,this.sendXHR.send(a)},d.prototype.close=function(){return this.onClose(),this},d.prototype.request=function(a){var c=b.util.request(this.socket.isXDomain()),d=b.util.query(this.socket.options.query,"t="+ +new Date);c.open(a||"GET",this.prepareUrl()+d,!0);if(a=="POST")try{c.setRequestHeader?c.setRequestHeader("Content-type","text/plain;charset=UTF-8"):c.contentType="text/plain"}catch(e){}return c},d.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},d.check=function(a,d){try{var e=b.util.request(d),f=c.XDomainRequest&&e instanceof XDomainRequest,g=a&&a.options&&a.options.secure?"https:":"http:",h=c.location&&g!=c.location.protocol;if(e&&(!f||!h))return!0}catch(i){}return!1},d.xdomainCheck=function(a){return d.check(a,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b){function c(a){b.Transport.XHR.apply(this,arguments)}a.htmlfile=c,b.util.inherit(c,b.Transport.XHR),c.prototype.name="htmlfile",c.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var a=this.doc.createElement("div");a.className="socketio",this.doc.body.appendChild(a),this.iframe=this.doc.createElement("iframe"),a.appendChild(this.iframe);var c=this,d=b.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+d,b.util.on(window,"unload",function(){c.destroy()})},c.prototype._=function(a,b){this.onData(a);try{var c=b.getElementsByTagName("script")[0];c.parentNode.removeChild(c)}catch(d){}},c.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(a){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},c.prototype.close=function(){return this.destroy(),b.Transport.XHR.prototype.close.call(this)},c.check=function(a){if(typeof window!="undefined"&&["Active"].concat("Object").join("X")in window)try{var c=new(window[["Active"].concat("Object").join("X")])("htmlfile");return c&&b.Transport.XHR.check(a)}catch(d){}return!1},c.xdomainCheck=function(){return!1},b.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(a,b,c){function d(){b.Transport.XHR.apply(this,arguments)}function e(){}a["xhr-polling"]=d,b.util.inherit(d,b.Transport.XHR),b.util.merge(d,b.Transport.XHR),d.prototype.name="xhr-polling",d.prototype.heartbeats=function(){return!1},d.prototype.open=function(){var a=this;return b.Transport.XHR.prototype.open.call(a),!1},d.prototype.get=function(){function b(){this.readyState==4&&(this.onreadystatechange=e,this.status==200?(a.onData(this.responseText),a.get()):a.onClose())}function d(){this.onload=e,this.onerror=e,a.retryCounter=1,a.onData(this.responseText),a.get()}function f(){a.retryCounter++,!a.retryCounter||a.retryCounter>3?a.onClose():a.get()}if(!this.isOpen)return;var a=this;this.xhr=this.request(),c.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=d,this.xhr.onerror=f):this.xhr.onreadystatechange=b,this.xhr.send(null)},d.prototype.onClose=function(){b.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=e;try{this.xhr.abort()}catch(a){}this.xhr=null}},d.prototype.ready=function(a,c){var d=this;b.util.defer(function(){c.call(d)})},b.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(a,b,c){function e(a){b.Transport["xhr-polling"].apply(this,arguments),this.index=b.j.length;var c=this;b.j.push(function(a){c._(a)})}var d=c.document&&"MozAppearance"in c.document.documentElement.style;a["jsonp-polling"]=e,b.util.inherit(e,b.Transport["xhr-polling"]),e.prototype.name="jsonp-polling",e.prototype.post=function(a){function i(){j(),c.socket.setBuffer(!1)}function j(){c.iframe&&c.form.removeChild(c.iframe);try{h=document.createElement('<iframe name="'+c.iframeId+'">')}catch(a){h=document.createElement("iframe"),h.name=c.iframeId}h.id=c.iframeId,c.form.appendChild(h),c.iframe=h}var c=this,d=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var e=document.createElement("form"),f=document.createElement("textarea"),g=this.iframeId="socketio_iframe_"+this.index,h;e.className="socketio",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.display="none",e.target=g,e.method="POST",e.setAttribute("accept-charset","utf-8"),f.name="d",e.appendChild(f),document.body.appendChild(e),this.form=e,this.area=f}this.form.action=this.prepareUrl()+d,j(),this.area.value=b.JSON.stringify(a);try{this.form.submit()}catch(k){}this.iframe.attachEvent?h.onreadystatechange=function(){c.iframe.readyState=="complete"&&i()}:this.iframe.onload=i,this.socket.setBuffer(!0)},e.prototype.get=function(){var a=this,c=document.createElement("script"),e=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),c.async=!0,c.src=this.prepareUrl()+e,c.onerror=function(){a.onClose()};var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(c,f),this.script=c,d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},e.prototype._=function(a){return this.onData(a),this.isOpen&&this.get(),this},e.prototype.ready=function(a,c){var e=this;if(!d)return c.call(this);b.util.load(function(){c.call(e)})},e.check=function(){return"document"in c},e.xdomainCheck=function(){return!0},b.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),typeof define=="function"&&define.amd&&define([],function(){return io})})();(function(){function g(a){throw a}var j=void 0,k=!0,l=null,o=!1;function aa(a){return function(){return this[a]}}function q(a){return function(){return a}}var r,ba=this;function ca(){}function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function t(a){return a!==j}function ea(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function u(a){return"string"==typeof a}function fa(a){return"number"==typeof a}function ga(a){var b=typeof a;return"object"==b&&a!=l||"function"==b}Math.floor(2147483648*Math.random()).toString(36);function ha(a,b,c){return a.call.apply(a.bind,arguments)}function ia(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function v(a,b,c){v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return v.apply(l,arguments)}function ja(a,b){function c(){}c.prototype=b.prototype;a.Md=b.prototype;a.prototype=new c}function ka(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}g(Error("Invalid JSON string: "+a))}function la(){this.Xb=j}function ma(a,b,c){switch(typeof b){case"string":na(b,c);break;case"number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case"boolean":c.push(b);break;case"undefined":c.push("null");break;case"object":if(b==l){c.push("null");break}if("array"==da(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],ma(a,a.Xb?a.Xb.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),na(f,c),c.push(":"),ma(a,a.Xb?a.Xb.call(b,f,e):e,c),d=","));c.push("}");break;case"function":break;default:g(Error("Unknown type: "+typeof b))}}var oa={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},pa=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function na(a,b){b.push('"',a.replace(pa,function(a){if(a in oa)return oa[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return oa[a]=e+b.toString(16)}),'"')}function y(a){if("undefined"!==typeof JSON&&t(JSON.stringify))a=JSON.stringify(a);else{var b=[];ma(new la,a,b);a=b.join("")}return a}function qa(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,z(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320));128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function A(a,b,c,d){var e;d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c);e&&g(Error(a+" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+"."))}function B(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:ra.assert(o,"errorPrefix_ called with argumentNumber > 4.  Need to update it?")}return a+" failed: "+(d+" argument ")}function C(a,b,c,d){(!d||t(c))&&"function"!=da(c)&&g(Error(B(a,b,d)+"must be a valid function."))}function sa(a,b,c){t(c)&&(!ga(c)||c===l)&&g(Error(B(a,b,k)+"must be a valid context object."))}function D(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function ta(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}var ua={},ra={},va=/[\[\].#$\/]/,wa=/[\[\].#$]/;function xa(a){return u(a)&&0!==a.length&&!va.test(a)}function ya(a,b,c){(!c||t(b))&&za(B(a,1,c),b)}function za(a,b,c,d){c||(c=0);d||(d=[]);t(b)||g(Error(a+"contains undefined"+Aa(d)));"function"==da(b)&&g(Error(a+"contains a function"+Aa(d)+" with contents: "+b.toString()));Ba(b)&&g(Error(a+"contains "+b.toString()+Aa(d)));1e3<c&&g(new TypeError(a+"contains a cyclic object value ("+d.slice(0,100).join(".")+"...)"));u(b)&&b.length>10485760/3&&10485760<ua.Nd.Ld(b).length&&g(Error(a+"contains a string greater than 10485760 utf8 bytes"+Aa(d)+" ('"+b.substring(0,50)+"...')"));if(ga(b))for(var e in b)D(b,e)&&(".priority"!==e&&".value"!==e&&!xa(e)&&g(Error(a+"contains an invalid key ("+e+")"+Aa(d)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')),d.push(e),za(a,b[e],c+1,d),d.pop())}function Aa(a){return 0==a.length?"":" in property '"+a.join(".")+"'"}function Ca(a,b){ga(b)||g(Error(B(a,1,o)+" must be an object containing the children to replace."));ya(a,b,o)}function Da(a,b,c,d){(!d||t(c))&&c!==l&&!fa(c)&&!u(c)&&g(Error(B(a,b,d)+"must be a valid firebase priority (null or a string.)"))}function Ea(a,b,c){if(!c||t(b))switch(b){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:g(Error(B(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".'))}}function Fa(a,b){t(b)&&!xa(b)&&g(Error(B(a,2,k)+'must be a valid firebase key (non-empty string, not containing ".", "#", "$", "/", "[", or "]").'))}function Ga(a,b){(!u(b)||0===b.length||wa.test(b))&&g(Error(B(a,1,o)+'must be a non-empty string and can\'t contain ".", "#", "$", "[", or "]".'))}function E(a,b){".info"===F(b)&&g(Error(a+" failed: Can't modify data under /.info/"))}function H(a,b,c,d,e,f,h){this.u=a;this.path=b;this.ua=c;this.ca=d;this.ma=e;this.sa=f;this.Na=h;t(this.ca)&&t(this.sa)&&t(this.ua)&&g("Query: Can't combine startAt(), endAt(), and limit().")}H.prototype.qc=function(a,b){A("Query.on",2,4,arguments.length);Ea("Query.on",a,o);C("Query.on",2,b,o);var c=Ha("Query.on",arguments[2],arguments[3]);this.u.Eb(this,a,b,c.cancel,c.Z);return b};H.prototype.on=H.prototype.qc;H.prototype.Kb=function(a,b,c){A("Query.off",0,3,arguments.length);Ea("Query.off",a,k);C("Query.off",2,b,k);sa("Query.off",3,c);this.u.Wb(this,a,b,c)};H.prototype.off=H.prototype.Kb;H.prototype.xd=function(a,b){function c(h){f&&(f=o,e.Kb(a,c),b.call(d.Z,h))}A("Query.once",2,4,arguments.length);Ea("Query.once",a,o);C("Query.once",2,b,o);var d=Ha("Query.once",arguments[2],arguments[3]),e=this,f=k;this.qc(a,c,function(){e.Kb(a,c);d.cancel&&d.cancel.call(d.Z)})};H.prototype.once=H.prototype.xd;H.prototype.sd=function(a){A("Query.limit",1,1,arguments.length);(!fa(a)||Math.floor(a)!==a||0>=a)&&g("Query.limit: First argument must be a positive integer.");return new H(this.u,this.path,a,this.ca,this.ma,this.sa,this.Na)};H.prototype.limit=H.prototype.sd;H.prototype.Hd=function(a,b){A("Query.startAt",0,2,arguments.length);Da("Query.startAt",1,a,k);Fa("Query.startAt",b);t(a)||(b=a=l);return new H(this.u,this.path,this.ua,a,b,this.sa,this.Na)};H.prototype.startAt=H.prototype.Hd;H.prototype.md=function(a,b){A("Query.endAt",0,2,arguments.length);Da("Query.endAt",1,a,k);Fa("Query.endAt",b);return new H(this.u,this.path,this.ua,this.ca,this.ma,a,b)};H.prototype.endAt=H.prototype.md;function Ia(a){var b={};t(a.ca)&&(b.sp=a.ca);t(a.ma)&&(b.sn=a.ma);t(a.sa)&&(b.ep=a.sa);t(a.Na)&&(b.en=a.Na);t(a.ua)&&(b.l=a.ua);t(a.ca)&&t(a.ma)&&a.ca===l&&a.ma===l&&(b.vf="l");return b}H.prototype.Fa=function(){var a=Ja(Ia(this));return"{}"===a?"default":a};function Ha(a,b,c){var d={};b&&c?(d.cancel=b,C(a,3,d.cancel,k),d.Z=c,sa(a,4,d.Z)):b&&("object"===typeof b&&b!==l?d.Z=b:"function"===typeof b?d.cancel=b:g(Error(B(a,3,k)+"must either be a cancel callback or a context object.")));return d}function I(a){if(a instanceof I)return a;if(1==arguments.length){this.m=a.split("/");for(var b=0,c=0;c<this.m.length;c++)0<this.m[c].length&&(this.m[b]=this.m[c],b++);this.m.length=b;this.aa=0}else this.m=arguments[0],this.aa=arguments[1]}function F(a){return a.aa>=a.m.length?l:a.m[a.aa]}function J(a){var b=a.aa;b<a.m.length&&b++;return new I(a.m,b)}function Ka(a){return a.aa<a.m.length?a.m[a.m.length-1]:l}r=I.prototype;r.toString=function(){for(var a="",b=this.aa;b<this.m.length;b++)""!==this.m[b]&&(a+="/"+this.m[b]);return a||"/"};r.parent=function(){if(this.aa>=this.m.length)return l;for(var a=[],b=this.aa;b<this.m.length-1;b++)a.push(this.m[b]);return new I(a,0)};r.F=function(a){for(var b=[],c=this.aa;c<this.m.length;c++)b.push(this.m[c]);if(a instanceof I)for(c=a.aa;c<a.m.length;c++)b.push(a.m[c]);else{a=a.split("/");for(c=0;c<a.length;c++)0<a[c].length&&b.push(a[c])}return new I(b,0)};r.f=function(){return this.aa>=this.m.length};function La(a,b){var c=F(a);if(c===l)return b;if(c===F(b))return La(J(a),J(b));g("INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")")}r.contains=function(a){var b=0;if(this.m.length>a.m.length)return o;for(;b<this.m.length;){if(this.m[b]!==a.m[b])return o;++b}return k};function Ma(){this.children={};this.ic=0;this.value=l}function Na(a,b,c){this.va=a?a:"";this.ob=b?b:l;this.z=c?c:new Ma}function L(a,b){for(var c=b instanceof I?b:new I(b),d=a,e;(e=F(c))!==l;)d=new Na(e,d,ta(d.z.children,e)||new Ma),c=J(c);return d}r=Na.prototype;r.j=function(){return this.z.value};function N(a,b){z("undefined"!==typeof b);a.z.value=b;Oa(a)}r.bb=function(){return 0<this.z.ic};r.f=function(){return this.j()===l&&!this.bb()};r.w=function(a){for(var b in this.z.children)a(new Na(b,this,this.z.children[b]))};function Pa(a,b,c,d){c&&!d&&b(a);a.w(function(a){Pa(a,b,k,d)});c&&d&&b(a)}function Qa(a,b,c){for(a=c?a:a.parent();a!==l;){if(b(a))return k;a=a.parent()}return o}r.path=function(){return new I(this.ob===l?this.va:this.ob.path()+"/"+this.va)};r.name=aa("va");r.parent=aa("ob");function Oa(a){if(a.ob!==l){var b=a.ob,c=a.va,d=a.f(),e=D(b.z.children,c);d&&e?(delete b.z.children[c],b.z.ic--,Oa(b)):!d&&!e&&(b.z.children[c]=a.z,b.z.ic++,Oa(b))}}function Ra(a,b){this.Ka=a?a:Sa;this.ba=b?b:Va}function Sa(a,b){return a<b?-1:a>b?1:0}r=Ra.prototype;r.ja=function(a,b){return new Ra(this.Ka,this.ba.ja(a,b,this.Ka).copy(l,l,o,l,l))};r.remove=function(a){return new Ra(this.Ka,this.ba.remove(a,this.Ka).copy(l,l,o,l,l))};r.get=function(a){for(var b,c=this.ba;!c.f();){b=this.Ka(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return l};function Wa(a,b){for(var c,d=a.ba,e=l;!d.f();){c=a.Ka(b,d.key);if(0===c){if(d.left.f())return e?e.key:l;for(d=d.left;!d.right.f();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}g(Error("Attempted to find predecessor key for a nonexistent key.  What gives?"))}r.f=function(){return this.ba.f()};r.count=function(){return this.ba.count()};r.ib=function(){return this.ba.ib()};r.Qa=function(){return this.ba.Qa()};r.ta=function(a){return this.ba.ta(a)};r.Ga=function(a){return this.ba.Ga(a)};r.Oa=function(a){return new Xa(this.ba,a)};function Xa(a,b){this.Zc=b;for(this.Ib=[];!a.f();)this.Ib.push(a),a=a.left}function Ya(a){if(0===a.Ib.length)return l;var b=a.Ib.pop(),c;c=a.Zc?a.Zc(b.key,b.value):{key:b.key,value:b.value};for(b=b.right;!b.f();)a.Ib.push(b),b=b.left;return c}function Za(a,b,c,d,e){this.key=a;this.value=b;this.color=c!=l?c:k;this.left=d!=l?d:Va;this.right=e!=l?e:Va}r=Za.prototype;r.copy=function(a,b,c,d,e){return new Za(a!=l?a:this.key,b!=l?b:this.value,c!=l?c:this.color,d!=l?d:this.left,e!=l?e:this.right)};r.count=function(){return this.left.count()+1+this.right.count()};r.f=q(o);r.ta=function(a){return this.left.ta(a)||a(this.key,this.value)||this.right.ta(a)};r.Ga=function(a){return this.right.Ga(a)||a(this.key,this.value)||this.left.Ga(a)};function $a(a){return a.left.f()?a:$a(a.left)}r.ib=function(){return $a(this).key};r.Qa=function(){return this.right.f()?this.key:this.right.Qa()};r.ja=function(a,b,c){var d,e;e=this;d=c(a,e.key);e=0>d?e.copy(l,l,l,e.left.ja(a,b,c),l):0===d?e.copy(l,b,l,l,l):e.copy(l,l,l,l,e.right.ja(a,b,c));return ab(e)};function bb(a){if(a.left.f())return Va;!a.left.K()&&!a.left.left.K()&&(a=cb(a));a=a.copy(l,l,l,bb(a.left),l);return ab(a)}r.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))!c.left.f()&&!c.left.K()&&!c.left.left.K()&&(c=cb(c)),c=c.copy(l,l,l,c.left.remove(a,b),l);else{c.left.K()&&(c=db(c));!c.right.f()&&!c.right.K()&&!c.right.left.K()&&(c=eb(c),c.left.left.K()&&(c=db(c),c=eb(c)));if(0===b(a,c.key)){if(c.right.f())return Va;d=$a(c.right);c=c.copy(d.key,d.value,l,l,bb(c.right))}c=c.copy(l,l,l,l,c.right.remove(a,b))}return ab(c)};r.K=aa("color");function ab(a){a.right.K()&&!a.left.K()&&(a=fb(a));a.left.K()&&a.left.left.K()&&(a=db(a));a.left.K()&&a.right.K()&&(a=eb(a));return a}function cb(a){a=eb(a);a.right.left.K()&&(a=a.copy(l,l,l,l,db(a.right)),a=fb(a),a=eb(a));return a}function fb(a){var b;b=a.copy(l,l,k,l,a.right.left);return a.right.copy(l,l,a.color,b,l)}function db(a){var b;b=a.copy(l,l,k,a.left.right,l);return a.left.copy(l,l,a.color,l,b)}function eb(a){var b,c;b=a.left.copy(l,l,!a.left.color,l,l);c=a.right.copy(l,l,!a.right.color,l,l);return a.copy(l,l,!a.color,b,c)}function gb(){}r=gb.prototype;r.copy=function(){return this};r.ja=function(a,b){return new Za(a,b,j,j,j)};r.remove=function(){return this};r.get=q(l);r.count=q(0);r.f=q(k);r.ta=q(o);r.Ga=q(o);r.ib=q(l);r.Qa=q(l);r.K=q(o);var Va=new gb;var hb=Array.prototype,ib=hb.forEach?function(a,b,c){hb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},jb=hb.map?function(a,b,c){return hb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=u(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e};function kb(){}function lb(){this.B=[];this.hc=[];this.jd=[];this.Ob=[];this.Ob[0]=128;for(var a=1;64>a;++a)this.Ob[a]=0;this.reset()}ja(lb,kb);lb.prototype.reset=function(){this.B[0]=1732584193;this.B[1]=4023233417;this.B[2]=2562383102;this.B[3]=271733878;this.B[4]=3285377520;this.Fc=this.eb=0};function mb(a,b){var c;c||(c=0);for(var d=a.jd,e=c;e<c+64;e+=4)d[e/4]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3];for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}c=a.B[0];for(var h=a.B[1],i=a.B[2],m=a.B[3],n=a.B[4],p,e=0;80>e;e++)40>e?20>e?(f=m^h&(i^m),p=1518500249):(f=h^i^m,p=1859775393):60>e?(f=h&i|m&(h|i),p=2400959708):(f=h^i^m,p=3395469782),f=(c<<5|c>>>27)+f+n+p+d[e]&4294967295,n=m,m=i,i=(h<<30|h>>>2)&4294967295,h=c,c=f;a.B[0]=a.B[0]+c&4294967295;a.B[1]=a.B[1]+h&4294967295;a.B[2]=a.B[2]+i&4294967295;a.B[3]=a.B[3]+m&4294967295;a.B[4]=a.B[4]+n&4294967295}lb.prototype.update=function(a,b){t(b)||(b=a.length);var c=this.hc,d=this.eb,e=0;if(u(a))for(;e<b;)c[d++]=a.charCodeAt(e++),64==d&&(mb(this,c),d=0);else for(;e<b;)c[d++]=a[e++],64==d&&(mb(this,c),d=0);this.eb=d;this.Fc+=b};function nb(){this.Ja={};this.length=0}nb.prototype.setItem=function(a,b){D(this.Ja,a)||(this.length+=1);this.Ja[a]=b};nb.prototype.getItem=function(a){return D(this.Ja,a)?this.Ja[a]:l};nb.prototype.removeItem=function(a){D(this.Ja,a)&&(this.length-=1,delete this.Ja[a])};var ob=l;if("undefined"!==typeof sessionStorage)try{sessionStorage.setItem("firebase-sentinel","cache"),sessionStorage.removeItem("firebase-sentinel"),ob=sessionStorage}catch(pb){ob=new nb}else ob=new nb;function qb(a,b,c,d){this.host=a.toLowerCase();this.Yb=b;this.jb=c;this.da=d||ob.getItem(a)||this.host}function rb(a,b){b!==a.da&&(a.da=b,"s-"===a.da.substr(0,2)&&ob.setItem(a.host,a.da))}qb.prototype.toString=function(){return(this.Yb?"https://":"http://")+this.host};var sb,tb,ub,vb;function wb(){return ba.navigator?ba.navigator.userAgent:l}vb=ub=tb=sb=o;var xb;if(xb=wb()){var yb=ba.navigator;sb=0==xb.indexOf("Opera");tb=!sb&&-1!=xb.indexOf("MSIE");ub=!sb&&-1!=xb.indexOf("WebKit");vb=!sb&&!ub&&"Gecko"==yb.product}var zb=tb,Ab=vb,Bb=ub;var Cb;if(sb&&ba.opera){var Db=ba.opera.version;"function"==typeof Db&&Db()}else Ab?Cb=/rv\:([^\);]+)(\)|;)/:zb?Cb=/MSIE\s+([^\);]+)(\)|;)/:Bb&&(Cb=/WebKit\/(\S+)/),Cb&&Cb.exec(wb());var Eb=l,Fb=l;function Gb(a,b){ea(a)||g(Error("encodeByteArray takes an array as a parameter"));if(!Eb){Eb={};Fb={};for(var c=0;65>c;c++)Eb[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c),Fb[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(c)}for(var c=b?Fb:Eb,d=[],e=0;e<a.length;e+=3){var f=a[e],h=e+1<a.length,i=h?a[e+1]:0,m=e+2<a.length,n=m?a[e+2]:0,p=f>>2,f=(f&3)<<4|i>>4,i=(i&15)<<2|n>>6,n=n&63;m||(n=64,h||(i=64));d.push(c[p],c[f],c[i],c[n])}return d.join("")}var Hb,Ib=1;Hb=function(){return Ib++};function z(a,b){a||g(Error("Firebase INTERNAL ASSERT FAILED:"+b))}function Jb(a){var b=qa(a),a=new lb;a.update(b);var b=[],c=8*a.Fc;56>a.eb?a.update(a.Ob,56-a.eb):a.update(a.Ob,64-(a.eb-56));for(var d=63;56<=d;d--)a.hc[d]=c&255,c/=256;mb(a,a.hc);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c++]=a.B[d]>>e&255;return Gb(b)}function Kb(){for(var a="",b=0;b<arguments.length;b++)a=ea(arguments[b])?a+Kb.apply(l,arguments[b]):"object"===typeof arguments[b]?a+y(arguments[b]):a+arguments[b],a+=" ";return a}var Lb=l,Mb=k;function O(){Mb===k&&(Mb=o,Lb===l&&"true"===ob.getItem("logging_enabled")&&Nb(k));if(Lb){var a=Kb.apply(l,arguments);Lb(a)}}function Ob(a){return function(){O(a,arguments)}}function Pb(){if("undefined"!==typeof console){var a="FIREBASE INTERNAL ERROR: "+Kb.apply(l,arguments);"undefined"!==typeof console.error?console.error(a):console.log(a)}}function Qb(){var a=Kb.apply(l,arguments);g(Error("FIREBASE FATAL ERROR: "+a))}function Rb(){if("undefined"!==typeof console){var a="FIREBASE WARNING: "+Kb.apply(l,arguments);"undefined"!==typeof console.warn?console.warn(a):console.log(a)}}function Ba(a){return fa(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function Sb(a,b){return a!==b?a===l?-1:b===l?1:typeof a!==typeof b?"number"===typeof a?-1:1:a>b?1:-1:0}function Tb(a,b){if(b&&a in b)return b[a];g(Error("Missing required key ("+a+") in object: "+y(b)))}function Ja(a){if("object"!==typeof a||a===l)return y(a);var b=[],c;for(c in a)b.push(c);b.sort();c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=y(b[d]),c+=":",c+=Ja(a[b[d]]);return c+"}"}function Ub(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function Vb(a,b){if("array"==da(a))for(var c=0;c<a.length;++c)b(c,a[c]);else Wb(a,b)}function Yb(a){z(!Ba(a));var b,c,d,e;0===a?(d=c=0,b=-Infinity===1/a?1:0):(b=0>a,a=Math.abs(a),a>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,52))):(c=0,d=Math.round(a/Math.pow(2,-1074))));e=[];for(a=52;a;a-=1)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;a-=1)e.push(c%2?1:0),c=Math.floor(c/2);e.push(b?1:0);e.reverse();b=e.join("");c="";for(a=0;64>a;a+=8)d=parseInt(b.substr(a,8),2).toString(16),1===d.length&&(d="0"+d),c+=d;return c.toLowerCase()}function Zb(a,b){this.D=a;z(this.D!==l,"LeafNode shouldn't be created with null value.");this.Sa="undefined"!==typeof b?b:l}r=Zb.prototype;r.J=q(k);r.k=aa("Sa");r.Cb=function(a){return new Zb(this.D,a)};r.R=function(){return P};r.G=function(a){return F(a)===l?this:P};r.V=q(l);r.H=function(a,b){return new Q(new Ra,this.Sa).H(a,b)};r.pa=function(a,b){var c=F(a);return c===l?b:this.H(c,P.pa(J(a),b))};r.f=q(o);r.Jb=q(0);r.T=function(a){return a&&this.k()!==l?{".value":this.j(),".priority":this.k()}:this.j()};r.hash=function(){var a="";this.k()!==l&&(a+="priority:"+$b(this.k())+":");var b=typeof this.D,a=a+(b+":"),a="number"===b?a+Yb(this.D):a+this.D;return Jb(a)};r.j=aa("D");r.toString=function(){return"string"===typeof this.D?'"'+this.D+'"':this.D};function Q(a,b){this.n=a||new Ra;this.Sa="undefined"!==typeof b?b:l}r=Q.prototype;r.J=q(o);r.k=aa("Sa");r.Cb=function(a){return new Q(this.n,a)};r.H=function(a,b){var c=this.n.remove(a);b&&b.f()&&(b=l);b!==l&&(c=c.ja(a,b));return b&&b.k()!==l?new ac(c,l,this.Sa):new Q(c,this.Sa)};r.pa=function(a,b){var c=F(a);if(c===l)return b;var d=this.R(c).pa(J(a),b);return this.H(c,d)};r.f=function(){return this.n.f()};r.Jb=function(){return this.n.count()};var bc=/^\d+$/;r=Q.prototype;r.T=function(a){if(this.f())return l;var b={},c=0,d=0,e=k;this.w(function(f,h){b[f]=h.T(a);c++;e&&bc.test(f)?d=Math.max(d,Number(f)):e=o});if(!a&&e&&d<2*c){var f=[],h;for(h in b)f[h]=b[h];return f}a&&this.k()!==l&&(b[".priority"]=this.k());return b};r.hash=function(){var a="";this.k()!==l&&(a+="priority:"+$b(this.k())+":");this.w(function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)});return""===a?"":Jb(a)};r.R=function(a){a=this.n.get(a);return a===l?P:a};r.G=function(a){var b=F(a);return b===l?this:this.R(b).G(J(a))};r.V=function(a){return Wa(this.n,a)};r.Oc=function(){return this.n.ib()};r.Pc=function(){return this.n.Qa()};r.w=function(a){return this.n.ta(a)};r.mc=function(a){return this.n.Ga(a)};r.Oa=function(){return this.n.Oa()};r.toString=function(){var a="{",b=k;this.w(function(c,d){b?b=o:a+=", ";a+='"'+c+'" : '+d.toString()});return a+="}"};var P=new Q(new Ra);function ac(a,b,c){Q.call(this,a,c);b===l&&(b=new Ra(cc),a.ta(function(a,c){b=b.ja({name:a,wa:c.k()},c)}));this.la=b}ja(ac,Q);r=ac.prototype;r.H=function(a,b){var c=this.R(a),d=this.n,e=this.la;c!==l&&(d=d.remove(a),e=e.remove({name:a,wa:c.k()}));b&&b.f()&&(b=l);b!==l&&(d=d.ja(a,b),e=e.ja({name:a,wa:b.k()},b));return new ac(d,e,this.k())};r.V=function(a,b){var c=Wa(this.la,{name:a,wa:b.k()});return c?c.name:l};r.w=function(a){return this.la.ta(function(b,c){return a(b.name,c)})};r.mc=function(a){return this.la.Ga(function(b,c){return a(b.name,c)})};r.Oa=function(){return this.la.Oa(function(a,b){return{key:a.name,value:b}})};r.Oc=function(){return this.la.f()?l:this.la.ib().name};r.Pc=function(){return this.la.f()?l:this.la.Qa().name};function R(a,b){if("object"!==typeof a)return new Zb(a,b);if(a===l)return P;var c=l;".priority"in a?c=a[".priority"]:"undefined"!==typeof b&&(c=b);z(c===l||"string"===typeof c||"number"===typeof c);if(".value"in a&&a[".value"]!==l)return new Zb(a[".value"],c);var c=new Q(new Ra,c),d;for(d in a)if(D(a,d)&&"."!==d.substring(0,1)){var e=R(a[d]);if(e.J()||!e.f())c=c.H(d,e)}return c}function cc(a,b){return Sb(a.wa,b.wa)||(a.name!==b.name?a.name<b.name?-1:1:0)}function $b(a){return"number"===typeof a?"number:"+Yb(a):"string:"+a}function S(a,b){this.z=a;this.Vb=b}S.prototype.T=function(){A("Firebase.DataSnapshot.val",0,0,arguments.length);return this.z.T()};S.prototype.val=S.prototype.T;S.prototype.nd=function(){A("Firebase.DataSnapshot.exportVal",0,0,arguments.length);return this.z.T(k)};S.prototype.exportVal=S.prototype.nd;S.prototype.F=function(a){A("Firebase.DataSnapshot.child",0,1,arguments.length);fa(a)&&(a=String(a));Ga("Firebase.DataSnapshot.child",a);var b=new I(a),c=this.Vb.F(b);return new S(this.z.G(b),c)};S.prototype.child=S.prototype.F;S.prototype.nc=function(a){A("Firebase.DataSnapshot.hasChild",1,1,arguments.length);Ga("Firebase.DataSnapshot.hasChild",a);var b=new I(a);return!this.z.G(b).f()};S.prototype.hasChild=S.prototype.nc;S.prototype.k=function(){A("Firebase.DataSnapshot.getPriority",0,0,arguments.length);return this.z.k()};S.prototype.getPriority=S.prototype.k;S.prototype.forEach=function(a){A("Firebase.DataSnapshot.forEach",1,1,arguments.length);C("Firebase.DataSnapshot.forEach",1,a,o);if(this.z.J())return o;var b=this;return this.z.w(function(c,d){return a(new S(d,b.Vb.F(c)))})};S.prototype.forEach=S.prototype.forEach;S.prototype.bb=function(){A("Firebase.DataSnapshot.hasChildren",0,0,arguments.length);return this.z.J()?o:!this.z.f()};S.prototype.hasChildren=S.prototype.bb;S.prototype.name=function(){A("Firebase.DataSnapshot.name",0,0,arguments.length);return this.Vb.name()};S.prototype.name=S.prototype.name;S.prototype.Jb=function(){A("Firebase.DataSnapshot.numChildren",0,0,arguments.length);return this.z.Jb()};S.prototype.numChildren=S.prototype.Jb;S.prototype.zd=function(){A("Firebase.DataSnapshot.ref",0,0,arguments.length);return this.Vb};S.prototype.ref=S.prototype.zd;function dc(a){this.uc=a;this.Qb=[];this.Ma=0;this.jc=-1;this.Da=l}function Wb(a,b){for(var c in a)b.call(j,a[c],c,a)}function ec(a){var b={},c;for(c in a)b[c]=a[c];return b}function fc(){this.Za={}}function gc(a,b,c){t(c)||(c=1);D(a.Za,b)||(a.Za[b]=0);a.Za[b]+=c}fc.prototype.get=function(){return ec(this.Za)};function hc(a){this.kd=a;this.Hb=l}hc.prototype.get=function(){var a=this.kd.get(),b=ec(a);if(this.Hb)for(var c in this.Hb)b[c]-=this.Hb[c];this.Hb=a;return b};function ic(a,b){this.Dc={};this.ac=new hc(a);this.o=b;setTimeout(v(this.Xc,this),10+6e4*Math.random())}ic.prototype.Xc=function(){var a=this.ac.get(),b={},c=o,d;for(d in a)0<a[d]&&D(this.Dc,d)&&(b[d]=a[d],c=k);c&&(a=this.o,a.U&&(b={c:b},a.e("reportStats",b),a.xa("s",b)));setTimeout(v(this.Xc,this),6e5*Math.random())};var jc={},kc={};function lc(a){a=a.toString();jc[a]||(jc[a]=new fc);return jc[a]}var mc=l;"undefined"!==typeof MozWebSocket?mc=MozWebSocket:"undefined"!==typeof WebSocket&&(mc=WebSocket);function nc(a,b,c){this.kc=a;this.e=Ob(this.kc);this.frames=this.gb=l;this.Ec=0;this.X=lc(b);this.La=(b.Yb?"wss://":"ws://")+b.da+"/.ws?v=5";b.host!==b.da&&(this.La=this.La+"&ns="+b.jb);c&&(this.La=this.La+"&s="+c)}var oc;nc.prototype.open=function(a,b){this.fa=b;this.wd=a;this.e("websocket connecting to "+this.La);this.W=new mc(this.La);this.$a=o;var c=this;this.W.onopen=function(){c.e("Websocket connected.");c.$a=k};this.W.onclose=function(){c.e("Websocket connection was disconnected.");c.W=l;c.Ea()};this.W.onmessage=function(a){if(c.W!==l)if(a=a.data,gc(c.X,"bytes_received",a.length),pc(c),c.frames!==l)qc(c,a);else{a:{z(c.frames===l,"We already have a frame buffer");if(4>=a.length){var b=Number(a);if(!isNaN(b)){c.Ec=b;c.frames=[];a=l;break a}}c.Ec=1;c.frames=[]}a!==l&&qc(c,a)}};this.W.onerror=function(a){c.e("WebSocket error.  Closing connection.");a.data&&c.e(a.data);c.Ea()}};nc.prototype.start=function(){};nc.isAvailable=function(){return!("undefined"!==typeof navigator&&"Opera"===navigator.appName)&&mc!==l&&!oc};function qc(a,b){a.frames.push(b);if(a.frames.length==a.Ec){var c=a.frames.join("");a.frames=l;c="undefined"!==typeof JSON&&t(JSON.parse)?JSON.parse(c):ka(c);a.wd(c)}}nc.prototype.send=function(a){pc(this);a=y(a);gc(this.X,"bytes_sent",a.length);a=Ub(a,16384);1<a.length&&this.W.send(String(a.length));for(var b=0;b<a.length;b++)this.W.send(a[b])};nc.prototype.zb=function(){this.Ba=k;this.gb&&(clearTimeout(this.gb),this.gb=l);this.W&&(this.W.close(),this.W=l)};nc.prototype.Ea=function(){this.Ba||(this.e("WebSocket is closing itself"),this.zb(),this.fa&&(this.fa(this.$a),this.fa=l))};nc.prototype.close=function(){this.Ba||(this.e("WebSocket is being closed"),this.zb())};function pc(a){clearTimeout(a.gb);a.gb=setInterval(function(){a.W.send("0");pc(a)},45e3)}function rc(){this.set={}}r=rc.prototype;r.add=function(a,b){this.set[a]=b!==l?b:k};r.contains=function(a){return D(this.set,a)};r.get=function(a){return this.contains(a)?this.set[a]:j};r.remove=function(a){delete this.set[a]};r.f=function(){var a;a:{for(a in this.set){a=o;break a}a=k}return a};r.count=function(){var a=0,b;for(b in this.set)a++;return a};function sc(a,b){for(var c in a.set)D(a.set,c)&&b(c,a.set[c])}r.keys=function(){var a=[],b;for(b in this.set)D(this.set,b)&&a.push(b);return a};var tc="pLPCommand",uc="pRTLPCB";function vc(a,b,c){this.kc=a;this.e=Ob(a);this.Jd=b;this.X=lc(b);this.$b=c;this.$a=o;this.Db=function(a){b.host!==b.da&&(a.ns=b.jb);var c=[],f;for(f in a)a.hasOwnProperty(f)&&c.push(f+"="+a[f]);return(b.Yb?"https://":"http://")+b.da+"/.lp?"+c.join("&")}}var wc,xc;vc.prototype.open=function(a,b){function c(){if(!d.Ba){d.ga=new yc(function(a,b,c,e,f){gc(d.X,"bytes_received",y(arguments).length);if(d.ga)if(d.ya&&(clearTimeout(d.ya),d.ya=l),d.$a=k,"start"==a)d.id=b,d.Wc=c;else if("close"===a)if(b){d.ga.Zb=o;var h=d.Sc;h.jc=b;h.Da=function(){d.Ea()};h.jc<h.Ma&&(h.Da(),h.Da=l)}else d.Ea();else g(Error("Unrecognized command received: "+a))},function(a,b){gc(d.X,"bytes_received",y(arguments).length);var c=d.Sc;for(c.Qb[a]=b;c.Qb[c.Ma];){var e=c.Qb[c.Ma];delete c.Qb[c.Ma];for(var f=0;f<e.length;++f)e[f]&&c.uc(e[f]);if(c.Ma===c.jc){c.Da&&(clearTimeout(c.Da),c.Da(),c.Da=l);break}c.Ma++}},function(){d.Ea()},d.Db);var a={start:"t"};a.ser=Math.floor(1e8*Math.random());d.ga.cc&&(a.cb=d.ga.cc);a.v="5";d.$b&&(a.s=d.$b);a=d.Db(a);d.e("Connecting via long-poll to "+a);zc(d.ga,a,function(){})}}this.Ic=0;this.N=b;this.Sc=new dc(a);this.Ba=o;var d=this;this.ya=setTimeout(function(){d.e("Timed out trying to connect.");d.Ea();d.ya=l},3e4);if("complete"===document.readyState)c();else{var e=o,f=function(){document.body?e||(e=k,c()):setTimeout(f,10)};document.addEventListener?(document.addEventListener("DOMContentLoaded",f,o),window.addEventListener("load",f,o)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&f()},o),window.attachEvent("onload",f,o))}};vc.prototype.start=function(){var a=this.ga,b=this.Wc;a.ud=this.id;a.vd=b;for(a.fc=k;Ac(a););a=this.id;b=this.Wc;this.Ra=document.createElement("iframe");var c={dframe:"t"};c.id=a;c.pw=b;a=this.Db(c);this.Ra.src=a;this.Ra.style.display="none";document.body.appendChild(this.Ra)};vc.isAvailable=function(){return!xc&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&(wc||k)};vc.prototype.zb=function(){this.Ba=k;this.ga&&(this.ga.close(),this.ga=l);this.Ra&&(document.body.removeChild(this.Ra),this.Ra=l);this.ya&&(clearTimeout(this.ya),this.ya=l)};vc.prototype.Ea=function(){this.Ba||(this.e("Longpoll is closing itself"),this.zb(),this.N&&(this.N(this.$a),this.N=l))};vc.prototype.close=function(){this.Ba||(this.e("Longpoll is being closed."),this.zb())};vc.prototype.send=function(a){a=y(a);gc(this.X,"bytes_sent",a.length);for(var a=qa(a),a=Gb(a,k),a=Ub(a,1840),b=0;b<a.length;b++){var c=this.ga;c.qb.push({Dd:this.Ic,Id:a.length,Jc:a[b]});c.fc&&Ac(c);this.Ic++}};function yc(a,b,c,d){this.Db=d;this.fa=c;this.wc=new rc;this.qb=[];this.lc=Math.floor(1e8*Math.random());this.Zb=k;this.cc=Hb();window[tc+this.cc]=a;window[uc+this.cc]=b;a=document.createElement("iframe");a.style.display="none";if(document.body){document.body.appendChild(a);try{a.contentWindow.document||O("No IE domain setting required")}catch(e){a.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}}else g("Document body has not initialized. Wait to initialize Firebase until after the document is ready.");a.contentDocument?a.ra=a.contentDocument:a.contentWindow?a.ra=a.contentWindow.document:a.document&&(a.ra=a.document);this.$=a;a="";"javascript:"===this.$.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";</script>');a="<html><body>"+a+"</body></html>";try{this.$.ra.open(),this.$.ra.write(a),this.$.ra.close()}catch(f){O("frame writing exception"),f.stack&&O(f.stack),O(f)}}yc.prototype.close=function(){this.fc=o;if(this.$){this.$.ra.body.innerHTML="";var a=this;setTimeout(function(){a.$!==l&&(document.body.removeChild(a.$),a.$=l)},0)}var b=this.fa;b&&(this.fa=l,b())};function Ac(a){if(a.fc&&a.Zb&&a.wc.count()<(0<a.qb.length?2:1)){a.lc++;var b={};b.id=a.ud;b.pw=a.vd;b.ser=a.lc;for(var b=a.Db(b),c="",d=0;0<a.qb.length;)if(1870>=a.qb[0].Jc.length+30+c.length){var e=a.qb.shift(),c=c+"&seg"+d+"="+e.Dd+"&ts"+d+"="+e.Id+"&d"+d+"="+e.Jc;d++}else break;var b=b+c,f=a.lc;a.wc.add(f);var h=function(){a.wc.remove(f);Ac(a)},i=setTimeout(h,25e3);zc(a,b,function(){clearTimeout(i);h()});return k}return o}function zc(a,b,c){setTimeout(function(){try{if(a.Zb){var d=a.$.ra.createElement("script");d.type="text/javascript";d.async=k;d.src=b;d.onload=d.onreadystatechange=function(){var a=d.readyState;if(!a||"loaded"===a||"complete"===a)d.onload=d.onreadystatechange=l,d.parentNode&&d.parentNode.removeChild(d),c()};d.onerror=function(){O("Long-poll script failed to load: "+b);a.Zb=o;a.close()};a.$.ra.body.appendChild(d)}}catch(e){}},1)}function Bc(){var a=[];Vb(Cc,function(b,c){c&&c.isAvailable()&&a.push(c)});this.bc=a}var Cc=[vc,{isAvailable:q(o)},nc];function Dc(a,b,c,d,e,f){this.id=a;this.e=Ob("c:"+this.id+":");this.uc=c;this.mb=d;this.N=e;this.tc=f;this.P=b;this.Pb=[];this.Hc=0;this.Gc=new Bc;this.na=0;this.e("Connection created");Ec(this)}function Ec(a){var b;var c=a.Gc;0<c.bc.length?b=c.bc[0]:g(Error("No transports available"));a.I=new b("c:"+a.id+":"+a.Hc++,a.P);var d=Fc(a,a.I),e=Gc(a,a.I);a.Ab=a.I;a.wb=a.I;a.A=l;setTimeout(function(){a.I&&a.I.open(d,e)},0)}function Gc(a,b){return function(c){b===a.I?(a.I=l,!c&&0===a.na?(a.e("Realtime connection failed."),"s-"===a.P.da.substr(0,2)&&(ob.removeItem(a.P.jb),a.P.da=a.P.host)):1===a.na&&a.e("Realtime connection lost."),a.close()):b===a.A?(c=a.A,a.A=l,(a.Ab===c||a.wb===c)&&a.close()):a.e("closing an old connection")}}function Fc(a,b){return function(c){if(2!=a.na)if(b===a.wb){var d=Tb("t",c),c=Tb("d",c);if("c"==d){if(d=Tb("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.$b=c.s;rb(a.P,f);if(0==a.na&&(a.I.start(),c=a.I,a.e("Realtime connection established."),a.I=c,a.na=1,a.mb&&(a.mb(d),a.mb=l),"5"!==e&&Rb("Protocol version mismatch detected"),c=1<a.Gc.bc.length?a.Gc.bc[1]:l))a.A=new c("c:"+a.id+":"+a.Hc++,a.P,a.$b),a.A.open(Fc(a,a.A),Gc(a,a.A))}else if("n"===d){a.e("recvd end transmission on primary");a.wb=a.A;for(c=0;c<a.Pb.length;++c)a.Mb(a.Pb[c]);a.Pb=[];Hc(a)}else"s"===d?(a.e("Connection shutdown command received. Shutting down..."),a.tc&&(a.tc(c),a.tc=l),a.N=l,a.close()):"r"===d?(a.e("Reset packet received.  New host: "+c),rb(a.P,c),1===a.na?a.close():(Ic(a),Ec(a))):Pb("Unknown control packet command: "+d)}else"d"==d&&a.Mb(c)}else b===a.A?(d=Tb("t",c),c=Tb("d",c),"c"==d?"t"in c&&(c=c.t,"a"===c?(a.A.start(),a.e("sending client ack on secondary"),a.A.send({t:"c",d:{t:"a",d:{}}}),a.e("Ending transmission on primary"),a.I.send({t:"c",d:{t:"n",d:{}}}),a.Ab=a.A,Hc(a)):"r"===c&&(a.e("Got a reset on secondary, closing it"),a.A.close(),(a.Ab===a.A||a.wb===a.A)&&a.close())):"d"==d?a.Pb.push(c):g(Error("Unknown protocol layer: "+d))):a.e("message on old connection")}}Dc.prototype.zc=function(a){a={t:"d",d:a};1!==this.na&&g("Connection is not connected");this.Ab.send(a)};function Hc(a){a.Ab===a.A&&a.wb===a.A&&(a.e("cleaning up and promoting a connection: "+a.A.kc),a.I=a.A,a.A=l)}Dc.prototype.Mb=function(a){this.uc(a)};Dc.prototype.close=function(){2!==this.na&&(this.e("Closing realtime connection."),this.na=2,Ic(this),this.N&&(this.N(),this.N=l))};function Ic(a){a.e("Shutting down all connections");a.I&&(a.I.close(),a.I=l);a.A&&(a.A.close(),a.A=l)}function Jc(a,b,c,d,e){this.id=Kc++;this.e=Ob("p:"+this.id+":");this.yb=k;this.ea={};this.S=[];this.nb=0;this.lb=[];this.U=o;this.Ub=1e3;this.Nb=b||ca;this.Lb=c||ca;this.kb=d||ca;this.vc=e||ca;this.P=a;this.yc=l;this.Rb=[];this.ub={};this.Cd=0;this.hb=this.Rc=l;setTimeout(v(this.Kc,this),0)}var Kc=0,Lc=0;r=Jc.prototype;r.xa=function(a,b,c){var d=++this.Cd,a={r:d,a:a,b:b};this.e(y(a));this.U?this.sb.zc(a):this.Rb.push(a);c&&(this.ub[d]=c)};function Mc(a,b,c,d,e){a.e("Listen on "+b+" for "+c);var f={p:b},d=jb(d,function(a){return Ia(a)});"{}"!==c&&(f.q=d);a.xa("l",f,function(d){a.e("listen response",d);d=d.s;"ok"!==d&&Nc(a,b,c);e&&e(d)})}r.Ya=function(a,b,c){this.za={ld:a,Mc:o,ha:b,Fb:c};this.e("Authenticating using credential: "+this.za);Oc(this)};r.Bb=function(){delete this.za;this.kb(o);this.U&&this.xa("unauth",{})};function Oc(a){var b=a.za;a.U&&b&&a.xa("auth",{cred:b.ld},function(c){var d=c.s,c=c.d||"error";"ok"!==d&&a.za===b&&delete a.za;b.Mc?"ok"!==d&&b.Fb&&b.Fb(d,c):(b.Mc=k,b.ha&&b.ha(d,c));a.kb("ok"===d)})}r.ed=function(a,b,c){a=a.toString();Nc(this,a,b)&&this.U&&(this.e("Unlisten on "+a+" for "+b),a={p:a},c=jb(c,function(a){return Ia(a)}),"{}"!==b&&(a.q=c),this.xa("u",a))};function Pc(a,b,c,d){a.U?Qc(a,"o",b,c,d):a.lb.push({xc:b,action:"o",data:c,C:d})}r.sc=function(a,b){this.U?Qc(this,"oc",a,l,b):this.lb.push({xc:a,action:"oc",data:l,C:b})};function Qc(a,b,c,d,e){c={p:c,d:d};a.e("onDisconnect "+b,c);a.xa(b,c,function(a){e&&setTimeout(function(){e(a.s)},0)})}r.put=function(a,b,c,d){Rc(this,"p",a,b,c,d)};function Rc(a,b,c,d,e,f){c={p:c,d:d};t(f)&&(c.h=f);a.S.push({action:b,Yc:c,C:e});a.nb++;b=a.S.length-1;a.U&&Sc(a,b)}function Sc(a,b){var c=a.S[b].action,d=a.S[b].Yc,e=a.S[b].C;a.S[b].yd=a.U;a.xa(c,d,function(d){a.e(c+" response",d);delete a.S[b];a.nb--;0===a.nb&&(a.S=[]);e&&e(d.s)})}r.Mb=function(a){if("r"in a){this.e("from server: "+y(a));var b=a.r,c=this.ub[b];c&&(delete this.ub[b],c(a.b))}else"error"in a&&g("A server-side error has occurred: "+a.error),"a"in a&&(b=a.a,a=a.b,this.e("handleServerMessage",b,a),"d"===b?this.Nb(a.p,a.d):"m"===b?this.Nb(a.p,a.d,k):"c"===b?(b=a.p,a=(a=a.q)?jb(a,function(a){return Ja(a)}).join("$"):"{}",(a=Nc(this,b,a))&&a.C&&a.C("permission_denied")):"ac"===b?(b=a.s,a=a.d,c=this.za,delete this.za,c&&c.Fb&&c.Fb(b,a),this.kb(o)):"sd"===b?this.yc?this.yc(a):"msg"in a&&"undefined"!==typeof console&&console.log("FIREBASE: "+a.msg.replace("\n","\nFIREBASE: ")):Pb("Unrecognized action received from server: "+y(b)+"\nAre you using the latest client?"))};r.mb=function(a){this.e("connection ready");this.U=k;this.hb=(new Date).getTime();this.vc({Kd:a-(new Date).getTime()});for(a=0;a<this.Rb.length;a++)this.sb.zc(this.Rb[a]);this.Rb=[];Oc(this);for(a=0;a<this.S.length;a++)this.S[a]&&Sc(this,a);for(var b in this.ea)for(var c in this.ea[b])a=this.ea[b][c],Mc(this,b,c,a.Ta,a.C);for(;this.lb.length;)b=this.lb.shift(),Qc(this,b.action,b.xc,b.data,b.C);this.Lb(k)};r.Uc=function(){this.U=o;this.e("data client disconnected");for(var a=v(function(){this.Kc()},this),b=0;b<this.S.length;b++){var c=this.S[b];c&&"h"in c.Yc&&c.yd&&(c.C&&c.C("disconnect"),delete this.S[b],this.nb--)}0===this.nb&&(this.S=[]);if(this.yb)this.hb&&(3e4<(new Date).getTime()-this.hb&&(this.Ub=1e3),this.hb=l),b=Math.max(0,this.Ub-((new Date).getTime()-this.Rc)),b*=Math.random(),this.e("Trying to reconnect in "+b+"ms"),setTimeout(a,b),this.Ub=Math.min(3e5,1.3*this.Ub);else{for(var d in this.ub)delete this.ub[d];this.$c=function(){setTimeout(a,0)}}this.Lb(o)};r.Kc=function(){if(this.yb){this.e("Making a connection attempt");this.Rc=(new Date).getTime();this.hb=l;var a=v(this.Mb,this),b=v(this.mb,this),c=v(this.Uc,this),d=this.id+":"+Lc++,e=this;this.sb=new Dc(d,this.P,a,b,c,function(a){e.yb=o;g(Error(a))})}};r.Pa=function(){this.yb=o;this.sb?this.sb.close():this.Uc()};r.vb=function(){this.yb=k;this.$c();this.$c=j};function Nc(a,b,c){b=new I(b).toString();c||(c="{}");var d=a.ea[b][c];delete a.ea[b][c];return d}function Tc(){this.n=this.D=l}function Uc(a,b,c){if(b.f())a.D=c,a.n=l;else if(a.D!==l)a.D=a.D.pa(b,c);else{a.n==l&&(a.n=new rc);var d=F(b);a.n.contains(d)||a.n.add(d,new Tc);a=a.n.get(d);b=J(b);Uc(a,b,c)}}function Vc(a,b){if(b.f())return a.D=l,a.n=l,k;if(a.D!==l){if(a.D.J())return o;var c=a.D;a.D=l;c.w(function(b,c){Uc(a,new I(b),c)});return Vc(a,b)}return a.n!==l?(c=F(b),b=J(b),a.n.contains(c)&&Vc(a.n.get(c),b)&&a.n.remove(c),a.n.f()?(a.n=l,k):o):k}function Wc(a,b,c){a.D!==l?c(b,a.D):a.w(function(a,e){var f=new I(b.toString()+"/"+a);Wc(e,f,c)})}Tc.prototype.w=function(a){this.n!==l&&sc(this.n,function(b,c){a(b,c)})};function Xc(){this.Ha=P}function T(a,b){return a.Ha.G(b)}function U(a,b,c){a.Ha=a.Ha.pa(b,c)}Xc.prototype.toString=function(){return this.Ha.toString()};function Yc(){this.xb=new Xc;this.L=new Xc;this.Ia=new Xc;this.pb=new Na}function Zc(a,b){for(var c=T(a.xb,b),d=T(a.L,b),e=L(a.pb,b),f=o,h=e;h!==l;){if(h.j()!==l){f=k;break}h=h.parent()}if(f)return o;c=$c(c,d,e);return c!==d?(U(a.L,b,c),k):o}function $c(a,b,c){if(c.f())return a;if(c.j()!==l)return b;a=a||P;c.w(function(d){var d=d.name(),e=a.R(d),f=b.R(d),h=L(c,d),e=$c(e,f,h);a=a.H(d,e)});return a}Yc.prototype.set=function(a,b){var c=this,d=[];ib(b,function(a){var b=a.path,a=a.Ca,h=Hb();N(L(c.pb,b),h);U(c.L,b,a);d.push({path:b,Ed:h})});return d};function ad(a,b){ib(b,function(b){var d=b.Ed,b=L(a.pb,b.path),e=b.j();z(e!==l,"pendingPut should not be null.");e===d&&N(b,l)})}function bd(){this.Aa=[]}function cd(a,b){if(0!==b.length){a.Aa.push.apply(a.Aa,b);for(var c=0;c<a.Aa.length;c++)if(a.Aa[c]){var d=a.Aa[c];a.Aa[c]=l;var e=d.ha;e(d.bd,d.rb)}a.Aa=[]}}function V(a,b,c,d){this.type=a;this.ka=b;this.Y=c;this.rb=d}function dd(a){this.M=a;this.ia=[];this.Lc=new bd}function ed(a,b,c,d,e){a.ia.push({type:b,ha:c,cancel:d,Z:e});var d=[],f=fd(a.g);a.fb&&f.push(new V("value",a.g));for(var h=0;h<f.length;h++)if(f[h].type===b){var i=new W(a.M.u,a.M.path);f[h].Y&&(i=i.F(f[h].Y));d.push({ha:e?v(c,e):c,bd:new S(f[h].ka,i),rb:f[h].rb})}cd(a.Lc,d)}dd.prototype.Sb=function(a,b){b=this.Tb(a,b);b!=l&&gd(this,b)};function gd(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=e.type,h=new W(a.M.u,a.M.path);b[d].Y&&(h=h.F(b[d].Y));h=new S(b[d].ka,h);"value"===e.type&&!h.bb()?f+="("+h.T()+")":"value"!==e.type&&(f+=" "+h.name());O(a.M.u.o.id+": event:"+a.M.path+":"+a.M.Fa()+":"+f);for(f=0;f<a.ia.length;f++){var i=a.ia[f];b[d].type===i.type&&c.push({ha:i.Z?v(i.ha,i.Z):i.ha,bd:h,rb:e.rb})}}cd(a.Lc,c)}function fd(a){var b=[];if(!a.J()){var c=l;a.w(function(a,e){b.push(new V("child_added",e,a,c));c=a})}return b}function hd(a){a.fb||(a.fb=k,gd(a,[new V("value",a.g)]))}function kd(a,b){dd.call(this,a);this.g=b}ja(kd,dd);kd.prototype.Tb=function(a,b){this.g=a;this.fb&&b!=l&&b.push(new V("value",this.g));return b};kd.prototype.ab=function(){return{}};function ld(a,b){this.Gb=a;this.rc=b}function md(a,b,c,d,e){var f=a.G(c),h=b.G(c),d=new ld(d,e),e=nd(d,c,f,h),i=o;if(!f.f()&&!h.f()&&f.k()!==h.k())var i=a.G(c.parent()),m=b.G(c.parent()),n=Ka(c),i=i.V(n,f)!=m.V(n,h);if(e||i){f=c;c=e;for(h=i;f.parent()!==l;){var p=a.G(f),e=b.G(f),i=f.parent();if(!d.Gb||L(d.Gb,i).j())m=b.G(i),n=[],f=Ka(f),p.f()?(p=m.V(f,e),n.push(new V("child_added",e,f,p))):e.f()?n.push(new V("child_removed",p,f)):(p=m.V(f,e),h&&n.push(new V("child_moved",e,f,p)),c&&n.push(new V("child_changed",e,f,p))),d.rc(i,m,n);h&&(h=o,c=k);f=i}}}function nd(a,b,c,d){var e,f=[];c===d?e=o:c.J()&&d.J()?e=c.j()!==d.j():c.J()?(od(a,b,P,d,f),e=k):d.J()?(od(a,b,c,P,f),e=k):e=od(a,b,c,d,f);e?a.rc(b,d,f):c.k()!==d.k()&&a.rc(b,d,l);return e}function od(a,b,c,d,e){var f=o,h=!a.Gb||!L(a.Gb,b).f(),i=[],m=[],n=[],p=[],s={},w={},x,M,K,G;x=c.Oa();K=Ya(x);M=d.Oa();for(G=Ya(M);K!==l||G!==l;){c=K===l?1:G===l?-1:K.key===G.key?0:cc({name:K.key,wa:K.value.k()},{name:G.key,wa:G.value.k()});if(0>c)f=ta(s,K.key),t(f)?(n.push({Nc:K,dd:i[f]}),i[f]=l):(w[K.key]=m.length,m.push(K)),f=k,K=Ya(x);else{if(0<c)f=ta(w,G.key),t(f)?(n.push({Nc:m[f],dd:G}),m[f]=l):(s[G.key]=i.length,i.push(G)),f=k;else{c=b.F(G.key);if(c=nd(a,c,K.value,G.value))p.push(G),f=k;K=Ya(x)}G=Ya(M)}if(!h&&f)return k}for(h=0;h<m.length;h++)if(s=m[h])c=b.F(s.key),nd(a,c,s.value,P),e.push(new V("child_removed",s.value,s.key));for(h=0;h<i.length;h++)if(s=i[h])c=b.F(s.key),m=d.V(s.key,s.value),nd(a,c,P,s.value),e.push(new V("child_added",s.value,s.key,m));for(h=0;h<n.length;h++)s=n[h].Nc,i=n[h].dd,c=b.F(i.key),m=d.V(i.key,i.value),e.push(new V("child_moved",i.value,i.key,m)),(c=nd(a,c,s.value,i.value))&&p.push(i);for(h=0;h<p.length;h++)a=p[h],m=d.V(a.key,a.value),e.push(new V("child_changed",a.value,a.key,m));return f}function pd(){this.O=this.oa=l;this.set={}}ja(pd,rc);r=pd.prototype;r.setActive=function(a){this.oa=a};function qd(a){return a.contains("default")}function rd(a){return a.oa!=l&&qd(a)}r.defaultView=function(){return qd(this)?this.get("default"):l};r.path=aa("O");r.toString=function(){return jb(this.keys(),function(a){return"default"===a?"{}":a}).join("$")};r.Ta=function(){var a=[];sc(this,function(b,c){a.push(c.M)});return a};function sd(a,b){dd.call(this,a);this.g=P;this.Tb(b,fd(b))}ja(sd,dd);sd.prototype.Tb=function(a,b){if(b===l)return b;var c=[],d=this.M;t(d.ca)&&(t(d.ma)&&d.ma!=l?c.push(function(a,b){var c=Sb(b,d.ca);return 0<c||0===c&&a>=d.ma}):c.push(function(a,b){return 0<=Sb(b,d.ca)}));t(d.sa)&&(t(d.Na)?c.push(function(a,b){var c=Sb(b,d.sa);return 0>c||0===c&&a<=d.Na}):c.push(function(a,b){return 0>=Sb(b,d.sa)}));var e=l,f=l;if(t(this.M.ua))if(t(this.M.ca)){if(e=td(a,c,this.M.ua,o)){var h=a.R(e).k();c.push(function(a,b){var c=Sb(b,h);return 0>c||0===c&&a<=e})}}else if(f=td(a,c,this.M.ua,k)){var i=a.R(f).k();c.push(function(a,b){var c=Sb(b,i);return 0<c||0===c&&a>=f})}for(var m=[],n=[],p=[],s=[],w=0;w<b.length;w++){var x=b[w].Y,M=b[w].ka;switch(b[w].type){case"child_added":ud(c,x,M)&&(this.g=this.g.H(x,M),n.push(b[w]));break;case"child_removed":this.g.R(x).f()||(this.g=this.g.H(x,l),m.push(b[w]));break;case"child_changed":!this.g.R(x).f()&&ud(c,x,M)&&(this.g=this.g.H(x,M),s.push(b[w]));break;case"child_moved":var K=!this.g.R(x).f(),G=ud(c,x,M);K?G?(this.g=this.g.H(x,M),p.push(b[w])):(m.push(new V("child_removed",this.g.R(x),x)),this.g=this.g.H(x,l)):G&&(this.g=this.g.H(x,M),n.push(b[w]))}}var id=e||f;if(id){var jd=(w=f!==l)?this.g.Oc():this.g.Pc(),Xb=o,Ta=o,Ua=this;(w?a.mc:a.w).call(a,function(a,b){!Ta&&jd===l&&(Ta=k);if(Ta&&Xb)return k;Xb?(m.push(new V("child_removed",Ua.g.R(a),a)),Ua.g=Ua.g.H(a,l)):Ta&&(n.push(new V("child_added",b,a)),Ua.g=Ua.g.H(a,b));jd===a&&(Ta=k);a===id&&(Xb=k)})}for(w=0;w<n.length;w++)c=n[w],x=this.g.V(c.Y,c.ka),m.push(new V("child_added",c.ka,c.Y,x));for(w=0;w<p.length;w++)c=p[w],x=this.g.V(c.Y,c.ka),m.push(new V("child_moved",c.ka,c.Y,x));for(w=0;w<s.length;w++)c=s[w],x=this.g.V(c.Y,c.ka),m.push(new V("child_changed",c.ka,c.Y,x));this.fb&&0<m.length&&m.push(new V("value",this.g));return m};function td(a,b,c,d){if(a.J())return l;var e=l;(d?a.mc:a.w).call(a,function(a,d){if(ud(b,a,d)&&(e=a,c--,0===c))return k});return e}function ud(a,b,c){for(var d=0;d<a.length;d++)if(!a[d](b,c.k()))return o;return k}sd.prototype.nc=function(a){return this.g.R(a)!==P};sd.prototype.ab=function(a,b,c){var d={};this.g.J()||this.g.w(function(a){d[a]=k});var e=this.g,c=T(c,new I("")),f=new Na;N(L(f,this.M.path),k);var h=P.pa(a,b),i=[];md(c,h,a,f,function(a,b,c){c!==l&&(i=i.concat(c))});this.Tb(b,i);this.g.J()||this.g.w(function(a){d[a]=k});this.g=e;return d};function vd(a,b){this.o=a;this.i=b;this.Tc=b.Ha;this.qa=new Na}vd.prototype.Eb=function(a,b,c,d,e){var f=a.path,h=L(this.qa,f),i=h.j();i===l?(i=new pd,N(h,i)):z(!i.f(),"We shouldn't be storing empty QueryMaps");var m=a.Fa();if(i.contains(m))ed(i.get(m),b,c,d,e);else{var n=this.i.Ha.G(f),a="default"===a.Fa()?new kd(a,n):new sd(a,n);if(rd(i)||wd(h))i.add(m,a),i.O||(i.O=a.M.path);else{var p,s;i.f()||(p=i.toString(),s=i.Ta());i.add(m,a);i.O||(i.O=a.M.path);i.setActive(xd(this,i));p&&s&&this.o.ed(i.path(),p,s)}rd(i)&&Pa(h,function(a){if(a=a.j()){a.oa&&a.oa();a.oa=l}});ed(a,b,c,d,e);(b=(b=Qa(L(this.qa,f),function(a){var b;if(b=a.j())if(b=a.j().defaultView())b=a.j().defaultView().fb;if(b)return k},k))||this.o===l)&&hd(a)}};function yd(a,b,c,d,e){for(var f=a.get(b),h=o,i=f.ia.length-1;0<=i;i--){var m=f.ia[i];if((!c||m.type===c)&&(!d||m.ha===d)&&(!e||m.Z===e))if(f.ia.splice(i,1),h=k,c&&d)break}(c=h&&!(0<f.ia.length))&&a.remove(b);return c}vd.prototype.Wb=function(a,b,c,d){var e=L(this.qa,a.path).j();return e===l?l:zd(this,e,a,b,c,d)};function zd(a,b,c,d,e,f){var h=b.path(),h=L(a.qa,h),c=c?c.Fa():l,i=[];c&&"default"!==c?yd(b,c,d,e,f)&&i.push(c):ib(b.keys(),function(a){yd(b,a,d,e,f)&&i.push(a)});b.f()&&N(h,l);c=wd(h);if(0<i.length&&!c){for(var m=h,n=h.parent(),c=o;!c&&n;){var p=n.j();if(p){z(!rd(p));var s=m.name(),w=o;sc(p,function(a,b){w=b.nc(s)||w});w&&(c=k)}m=n;n=n.parent()}m=l;if(!rd(b)){n=b.oa;b.oa=l;var x=[],M=function(b){var c=b.j();if(c&&qd(c))x.push(c.path()),c.oa==l&&c.setActive(xd(a,c));else{if(c){c.oa!=l||c.setActive(xd(a,c));var d={};sc(c,function(a,b){b.g.w(function(a){D(d,a)||(d[a]=k,a=c.path().F(a),x.push(a))})})}b.w(M)}};M(h);m=x;n&&n()}return c?l:m}return l}function Ad(a,b,c){Pa(L(a.qa,b),function(a){(a=a.j())&&sc(a,function(a,b){hd(b)})},c,k)}function Bd(a,b,c){function d(a){for(var b=0;b<c.length;++b)if(c[b].contains(a))return k;return o}var e=a.Tc,f=a.i.Ha;a.Tc=f;md(e,f,b,a.qa,function(c,e,f){if(b.contains(c)){var n=d(c);n&&Ad(a,c,o);a.Sb(c,e,f);n&&Ad(a,c,k)}else a.Sb(c,e,f)});d(b)&&Ad(a,b,k)}vd.prototype.Sb=function(a,b,c){a=L(this.qa,a).j();a!==l&&sc(a,function(a,e){e.Sb(b,c)})};function wd(a){return Qa(a,function(a){return a.j()&&rd(a.j())})}function xd(a,b){if(a.o){var c=b.keys(),d=a.o,e=function(d){"ok"!==d?(Rb("on() or once() for "+b.path().toString()+" failed: "+d),b&&sc(b,function(a,b){for(var c=0;c<b.ia.length;c++){var d=b.ia[c];d.cancel&&(d.Z?v(d.cancel,d.Z):d.cancel)()}}),zd(a,b)):ib(c,function(a){(a=b.get(a))&&hd(a)})},f=b.toString(),h=b.path().toString();d.ea[h]=d.ea[h]||{};z(!d.ea[h][f],"listen() called twice for same path/queryId.");d.ea[h][f]={Ta:b.Ta(),C:e};d.U&&Mc(d,h,f,b.Ta(),e);return v(a.o.ed,a.o,b.path(),b.toString(),b.Ta())}return ca}vd.prototype.ab=function(a,b,c,d){var e={};sc(b,function(b,h){var i=h.ab(a,c,d);Wb(i,function(a,b){e[b]=a?k:ta(e,b)||o})});c.J()||c.w(function(a){D(e,a)||(e[a]=o)});return e};function Cd(a,b,c,d,e,f){var h=b.path();if(f!==l){var i=[];d.J()||d.w(function(a,b){i.push({path:h.F(a),Ca:b});delete f[a]});Wb(f,function(a,b){i.push({path:h.F(b),Ca:P})});return i}var b=a.ab(h,b,d,e),m=P,n=[];Wb(b,function(b,f){var h=new I(f);b?m=m.H(f,d.G(h)):n=n.concat(Dd(a,d.G(h),L(c,h),e))});return[{path:h,Ca:m}].concat(n)}function Ed(a,b,c,d,e){for(var f=L(a.qa,b),h=f.parent(),i=o;!i&&h!==l;){var m=h.j();m!==l&&(qd(m)?i=k:(m=a.ab(b,m,c,d),f=f.name(),ta(m,f)&&(i=k)));f=h;h=h.parent()}if(i)return[{path:b,Ca:c}];h=L(a.qa,b);i=h.j();return i!==l?qd(i)?[{path:b,Ca:c}]:Cd(a,i,h,c,d,e):Dd(a,c,h,d)}function Dd(a,b,c,d){var e=c.j();if(e!==l)return qd(e)?[{path:c.path(),Ca:b}]:Cd(a,e,c,b,d,l);if(b.J())return[];var f=[];b.w(function(b,e){var m=new I(b);f=f.concat(Dd(a,e,L(c,m),d))});return f}function Fd(a){this.P=a;this.X=lc(a);this.o=new Jc(this.P,v(this.Nb,this),v(this.Lb,this),v(this.kb,this),v(this.vc,this));var b=v(function(){return new ic(this.X,this.o)},this),a=a.toString();kc[a]||(kc[a]=b());this.cd=kc[a];this.Wa=new Na;this.Xa=new Xc;this.i=new Yc;this.Q=new vd(this.o,this.i.Ia);this.oc=new Xc;this.pc=new vd(l,this.oc);Gd(this,"connected",o);Gd(this,"authenticated",o);Gd(this,"serverTimeOffset",l);this.N=new Tc}r=Fd.prototype;r.toString=function(){return(this.P.Yb?"https://":"http://")+this.P.host};r.name=function(){return this.P.jb};r.Nb=function(a,b,c){var d=[];if(9<=a.length&&a.lastIndexOf(".priority")===a.length-9)a=new I(a.substring(0,a.length-9)),c=T(this.i.xb,a).Cb(b),d.push(a);else if(c){var a=new I(a),c=T(this.i.xb,a),e;for(e in b){var f=new I(e),c=c.pa(f,R(b[e]));d.push(a.F(e))}}else a=new I(a),c=R(b),d.push(a);b=Ed(this.Q,a,c,this.i.L,l);e=o;for(c=0;c<b.length;++c){var f=b[c],h=this.i,i=f.path;U(h.xb,i,f.Ca);e=Zc(h,i)||e}e&&(a=Hd(this,a));Bd(this.Q,a,d)};r.Lb=function(a){Gd(this,"connected",a);if(a===o){this.e("onDisconnectEvents");var b=this,c=[];Wc(this.N,new I(""),function(a,e){var f=Ed(b.Q,a,e,b.i.L,l);c.push.apply(c,b.i.set(a,f));f=Id(b,a);Hd(b,f);Bd(b.Q,f,[a])});ad(this.i,c);this.N=new Tc}};r.vc=function(a){var b=this;Vb(a,function(a,d){Gd(b,d,a)})};r.kb=function(a){Gd(this,"authenticated",a)};function Gd(a,b,c){b=new I("/.info/"+b);U(a.oc,b,R(c));Bd(a.pc,b,[b])}r.Ya=function(a,b,c){this.o.Ya(a,function(a,c){X(b,a,c)},function(a,b){Rb("auth() was canceled: "+b);if(c){var f=Error(b);f.code=a.toUpperCase();c(f)}})};r.Bb=function(){this.o.Bb()};r.Va=function(a,b,c,d){this.e("set",{path:a.toString(),value:b});var b=R(b,c),c=Ed(this.Q,a,b,this.i.L,l),e=this.i.set(a,c),f=this;this.o.put(a.toString(),b.T(k),function(b){var c="ok"===b;ad(f.i,e);c||(Rb("set at "+a+" failed: "+b),Zc(f.i,a),c=Hd(f,a),Bd(f.Q,c,[]));X(d,b)});b=Id(this,a);Hd(this,b);Bd(this.Q,b,[a])};r.update=function(a,b,c){this.e("update",{path:a.toString(),value:b});var d=T(this.i.Ia,a),e=k,f=[],h;for(h in b){var e=o,i=R(b[h]),d=d.H(h,i);f.push(a.F(h))}if(e)O("update() called with empty data.  Don't do anything."),X(c,"ok");else{var d=Ed(this.Q,a,d,this.i.L,b),m=this.i.set(a,d),n=this;Rc(this.o,"m",a.toString(),b,function(b){z("ok"===b||"permission_denied"===b,"merge at "+a+" failed.");ad(n.i,m);X(c,b)},j);b=Id(this,a);Hd(this,b);Bd(n.Q,b,f)}};r.Ac=function(a,b,c){this.e("setPriority",{path:a.toString(),wa:b});var d=T(this.i.L,a).Cb(b),d=Ed(this.Q,a,d,this.i.L,l),e=this.i.set(a,d),f=this;this.o.put(a.toString()+"/.priority",b,function(a){ad(f.i,e);X(c,a)});a=Hd(this,a);Bd(f.Q,a,[])};r.sc=function(a,b){var c=this;this.o.sc(a.toString(),function(d){"ok"===d&&Vc(c.N,a);X(b,d)})};function Jd(a,b,c,d){var e=R(c);Pc(a.o,b.toString(),e.T(k),function(c){"ok"===c&&Uc(a.N,b,e);X(d,c)})}function Kd(a){gc(a.X,"deprecated_on_disconnect");a.cd.Dc.deprecated_on_disconnect=k}r.Eb=function(a,b,c,d,e){".info"===F(a.path)?this.pc.Eb(a,b,c,d,e):this.Q.Eb(a,b,c,d,e)};r.Wb=function(a,b,c,d){".info"===F(a.path)?this.pc.Wb(a,b,c,d):this.Q.Wb(a,b,c,d)};r.Pa=function(){this.o.Pa()};r.vb=function(){this.o.vb()};r.Bc=function(a){if("undefined"!==typeof console){a?(this.ac||(this.ac=new hc(this.X)),a=this.ac.get()):a=this.X.get();var b=a,c=[],d=0,e;for(e in b)c[d++]=e;var f=function(a,b){return Math.max(b.length,a)};if(c.reduce)e=c.reduce(f,0);else{var h=0;ib(c,function(a){h=f.call(j,h,a)});e=h}for(var i in a){b=a[i];for(c=i.length;c<e+2;c++)i+=" ";console.log(i+b)}}};r.Cc=function(a){gc(this.X,a);this.cd.Dc[a]=k};r.e=function(){O("r:"+this.o.id+":",arguments)};function X(a,b,c){if(a)if("ok"==b)a(l,c);else{var d=b=(b||"error").toUpperCase();c&&(d+=": "+c);c=Error(d);c.code=b;a(c)}}function Ld(a,b){var c=b||a.Wa;b||Md(a,c);if(c.j()!==l){var d=Nd(a,c);z(0<d.length);if(2!==d[0].status&&4!==d[0].status){for(var e=c.path(),f=0;f<d.length;f++)z(1===d[f].status,"tryToSendTransactionQueue_: items in queue should all be run."),d[f].status=2,d[f].ad++;c=T(a.i.L,e).hash();U(a.i.L,e,T(a.i.Ia,e));for(var h=T(a.Xa,e).T(k),i=Hb(),m={},n=0;n<d.length;n++)d[n].gc&&(m[d[n].path.toString()]=d[n].path);var p=[],s;for(s in m)p.push(m[s]);for(f=0;f<p.length;f++)N(L(a.i.pb,p[f]),i);a.o.put(e.toString(),h,function(b){a.e("transaction put response",{path:e.toString(),status:b});for(f=0;f<p.length;f++){var c=L(a.i.pb,p[f]),h=c.j();z(h!==l,"sendTransactionQueue_: pendingPut should not be null.");h===i&&(N(c,l),U(a.i.L,p[f],T(a.i.xb,p[f])))}if("ok"===b){b=[];for(f=0;f<d.length;f++)d[f].status=3,d[f].C&&(c=Od(a,d[f].path),b.push(v(d[f].C,l,l,k,c))),d[f].dc();Md(a,L(a.Wa,e));Ld(a);for(f=0;f<b.length;f++)b[f]()}else{if("datastale"===b)for(f=0;f<d.length;f++)d[f].status=4===d[f].status?5:1;else{Rb("transaction at "+e+" failed: "+b);for(f=0;f<d.length;f++)d[f].status=5,d[f].ec=b}b=Hd(a,e);Bd(a.Q,b,[e])}},c)}}else c.bb()&&c.w(function(b){Ld(a,b)})}function Hd(a,b){var c=Pd(a,b),d=c.path(),e=Nd(a,c);U(a.i.Ia,d,T(a.i.L,d));U(a.Xa,d,T(a.i.L,d));if(0!==e.length){for(var f=c=T(a.i.Ia,d),h=[],i=0;i<e.length;i++){var m=La(d,e[i].path),n=o,p;z(m!==l,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===e[i].status)n=k,p=e[i].ec;else if(1===e[i].status)if(25<=e[i].ad)n=k,p="maxretry";else{var s=e[i].update(c.G(m).T());t(s)?(za("transaction failed: Data returned ",s),s=R(s),c=c.pa(m,s),e[i].gc&&(f=f.pa(m,s))):(n=k,p="nodata")}n&&(e[i].dc(),e[i].status=3,e[i].C&&(n=new W(a,e[i].path),m=new S(c.G(m),n),"nodata"===p?h.push(v(e[i].C,l,l,o,m)):h.push(v(e[i].C,l,Error(p),o,m))))}p=T(a.i.L,d).k();c=c.Cb(p);f=f.Cb(p);U(a.Xa,d,c);U(a.i.Ia,d,f);Md(a,a.Wa);for(i=0;i<h.length;i++)h[i]();Ld(a)}return d}function Pd(a,b){for(var c,d=a.Wa;(c=F(b))!==l&&d.j()===l;)d=L(d,c),b=J(b);return d}function Nd(a,b){var c=[];Qd(a,b,c);c.sort(function(a,b){return a.Vc-b.Vc});return c}function Qd(a,b,c){var d=b.j();if(d!==l)for(var e=0;e<d.length;e++)c.push(d[e]);b.w(function(b){Qd(a,b,c)})}function Md(a,b){var c=b.j();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d;N(b,0<c.length?c:l)}b.w(function(b){Md(a,b)})}function Id(a,b){var c=Pd(a,b).path(),d=L(a.Wa,b);Qa(d,function(a){Rd(a)});Rd(d);Pa(d,function(a){Rd(a)});return c}function Rd(a){var b=a.j();if(b!==l){for(var c=[],d=-1,e=0;e<b.length;e++)4!==b[e].status&&(2===b[e].status?(z(d===e-1,"All SENT items should be at beginning of queue."),d=e,b[e].status=4,b[e].ec="set"):(z(1===b[e].status),b[e].dc(),b[e].C&&c.push(v(b[e].C,l,Error("set"),o,l))));-1===d?N(a,l):b.length=d+1;for(e=0;e<c.length;e++)c[e]()}}function Od(a,b){var c=new W(a,b);return new S(T(a.Xa,b),c)}function Y(){this.Ua={}}Y.qd=function(){return Y.Qc?Y.Qc:Y.Qc=new Y};Y.prototype.Pa=function(){for(var a in this.Ua)this.Ua[a].Pa()};Y.prototype.interrupt=Y.prototype.Pa;Y.prototype.vb=function(){for(var a in this.Ua)this.Ua[a].vb()};Y.prototype.resume=Y.prototype.vb;var Z={rd:function(a){var b=Q.prototype.hash;Q.prototype.hash=a;var c=Zb.prototype.hash;Zb.prototype.hash=a;return function(){Q.prototype.hash=b;Zb.prototype.hash=c}}};Z.hijackHash=Z.rd;Z.Fa=function(a){return a.Fa()};Z.queryIdentifier=Z.Fa;Z.td=function(a){return a.u.o.ea};Z.listens=Z.td;Z.Ad=function(a){return a.u.o.sb};Z.refConnection=Z.Ad;Z.gd=Jc;Z.DataConnection=Z.gd;Jc.prototype.sendRequest=Jc.prototype.xa;Jc.prototype.interrupt=Jc.prototype.Pa;Z.hd=Dc;Z.RealTimeConnection=Z.hd;Dc.prototype.sendRequest=Dc.prototype.zc;Dc.prototype.close=Dc.prototype.close;Z.fd=qb;Z.ConnectionTarget=Z.fd;Z.od=function(){wc=oc=k};Z.forceLongPolling=Z.od;Z.pd=function(){xc=k};Z.forceWebSockets=Z.pd;Z.Gd=function(a,b){a.u.o.yc=b};Z.setSecurityDebugCallback=Z.Gd;Z.Bc=function(a,b){a.u.Bc(b)};Z.stats=Z.Bc;Z.Cc=function(a,b){a.u.Cc(b)};Z.statsIncrementCounter=Z.Cc;function $(a,b,c){this.tb=a;this.O=b;this.va=c}$.prototype.cancel=function(a){A("Firebase.onDisconnect().cancel",0,1,arguments.length);C("Firebase.onDisconnect().cancel",1,a,k);this.tb.sc(this.O,a)};$.prototype.cancel=$.prototype.cancel;$.prototype.remove=function(a){A("Firebase.onDisconnect().remove",0,1,arguments.length);E("Firebase.onDisconnect().remove",this.O);C("Firebase.onDisconnect().remove",1,a,k);Jd(this.tb,this.O,l,a)};$.prototype.remove=$.prototype.remove;$.prototype.set=function(a,b){A("Firebase.onDisconnect().set",1,2,arguments.length);E("Firebase.onDisconnect().set",this.O);ya("Firebase.onDisconnect().set",a,o);C("Firebase.onDisconnect().set",2,b,k);Jd(this.tb,this.O,a,b)};$.prototype.set=$.prototype.set;$.prototype.Va=function(a,b,c){A("Firebase.onDisconnect().setWithPriority",2,3,arguments.length);E("Firebase.onDisconnect().setWithPriority",this.O);ya("Firebase.onDisconnect().setWithPriority",a,o);Da("Firebase.onDisconnect().setWithPriority",2,b,o);C("Firebase.onDisconnect().setWithPriority",3,c,k);(".length"===this.va||".keys"===this.va)&&g("Firebase.onDisconnect().setWithPriority failed: "+this.va+" is a read-only object.");var d=this.tb,e=this.O,f=R(a,b);Pc(d.o,e.toString(),f.T(k),function(a){"ok"===a&&Uc(d.N,e,f);X(c,a)})};$.prototype.setWithPriority=$.prototype.Va;$.prototype.update=function(a,b){A("Firebase.onDisconnect().update",1,2,arguments.length);E("Firebase.onDisconnect().update",this.O);Ca("Firebase.onDisconnect().update",a);C("Firebase.onDisconnect().update",2,b,k);var c=this.tb,d=this.O,e=k,f;for(f in a)e=o;if(e)O("onDisconnect().update() called with empty data.  Don't do anything."),X(b,k);else{e=c.o;f=d.toString();var h=function(e){if("ok"===e)for(var f in a){var h=R(a[f]);Uc(c.N,d.F(f),h)}X(b,e)};e.U?Qc(e,"om",f,a,h):e.lb.push({xc:f,action:"om",data:a,C:h})}};$.prototype.update=$.prototype.update;var Sd,Td=0,Ud=[];Sd=function(a){var b=a===Td;Td=a;for(var c=Array(8),d=7;0<=d;d--)c[d]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(a%64),a=Math.floor(a/64);z(0===a);a=c.join("");if(b){for(d=11;0<=d&&63===Ud[d];d--)Ud[d]=0;Ud[d]++}else for(d=0;12>d;d++)Ud[d]=Math.floor(64*Math.random());for(d=0;12>d;d++)a+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(Ud[d]);z(20===a.length,"NextPushId: Length should be 20.");return a};function W(){var a,b,c;if(arguments[0]instanceof Fd)c=arguments[0],a=arguments[1];else{A("new Firebase",1,2,arguments.length);var d=arguments[0];b=a="";var e=k,f="";if(u(d)){var h=d.indexOf("//");if(0<=h)var i=d.substring(0,h-1),d=d.substring(h+2);h=d.indexOf("/");-1===h&&(h=d.length);a=d.substring(0,h);var d=d.substring(h+1),m=a.split(".");if(3==m.length){h=m[2].indexOf(":");e=0<=h?"https"===i:k;if("firebase"===m[1])Qb(a+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");else{b=m[0];f="";d=("/"+d).split("/");for(i=0;i<d.length;i++)if(0<d[i].length){h=d[i];try{h=decodeURIComponent(h.replace(/\+/g," "))}catch(n){}f+="/"+h}}b=b.toLowerCase()}else b=l}e||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Rb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");a=new qb(a,e,b);b=new I(f);e=b.toString();if(!(d=!u(a.host)))if(!(d=0===a.host.length))if(!(d=!xa(a.jb)))if(d=0!==e.length)e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),d=!(u(e)&&0!==e.length&&!wa.test(e));d&&g(Error(B("new Firebase",1,o)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".'));arguments[1]?arguments[1]instanceof Y?c=arguments[1]:g(Error("Expected a valid Firebase.Context for second argument to new Firebase()")):c=Y.qd();e=a.toString();d=ta(c.Ua,e);d||(d=new Fd(a),c.Ua[e]=d);c=d;a=b}H.call(this,c,a)}ja(W,H);var Vd=W,Wd=["Firebase"],Xd=ba;!(Wd[0]in Xd)&&Xd.execScript&&Xd.execScript("var "+Wd[0]);for(var Yd;Wd.length&&(Yd=Wd.shift());)!Wd.length&&t(Vd)?Xd[Yd]=Vd:Xd=Xd[Yd]?Xd[Yd]:Xd[Yd]={};W.prototype.name=function(){A("Firebase.name",0,0,arguments.length);return this.path.f()?l:Ka(this.path)};W.prototype.name=W.prototype.name;W.prototype.F=function(a){A("Firebase.child",1,1,arguments.length);if(fa(a))a=String(a);else if(!(a instanceof I))if(F(this.path)===l){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/"));Ga("Firebase.child",b)}else Ga("Firebase.child",a);return new W(this.u,this.path.F(a))};W.prototype.child=W.prototype.F;W.prototype.parent=function(){A("Firebase.parent",0,0,arguments.length);var a=this.path.parent();return a===l?l:new W(this.u,a)};W.prototype.parent=W.prototype.parent;W.prototype.root=function(){A("Firebase.ref",0,0,arguments.length);for(var a=this;a.parent()!==l;)a=a.parent();return a};W.prototype.root=W.prototype.root;W.prototype.toString=function(){A("Firebase.toString",0,0,arguments.length);var a;if(this.parent()===l)a=this.u.toString();else{a=this.parent().toString()+"/";var b=this.name();a+=encodeURIComponent(String(b))}return a};W.prototype.toString=W.prototype.toString;W.prototype.set=function(a,b){A("Firebase.set",1,2,arguments.length);E("Firebase.set",this.path);ya("Firebase.set",a,o);C("Firebase.set",2,b,k);return this.u.Va(this.path,a,l,b)};W.prototype.set=W.prototype.set;W.prototype.update=function(a,b){A("Firebase.update",1,2,arguments.length);E("Firebase.update",this.path);Ca("Firebase.update",a);C("Firebase.update",2,b,k);return this.u.update(this.path,a,b)};W.prototype.update=W.prototype.update;W.prototype.Va=function(a,b,c){A("Firebase.setWithPriority",2,3,arguments.length);E("Firebase.setWithPriority",this.path);ya("Firebase.setWithPriority",a,o);Da("Firebase.setWithPriority",2,b,o);C("Firebase.setWithPriority",3,c,k);(".length"===this.name()||".keys"===this.name())&&g("Firebase.setWithPriority failed: "+this.name()+" is a read-only object.");return this.u.Va(this.path,a,b,c)};W.prototype.setWithPriority=W.prototype.Va;W.prototype.remove=function(a){A("Firebase.remove",0,1,arguments.length);E("Firebase.remove",this.path);C("Firebase.remove",1,a,k);this.set(l,a)};W.prototype.remove=W.prototype.remove;W.prototype.transaction=function(a,b,c){function d(){}A("Firebase.transaction",1,3,arguments.length);E("Firebase.transaction",this.path);C("Firebase.transaction",1,a,o);C("Firebase.transaction",2,b,k);t(c)&&"boolean"!=typeof c&&g(Error(B("Firebase.transaction",3,k)+"must be a boolean."));(".length"===this.name()||".keys"===this.name())&&g("Firebase.transaction failed: "+this.name()+" is a read-only object.");"undefined"===typeof c&&(c=k);var e=this.u,f=this.path,h=c;e.e("transaction on "+f);var i=new W(e,f);i.qc("value",d);var h={path:f,update:a,C:b,status:l,Vc:Hb(),gc:h,ad:0,dc:function(){i.Kb("value",d)},ec:l},m=h.update(T(e.Xa,f).T());if(t(m)){za("transaction failed: Data returned ",m);h.status=1;var n=L(e.Wa,f),p=n.j()||[];p.push(h);N(n,p);n=T(e.i.L,f).k();U(e.Xa,f,R(m,n));h.gc&&(U(e.i.Ia,f,R(m,n)),Bd(e.Q,f,[f]));Ld(e)}else h.dc(),h.C&&(e=Od(e,f),h.C(l,o,e))};W.prototype.transaction=W.prototype.transaction;W.prototype.Ac=function(a,b){A("Firebase.setPriority",1,2,arguments.length);E("Firebase.setPriority",this.path);Da("Firebase.setPriority",1,a,o);C("Firebase.setPriority",2,b,k);this.u.Ac(this.path,a,b)};W.prototype.setPriority=W.prototype.Ac;W.prototype.push=function(a,b){A("Firebase.push",0,2,arguments.length);E("Firebase.push",this.path);ya("Firebase.push",a,k);C("Firebase.push",2,b,k);var c=T(this.u.oc,new I(".info/serverTimeOffset")).T()||0,c=Sd((new Date).getTime()+c),c=this.F(c);"undefined"!==typeof a&&a!==l&&c.set(a,b);return c};W.prototype.push=W.prototype.push;W.prototype.fa=function(){return new $(this.u,this.path,this.name())};W.prototype.onDisconnect=W.prototype.fa;W.prototype.Bd=function(){Rb("FirebaseRef.removeOnDisconnect() being deprecated. Please use FirebaseRef.onDisconnect().remove() instead.");this.fa().remove();Kd(this.u)};W.prototype.removeOnDisconnect=W.prototype.Bd;W.prototype.Fd=function(a){Rb("FirebaseRef.setOnDisconnect(value) being deprecated. Please use FirebaseRef.onDisconnect().set(value) instead.");this.fa().set(a);Kd(this.u)};W.prototype.setOnDisconnect=W.prototype.Fd;W.prototype.Ya=function(a,b,c){A("Firebase.auth",1,3,arguments.length);u(a)||g(Error(B("Firebase.auth",1,o)+"must be a valid credential (a string)."));C("Firebase.auth",2,b,k);C("Firebase.auth",3,b,k);this.u.Ya(a,b,c)};W.prototype.auth=W.prototype.Ya;W.prototype.Bb=function(){this.u.Bb()};W.prototype.unauth=W.prototype.Bb;function Nb(a,b){z(!b||a===k||a===o,"Can't turn on custom loggers persistently.");a===k?("undefined"!==typeof console&&("function"===typeof console.log?Lb=v(console.log,console):"object"===typeof console.log&&(Lb=function(a){console.log(a)})),b&&ob.setItem("logging_enabled","true")):a?Lb=a:(Lb=l,ob.removeItem("logging_enabled"))}W.enableLogging=Nb;W.INTERNAL=Z;W.Context=Y})();(function(){window.RTCMultiConnection=function(channel,extras){extras=extras||{};this.channel=channel;var self=this,rtcSession,fileReceiver,textReceiver;self.onmessage=function(message){console.debug("DataChannel message:",message)};self.onopen=function(){console.debug("Data connection opened.")};self.onFileReceived=function(fileName){console.debug("File <",fileName,"> received successfully.")};self.onFileSent=function(file){console.debug("File <",file.name,"> sent successfully.")};self.onFileProgress=function(packets){console.debug("<",packets.remaining,"> items remaining.")};self.session=extras.session||Session.AudioVideo;self.direction=extras.direction||Direction.ManyToMany;function prepareInit(callback){if(!self.openSignalingChannel){if(typeof self.transmitRoomOnce=="undefined")self.transmitRoomOnce=true;self.openSignalingChannel=function(config){config=config||{};channel=config.channel||self.channel||"default-channel";var socket=new window.Firebase("https://popush.firebaseIO.com/"+channel);socket.channel=channel;socket.onmessage=config.onmessage;socket.on("child_added",function(data){var value=data.val();socket.onmessage(value)});socket.send=function(data){this.push(data)};if(!self.socket)self.socket=socket;if(channel!=self.channel||self.isInitiator&&channel==self.channel){socket.onDisconnect().remove();socket.isCreater=true}else{socket.isCreater=false}if(config.onopen)setTimeout(config.onopen,1);return socket};if(!window.Firebase){var script=document.createElement("script");script.src="https://cdn.firebase.com/v0/firebase.js";script.onload=callback;document.documentElement.appendChild(script)}else callback()}else callback()}function init(){if(self.config)return;self.direction=self.direction.lowercase();self.session=self.session.lowercase();self.config={autoCloseEntireSession:true,openSignalingChannel:function(config){return self.openSignalingChannel(config)},onNewSession:function(session){if(self.channel!==session.sessionid)return false;if(!rtcSession){self._session=session;return}if(self.onNewSession)return self.onNewSession(session);if(self.joinedARoom)return false;self.joinedARoom=true;return joinSession(session,session.extra)},onChannelOpened:function(userid){self.onopen(userid)},onChannelMessage:function(data){if(!data.size)data=JSON.parse(data);if(data.type==="text")textReceiver.receive(data,self.onmessage);else if(data.size||data.type==="file")fileReceiver.receive(data,self.config);else self.onmessage(data)},onChannelClosed:function(event){self.onclose(event)},onChannelError:function(event){self.onerror(event)},onFileReceived:function(fileName){self.onFileReceived(fileName)},onFileProgress:function(packets){self.onFileProgress(packets)},iceServers:self.iceServers,attachStream:self.attachStream,onRemoteStream:function(stream){self.onstream(stream)},onleave:function(userid,extra,ejected){self.onleave(userid,extra,ejected)},direction:self.direction.lowercase(),session:self.session.lowercase(),channel:self.channel,transmitRoomOnce:self.transmitRoomOnce,connection:self};rtcSession=new RTCMultiSession(self.config);fileReceiver=new FileReceiver;textReceiver=new TextReceiver;if(self._session)self.config.onNewSession(self._session)}function joinSession(session,extra){if(!session||!session.userid||!session.sessionid)throw"invalid data passed.";self.session=session.session;self.direction=session.direction;if(session.direction===Direction.OneWay||session.session===Session.Data)rtcSession.joinSession(session,extra||{});else captureUserMedia(function(){rtcSession.joinSession(session,extra||{})})}self.join=joinSession;self.open=function(_channel,extra){if(self.socket){self.socket.isCreater=true;self.socket.onDisconnect().remove()}self.isInitiator=true;if(typeof _channel==="string"){if(_channel)self.channel=_channel;extra=extra||{}}else extra=_channel||{};prepareInit(function(){init();captureUserMedia(function(){rtcSession.initSession(extra)})})};self.connect=function(_channel){if(_channel)self.channel=_channel;prepareInit(init)};self.onstream=function(stream){console.debug("stream:",stream)};self.send=function(data){if(!data)throw"No file, data or text message to share.";if(data.size)FileSender.send({file:data,channel:rtcSession,onFileSent:function(file){self.onFileSent(file)},onFileProgress:function(packets){self.onFileProgress(packets)}});else TextSender.send({text:data,channel:rtcSession})};function captureUserMedia(callback){var constraints,session=self.session;if(session===Session.Data||self.dontAttachStream||self.config.attachStream)return callback();if(self.attachStream){self.config.attachStream=self.attachStream;return callback()}if(session.isAudio()){console.debug("audio-only session");constraints={audio:true,video:false}}if(session.isScreen()){console.debug("screen-only session");video_constraints={mandatory:{chromeMediaSource:"screen"},optional:[]};constraints={audio:false,video:video_constraints}}if(session===Session.Video||session===Session.VideoData){console.debug("audio-less video-only session.");video_constraints={mandatory:{},optional:[]};constraints={audio:false,video:video_constraints}}var mediaElement=document.createElement(session.isAudio()?"audio":"video");mediaElement.muted=true;var mediaConfig={video:mediaElement,onsuccess:function(stream){self.config.attachStream=stream;self.myLocalStream=stream;callback&&callback();self.onstream({stream:stream,mediaElement:mediaElement,blobURL:mediaElement.mozSrcObject||mediaElement.src,type:"local"})},onerror:function(){window.joinedARoom=false;window.voiceLock=false;window.voiceon=false;$("#voice-on").removeClass("active");var length=window.mySockets.length;for(var i=0;i<length;++i){if(window.mySockets[i]){if(window.mySockets[i].isCreater){window.mySockets[i].remove();window.mySockets[i].unauth()}window.mySockets[i].onmessage=function(){return};delete window.mySockets[i]}}if(session.isAudio())throw"Unable to get access to your microphone";else if(session.isScreen()){if(location.protocol==="http:"){throw"Please test this WebRTC experiment on HTTPS."}else{throw"Screen capturing is either denied or not supported."}}else{throw"Unable to get access to your webcam"}}};if(constraints)mediaConfig.constraints=constraints;getUserMedia(mediaConfig);return true}this.onUserLeft=function(userid){console.debug(userid,"left!")};this.onleave=function(userid,extra,ejected){self.onUserLeft(userid,extra,ejected)};this.leave=function(userid){rtcSession.leave(userid,self.autoCloseEntireSession)};this.eject=function(userid){if(!userid)throw'"user-id" is mandatory.';rtcSession.leave(userid,self.autoCloseEntireSession)};for(var extra in extras){this[extra]=extras[extra]}};var Session={AudioVideoData:"audiovideodata",AudioVideo:"audiovideo",AudioData:"audiodata",VideoData:"videodata",Audio:"audio",Video:"video",Data:"data",ScreenData:"screendata",Screen:"screen"};window.RTCSession=Session;var Direction={OneWay:"oneway",OneToOne:"onetoone",OneToMany:"onetomany",ManyToMany:"manytomany"};window.RTCDirection=Direction;String.prototype.isAudio=function(){var session=this+"";return session===Session.Audio||session===Session.AudioData};String.prototype.isScreen=function(){var session=this+"";return session===Session.Screen||session===Session.ScreenData};String.prototype.lowercase=function(){var str=this+"";return str.toLowerCase().replace(/-|( )|\+|only|and/g,"")};Array.prototype.swap=function(){var swapped=[],arr=this,length=arr.length;for(var i=0;i<length;i++){if(arr[i])swapped[swapped.length]=arr[i]}return swapped};window.MediaStream=window.MediaStream||window.webkitMediaStream;window.moz=!!navigator.mozGetUserMedia;var RTCPeerConnection=function(options){var w=window,PeerConnection=w.mozRTCPeerConnection||w.webkitRTCPeerConnection,SessionDescription=w.mozRTCSessionDescription||w.RTCSessionDescription,IceCandidate=w.mozRTCIceCandidate||w.RTCIceCandidate;var STUN={url:!moz?"stun:stun.l.google.com:19302":"stun:23.21.150.121"};var TURN={url:"turn:webrtc%40live.com@numb.viagenie.ca",credential:"muazkh"};var iceServers={iceServers:options.iceServers||[STUN]};if(!moz&&!options.iceServers)iceServers.iceServers[1]=TURN;var optional={optional:[]};if(!moz){optional.optional=[{DtlsSrtpKeyAgreement:true}];if(options.onChannelMessage)optional.optional=[{RtpDataChannels:true}]}var peerConnection=new PeerConnection(iceServers,optional);openOffererChannel();peerConnection.onicecandidate=onicecandidate;if(options.attachStream)peerConnection.addStream(options.attachStream);peerConnection.onaddstream=onaddstream;function onicecandidate(event){if(!event.candidate||!peerConnection)return;if(options.onICE)options.onICE(event.candidate)}var remoteStreamEventFired=false;function onaddstream(event){if(remoteStreamEventFired||!event||!options.onRemoteStream)return;remoteStreamEventFired=true;options.onRemoteStream(event.stream)}var constraints=options.constraints||{optional:[],mandatory:{OfferToReceiveAudio:true,OfferToReceiveVideo:true}};var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),extractedChars="";function getChars(){extractedChars+=chars[parseInt(Math.random()*40)]||"";if(extractedChars.length<40)getChars();return extractedChars}function getInteropSDP(sdp){if(options.onAnswerSDP)sdp=sdp.replace(/(a=crypto:0 AES_CM_128_HMAC_SHA1_32)(.*?)(\r\n)/g,"");var inline=getChars()+"\r\n"+(extractedChars="");sdp=sdp.indexOf("a=crypto")==-1?sdp.replace(/c=IN/g,"a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:"+inline+"c=IN"):sdp;return sdp}if(moz&&!options.onChannelMessage)constraints.mandatory.MozDontOfferDataChannel=true;function createOffer(){if(!options.onOfferSDP)return;peerConnection.createOffer(function(sessionDescription){sessionDescription.sdp=getInteropSDP(sessionDescription.sdp);peerConnection.setLocalDescription(sessionDescription);options.onOfferSDP(sessionDescription)},null,constraints)}function createAnswer(){if(!options.onAnswerSDP)return;options.offerSDP=new SessionDescription(options.offerSDP);peerConnection.setRemoteDescription(options.offerSDP);peerConnection.createAnswer(function(sessionDescription){sessionDescription.sdp=getInteropSDP(sessionDescription.sdp);peerConnection.setLocalDescription(sessionDescription);options.onAnswerSDP(sessionDescription)},null,constraints)}if(options.onChannelMessage&&!moz||!options.onChannelMessage){createOffer();createAnswer()}var channel;function openOffererChannel(){if(!options.onChannelMessage||moz&&!options.onOfferSDP)return;_openOffererChannel();if(moz&&!options.attachStream){navigator.mozGetUserMedia({audio:true,fake:true},function(stream){peerConnection.addStream(stream);createOffer()},useless)}}function _openOffererChannel(){channel=peerConnection.createDataChannel(options.channel||"RTCDataChannel",moz?{}:{reliable:false});if(moz)channel.binaryType="blob";setChannelEvents()}function setChannelEvents(){channel.onmessage=function(event){if(options.onChannelMessage)options.onChannelMessage(event)};channel.onopen=function(){if(options.onChannelOpened)options.onChannelOpened(channel)};channel.onclose=function(event){if(options.onChannelClosed)options.onChannelClosed(event);console.warn("WebRTC Data Channel closed.",event)};channel.onerror=function(event){if(options.onChannelError)options.onChannelError(event);console.error("WebRTC Data Channel error:",event)}}if(options.onAnswerSDP&&moz)openAnswererChannel();function openAnswererChannel(){peerConnection.ondatachannel=function(event){channel=event.channel;channel.binaryType="blob";setChannelEvents()};if(moz&&!options.attachStream){navigator.mozGetUserMedia({audio:true,fake:true},function(stream){peerConnection.addStream(stream);createAnswer()},useless)}}function useless(){}return{addAnswerSDP:function(sdp){sdp=new SessionDescription(sdp);peerConnection.setRemoteDescription(sdp)},addICE:function(candidate){peerConnection.addIceCandidate(new IceCandidate({sdpMLineIndex:candidate.sdpMLineIndex,candidate:candidate.candidate}))},peer:peerConnection,channel:channel,sendData:function(message){channel&&channel.send(message)}}};var video_constraints={mandatory:{},optional:[]};function getUserMedia(options){var n=navigator,media;n.getMedia=n.webkitGetUserMedia||n.mozGetUserMedia;n.getMedia(options.constraints||{audio:true,video:video_constraints},streaming,options.onerror||function(e){console.error(e)});function streaming(stream){var video=options.video;if(video){video[moz?"mozSrcObject":"src"]=moz?stream:window.webkitURL.createObjectURL(stream);video.play()}options.onsuccess&&options.onsuccess(stream);media=stream;window.joinedARoom=true;window.voiceLock=false}return media}function RTCMultiSession(config){var session=config.session||Session.AudioVideo,direction=config.direction||Direction.ManyToMany,self={id:uniqueToken(),sessionid:config.channel,sockets:[],socketObjects:{}},channels="--",isbroadcaster,isAcceptNewSession=true,defaultSocket={},RTCDataChannels=[];window.mySockets=[];function openDefaultSocket(){defaultSocket=config.openSignalingChannel({onmessage:onDefaultSocketResponse});window.mySockets.push(defaultSocket)}function onDefaultSocketResponse(response){if(response.userid==self.id)return;if(isAcceptNewSession&&response.sessionid&&response.userid)if(config.onNewSession)config.onNewSession(response);if(response.newParticipant&&self.joinedARoom&&self.broadcasterid===response.userid)onNewParticipant(response.newParticipant,response.extra);if(response.userid&&response.targetUser==self.id&&response.participant&&channels.indexOf(response.userid)==-1){channels+=response.userid+"--";openSubSocket({isofferer:true,channel:response.channel||response.userid,closeSocket:true,extra:response.extra})}}function openSubSocket(_config){if(!_config.channel)return;var socketConfig={channel:_config.channel,onmessage:socketResponse,onopen:function(){if(isofferer&&!peer)initPeer();_config.socketIndex=socket.index=self.sockets.length;self.socketObjects[socketConfig.channel]=socket;self.sockets[_config.socketIndex]=socket}};var socket=config.openSignalingChannel(socketConfig),isofferer=_config.isofferer,extra=_config.extra||{},isGotRemoteStream,inner={},mediaElement=document.createElement(session.isAudio()?"audio":"video"),peer;window.mySockets.push(socket);mediaElement.muted=true;var peerConfig={onICE:function(candidate){socket.send({id:self.id,candidate:{sdpMLineIndex:candidate.sdpMLineIndex,candidate:JSON.stringify(candidate.candidate)}})},onChannelOpened:onChannelOpened,onChannelMessage:function(event){if(config.onChannelMessage)config.onChannelMessage(event.data)},attachStream:config.attachStream,onRemoteStream:function(stream){mediaElement[moz?"mozSrcObject":"src"]=moz?stream:window.webkitURL.createObjectURL(stream);mediaElement.autoplay=true;mediaElement.controls=true;mediaElement.play();_config.stream=stream;if(session.isAudio()){mediaElement.addEventListener("play",function(){setTimeout(function(){mediaElement.volume=1;window.audio=mediaElement;afterRemoteStreamStartedFlowing()},3e3)},false)}else onRemoteStreamStartsFlowing()},iceServers:config.iceServers,session:session};function initPeer(offerSDP){if(direction===Direction.OneToOne&&window.isFirstConnectionOpened)return;if(!offerSDP){peerConfig.onOfferSDP=sendsdp}else{peerConfig.offerSDP=offerSDP;peerConfig.onAnswerSDP=sendsdp}if(session.indexOf("data")===-1)peerConfig.onChannelMessage=null;if(session.isAudio()){peerConfig.constraints={optional:[],mandatory:{OfferToReceiveAudio:true,OfferToReceiveVideo:false}}}peer=RTCPeerConnection(peerConfig);if(config.onRemoteStream){peer.myOnRemoteStream=config.onRemoteStream}window.peerArray[_config.extra.username]=peer;window.peerUserArray.push(_config.extra.username)}function onRemoteStreamStartsFlowing(){if(!(mediaElement.readyState<=HTMLMediaElement.HAVE_CURRENT_DATA||mediaElement.paused||mediaElement.currentTime<=0)){afterRemoteStreamStartedFlowing()}else setTimeout(onRemoteStreamStartsFlowing,300)}function afterRemoteStreamStartedFlowing(){if(peer.myOnRemoteStream){peer.myOnRemoteStream({mediaElement:mediaElement,stream:_config.stream,session:session,direction:direction,blobURL:mediaElement.mozSrcObject||mediaElement.src,type:"remote",extra:extra||{},userid:_config.userid})}else{if(config.onRemoteStream)config.onRemoteStream({mediaElement:mediaElement,stream:_config.stream,session:session,direction:direction,blobURL:mediaElement.mozSrcObject||mediaElement.src,type:"remote",extra:extra||{},userid:_config.userid})}onSessionOpened()}function onChannelOpened(channel){RTCDataChannels[RTCDataChannels.length]=channel;if(config.onChannelOpened)config.onChannelOpened(extra);onSessionOpened()}function onSessionOpened(){if(isGotRemoteStream)return;window.isFirstConnectionOpened=isGotRemoteStream=true;if(direction===Direction.ManyToMany&&isbroadcaster&&channels.split("--").length>3){if(!_config.alreadySentDetails){_config.alreadySentDetails=true;var myContext={};if(socket){myContext["newParticipant"]=socket.channel}myContext["userid"]=self.id;myContext["extra"]=extra;defaultSocket.send(myContext)}}}function sendsdp(sdp){sdp=JSON.stringify(sdp);var part=parseInt(sdp.length/3);var firstPart=sdp.slice(0,part),secondPart=sdp.slice(part,sdp.length-1),thirdPart="";if(sdp.length>part+part){secondPart=sdp.slice(part,part+part);thirdPart=sdp.slice(part+part,sdp.length)}socket.send({id:self.id,firstPart:firstPart});socket.send({id:self.id,secondPart:secondPart});socket.send({id:self.id,thirdPart:thirdPart})}function socketResponse(response){if(response.id==self.id)return;if(response.firstPart||response.secondPart||response.thirdPart){if(response.firstPart){_config.userid=response.id;inner.firstPart=response.firstPart;if(inner.secondPart&&inner.thirdPart)selfInvoker()}if(response.secondPart){inner.secondPart=response.secondPart;if(inner.firstPart&&inner.thirdPart)selfInvoker()}if(response.thirdPart){inner.thirdPart=response.thirdPart;if(inner.firstPart&&inner.secondPart)selfInvoker()}}if(response.candidate&&!isGotRemoteStream){peer&&peer.addICE({sdpMLineIndex:response.candidate.sdpMLineIndex,candidate:JSON.parse(response.candidate.candidate)})}var ejected=false;if(response.left){if(peer&&peer.peer){peer.peer.close();peer.peer=null}if(response.closeEntireSession){ejected=true;config.connection.myLocalStream.stop();leaveARoom()}else if(socket){socket.send({left:true,extra:self.extra,id:self.id});if(self.sockets[_config.socketIndex])delete self.sockets[_config.socketIndex];if(self.socketObjects[socket.channel])delete self.socketObjects[socket.channel];socket=null}if(config.onleave)config.onleave(response.id,response.extra,ejected)}if(response.playRoleOfBroadcaster)setTimeout(function(){self.id=response.id;config.connection.open({extra:self.extra});self.sockets=self.sockets.swap()},600)}var invokedOnce=false;function selfInvoker(){if(invokedOnce)return;invokedOnce=true;inner.sdp=JSON.parse(inner.firstPart+inner.secondPart+inner.thirdPart);if(isofferer)peer.addAnswerSDP(inner.sdp);else initPeer(inner.sdp)}}function onNewParticipant(channel,extra){if(!channel||channels.indexOf(channel)!=-1||channel==self.id)return;channels+=channel+"--";var new_channel=uniqueToken();openSubSocket({channel:new_channel,closeSocket:true,extra:extra||{}});defaultSocket.send({participant:true,userid:self.id,targetUser:channel,channel:new_channel,extra:self.extra})}function uniqueToken(){return(Math.random()*(new Date).getTime()).toString(36).toUpperCase().replace(/\./g,"-")}function leaveARoom(channel){var alert={left:true,extra:self.extra||{},id:self.id};if(isbroadcaster){if(config.autoCloseEntireSession)alert.closeEntireSession=true;else self.sockets[0].send({playRoleOfBroadcaster:true,id:self.id})}if(!channel){var sockets=self.sockets,length=sockets.length;for(var i=0;i<length;i++){var socket=sockets[i];if(socket){socket.send(alert);if(self.socketObjects[socket.channel])delete self.socketObjects[socket.channel];delete sockets[i]}}that.left=true;function weisuoFun(){length=window.mySockets.length;for(var i=0;i<length;++i){if(window.mySockets[i]){if(window.mySockets[i].isCreater){window.mySockets[i].remove();window.mySockets[i].unauth()}window.mySockets[i].onmessage=function(){return};delete window.mySockets[i]}}window.voiceLock=false;window.joinedARoom=false}setTimeout(weisuoFun,1e3)}if(channel){socket=self.socketObjects[channel];if(socket){socket.send(alert);if(self.sockets[socket.index])delete self.sockets[socket.index];delete self.socketObjects[channel]}}self.sockets=self.sockets.swap()}var that=this;window.onunload=function(){leaveARoom()};openDefaultSocket();return{initSession:function(extra){isbroadcaster=true;isAcceptNewSession=false;extra=extra||{};extra.interval=extra.interval||3e3;self.extra=extra.extra=extra.extra||{};(function transmit(){defaultSocket.send({sessionid:self.sessionid,userid:self.id,session:config.session,direction:config.direction,extra:extra.extra});if(!config.transmitRoomOnce&&!that.leaving){if(config.direction===Direction.OneToOne){if(!window.isFirstConnectionOpened)setTimeout(transmit,extra.interval)}else setTimeout(transmit,extra.interval)}})();self.extra=extra},joinSession:function(_config,extra){_config=_config||{};self.extra=extra;session=_config.session;direction=_config.direction;self.joinedARoom=true;if(_config.sessionid)self.sessionid=_config.sessionid;isAcceptNewSession=false;openSubSocket({channel:self.id,extra:_config.extra||{}});defaultSocket.send({participant:true,userid:self.id,targetUser:_config.userid,extra:extra||{}});self.broadcasterid=_config.userid},send:function(message){var _channels=RTCDataChannels,data,length=_channels.length;if(!length)return;if(moz&&message.file)data=message.file;else data=JSON.stringify(message);for(var i=0;i<length;i++)_channels[i].send(data)},getSession:function(){return{userid:self.id,sessionid:self.sessionid,session:session,direction:direction}},leave:function(userid,autoCloseEntireSession){if(autoCloseEntireSession)config.autoCloseEntireSession=true;leaveARoom(userid);if(!userid){self.joinedARoom=isbroadcaster=false;isAcceptNewSession=true}}}}var FileSender={send:function(config){var channel=config.channel,file=config.file;if(moz){channel.send({fileName:file.name,type:"file"});channel.send({file:file});if(config.onFileSent)config.onFileSent(file)}if(!moz){var reader=new window.FileReader;reader.readAsDataURL(file);reader.onload=onReadAsDataURL}var packetSize=1e3,textToTransfer="",numberOfPackets=0,packets=0;function onReadAsDataURL(event,text){var data={type:"file"};if(event){text=event.target.result;numberOfPackets=packets=data.packets=parseInt(text.length/packetSize)}if(config.onFileProgress)config.onFileProgress({remaining:packets--,length:numberOfPackets,sent:numberOfPackets-packets});if(text.length>packetSize)data.message=text.slice(0,packetSize);else{data.message=text;data.last=true;data.name=file.name;if(config.onFileSent)config.onFileSent(file)}channel.send(data);textToTransfer=text.slice(data.message.length);if(textToTransfer.length)setTimeout(function(){onReadAsDataURL(null,textToTransfer)},500)}}};function FileReceiver(){var content=[],fileName="",packets=0,numberOfPackets=0;function receive(data,config){if(moz){if(data.fileName)fileName=data.fileName;if(data.size){var reader=new window.FileReader;reader.readAsDataURL(data);reader.onload=function(event){FileSaver.SaveToDisk(event.target.result,fileName);if(config.onFileReceived)config.onFileReceived(fileName)}}}if(!moz){if(data.packets)numberOfPackets=packets=parseInt(data.packets);if(config.onFileProgress)config.onFileProgress({remaining:packets--,length:numberOfPackets,received:numberOfPackets-packets});content.push(data.message);if(data.last){FileSaver.SaveToDisk(content.join(""),data.name);if(config.onFileReceived)config.onFileReceived(data.name);content=[]}}}return{receive:receive}}var TextSender={send:function(config){var channel=config.channel,initialText=config.text,packetSize=1e3,textToTransfer="";if(typeof initialText!=="string")initialText=JSON.stringify(initialText);if(moz||initialText.length<=packetSize)channel.send(config.text);else sendText(initialText);function sendText(textMessage,text){var data={type:"text"};if(textMessage){text=textMessage;data.packets=parseInt(text.length/packetSize)}if(text.length>packetSize)data.message=text.slice(0,packetSize);else{data.message=text;data.last=true}channel.send(data);textToTransfer=text.slice(data.message.length);if(textToTransfer.length)setTimeout(function(){sendText(null,textToTransfer)},500)}}};function TextReceiver(){var content=[];function receive(data,onmessage){content.push(data.message);if(data.last){if(onmessage)onmessage(content.join(""));content=[]}}return{receive:receive}}var FileSaver={SaveToDisk:function(fileUrl,fileName){var save=document.createElement("a");save.href=fileUrl;save.target="_blank";save.download=fileName||fileUrl;var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,1,0,0,0,0,false,false,false,false,0,null);save.dispatchEvent(evt);(window.URL||window.webkitURL).revokeObjectURL(save.href)}}})();!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||s.toggleClass("open"),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);window.CodeMirror=function(){"use strict";var gecko=/gecko\/\d/i.test(navigator.userAgent);var ie=/MSIE \d/.test(navigator.userAgent);var ie_lt8=ie&&(document.documentMode==null||document.documentMode<8);var ie_lt9=ie&&(document.documentMode==null||document.documentMode<9);var webkit=/WebKit\//.test(navigator.userAgent);var qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var chrome=/Chrome\//.test(navigator.userAgent);var opera=/Opera\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\//.test(navigator.userAgent);var mac_geLion=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent);var mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var phantom=/PhantomJS/.test(navigator.userAgent);var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var windows=/windows/i.test(navigator.platform);var opera_version=opera&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(opera_version)opera_version=Number(opera_version[1]);var flipCtrlCmd=mac&&(qtwebkit||opera&&(opera_version==null||opera_version<12.11));var captureMiddleClick=gecko||ie&&!ie_lt9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options||{};for(var opt in defaults)if(!options.hasOwnProperty(opt)&&defaults.hasOwnProperty(opt))options[opt]=defaults[opt];setGuttersForLineNumbers(options);var docStart=typeof options.value=="string"?0:options.value.first;var display=this.display=makeDisplay(place,docStart);display.wrapper.CodeMirror=this;updateGutters(this);if(options.autofocus&&!mobile)focusInput(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,draggingText:false,highlight:new Delayed};themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=" CodeMirror-wrap";var doc=options.value;if(typeof doc=="string")doc=new Doc(options.value,options.mode);operation(this,attachDoc)(this,doc);if(ie)setTimeout(bind(resetInput,this,true),20);registerEventHandlers(this);var hasFocus;try{hasFocus=document.activeElement==display.input}catch(e){}if(hasFocus||options.autofocus&&!mobile)setTimeout(bind(onFocus,this),20);else onBlur(this);operation(this,function(){for(var opt in optionHandlers)if(optionHandlers.propertyIsEnumerable(opt))optionHandlers[opt](this,options[opt],Init);for(var i=0;i<initHooks.length;++i)initHooks[i](this)})()}function makeDisplay(place,docStart){var d={};var input=d.input=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");if(webkit)input.style.width="1000px";else input.setAttribute("wrap","off");if(ios)input.style.border="1px solid black";input.setAttribute("autocorrect","off");input.setAttribute("autocapitalize","off");d.inputDiv=elt("div",[input],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");d.scrollbarH=elt("div",[elt("div",null,null,"height: 1px")],"CodeMirror-hscrollbar");d.scrollbarV=elt("div",[elt("div",null,null,"width: 1px")],"CodeMirror-vscrollbar");d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler");d.lineDiv=elt("div");d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1");d.cursor=elt("div"," ","CodeMirror-cursor");d.otherCursor=elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor");d.measure=elt("div",null,"CodeMirror-measure");d.lineSpace=elt("div",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,"position: relative; outline: none");d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative");d.sizer=elt("div",[d.mover],"CodeMirror-sizer");d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerCutOff+"px; width: 1px;");d.gutters=elt("div",null,"CodeMirror-gutters");d.lineGutter=null;var scrollerInner=elt("div",[d.sizer,d.heightForcer,d.gutters],null,"position: relative; min-height: 100%");d.scroller=elt("div",[scrollerInner],"CodeMirror-scroll");d.scroller.setAttribute("tabIndex","-1");d.wrapper=elt("div",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.scroller],"CodeMirror");if(ie_lt8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper);if(ios)input.style.width="0px";if(!webkit)d.scroller.draggable=true;if(khtml){d.inputDiv.style.height="1px";d.inputDiv.style.position="absolute"}else if(ie_lt8)d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth="18px";d.viewOffset=d.lastSizeC=0;d.showingFrom=d.showingTo=docStart;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.prevInput="";d.alignWidgets=false;d.pollingFast=false;d.poll=new Delayed;d.cachedCharWidth=d.cachedTextHeight=null;d.measureLineCache=[];d.measureLineCachePos=0;d.inaccurateSelection=false;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;return d}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm)}function wrappingChanged(cm){if(cm.options.lineWrapping){cm.display.wrapper.className+=" CodeMirror-wrap";cm.display.sizer.style.minWidth=""}else{cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-wrap","");computeMaxLength(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm.display,cm.doc.height)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;else if(wrapping)return(Math.ceil(line.text.length/perLine)||1)*th;else return th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight)})}function keyMapChanged(cm){var style=keyMap[cm.options.keyMap].style;cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(style?" cm-keymap-"+style:"")}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-");clearCaches(cm)}function guttersChanged(cm){updateGutters(cm);regChange(cm)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));if(gutterClass=="CodeMirror-linenumbers"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+"px"}}gutters.style.display=i?"":"none"}function lineLength(doc,line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find();cur=getLine(doc,found.from.line);len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();len-=cur.text.length-found.from.ch;cur=getLine(doc,found.to.line);len+=cur.text.length-found.to.ch}return len}function computeMaxLength(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(doc,d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(doc,line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}})}function setGuttersForLineNumbers(options){var found=false;for(var i=0;i<options.gutters.length;++i){if(options.gutters[i]=="CodeMirror-linenumbers"){if(options.lineNumbers)found=true;else options.gutters.splice(i--,1)}}if(!found&&options.lineNumbers)options.gutters.push("CodeMirror-linenumbers")}function updateScrollbars(d,docHeight){var totalHeight=docHeight+paddingVert(d);d.sizer.style.minHeight=d.heightForcer.style.top=totalHeight+"px";var scrollHeight=Math.max(totalHeight,d.scroller.scrollHeight);var needsH=d.scroller.scrollWidth>d.scroller.clientWidth;var needsV=scrollHeight>d.scroller.clientHeight;if(needsV){d.scrollbarV.style.display="block";d.scrollbarV.style.bottom=needsH?scrollbarWidth(d.measure)+"px":"0";d.scrollbarV.firstChild.style.height=scrollHeight-d.scroller.clientHeight+d.scrollbarV.clientHeight+"px"}else d.scrollbarV.style.display="";if(needsH){d.scrollbarH.style.display="block";d.scrollbarH.style.right=needsV?scrollbarWidth(d.measure)+"px":"0";d.scrollbarH.firstChild.style.width=d.scroller.scrollWidth-d.scroller.clientWidth+d.scrollbarH.clientWidth+"px"}else d.scrollbarH.style.display="";if(needsH&&needsV){d.scrollbarFiller.style.display="block";d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=scrollbarWidth(d.measure)+"px"}else d.scrollbarFiller.style.display="";if(mac_geLion&&scrollbarWidth(d.measure)===0)d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=mac_geMountainLion?"18px":"12px"}function visibleLines(display,doc,viewPort){var top=display.scroller.scrollTop,height=display.wrapper.clientHeight;if(typeof viewPort=="number")top=viewPort;else if(viewPort){top=viewPort.top;height=viewPort.bottom-viewPort.top}top=Math.floor(top-paddingTop(display));var bottom=Math.ceil(top+height);return{from:lineAtHeight(doc,top),to:lineAtHeight(doc,bottom)}}function alignHorizontally(cm){var display=cm.display;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,l=comp+"px";for(var n=display.lineDiv.firstChild;n;n=n.nextSibling)if(n.alignable){for(var i=0,a=n.alignable;i<a.length;++i)a[i].style.left=l}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+"px"}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width="";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding);display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+"px";return true}return false}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return getRect(display.scroller).left-getRect(display.sizer).left}function updateDisplay(cm,changes,viewPort){var oldFrom=cm.display.showingFrom,oldTo=cm.display.showingTo,updated;var visible=visibleLines(cm.display,cm.doc,viewPort);for(;;){if(updateDisplayInner(cm,changes,visible)){updated=true;signalLater(cm,"update",cm);if(cm.display.showingFrom!=oldFrom||cm.display.showingTo!=oldTo)signalLater(cm,"viewportChange",cm,cm.display.showingFrom,cm.display.showingTo)}else break;updateSelection(cm);updateScrollbars(cm.display,cm.doc.height);if(viewPort)viewPort=Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,typeof viewPort=="number"?viewPort:viewPort.top);visible=visibleLines(cm.display,cm.doc,viewPort);if(visible.from>=cm.display.showingFrom&&visible.to<=cm.display.showingTo)break;changes=[]}return updated}function updateDisplayInner(cm,changes,visible){var display=cm.display,doc=cm.doc;if(!display.wrapper.clientWidth){display.showingFrom=display.showingTo=doc.first;display.viewOffset=0;return}if(changes.length==0&&visible.from>display.showingFrom&&visible.to<display.showingTo)return;if(maybeUpdateLineNumberWidth(cm))changes=[{from:doc.first,to:doc.first+doc.size}];var gutterW=display.sizer.style.marginLeft=display.gutters.offsetWidth+"px";display.scrollbarH.style.left=cm.options.fixedGutter?gutterW:"0";var positionsChangedFrom=Infinity;if(cm.options.lineNumbers)for(var i=0;i<changes.length;++i)if(changes[i].diff){positionsChangedFrom=changes[i].from;break}var end=doc.first+doc.size;var from=Math.max(visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,visible.to+cm.options.viewportMargin);if(display.showingFrom<from&&from-display.showingFrom<20)from=Math.max(doc.first,display.showingFrom);if(display.showingTo>to&&display.showingTo-to<20)to=Math.min(end,display.showingTo);if(sawCollapsedSpans){from=lineNo(visualLine(doc,getLine(doc,from)));while(to<end&&lineIsHidden(doc,getLine(doc,to)))++to}var intact=[{from:Math.max(display.showingFrom,doc.first),to:Math.min(display.showingTo,end)}];if(intact[0].from>=intact[0].to)intact=[];else intact=computeIntact(intact,changes);if(sawCollapsedSpans)for(var i=0;i<intact.length;++i){var range=intact[i],merged;while(merged=collapsedSpanAtEnd(getLine(doc,range.to-1))){var newTo=merged.find().from.line;if(newTo>range.from)range.to=newTo;else{intact.splice(i--,1);break}}}var intactLines=0;for(var i=0;i<intact.length;++i){var range=intact[i];if(range.from<from)range.from=from;if(range.to>to)range.to=to;if(range.from>=range.to)intact.splice(i--,1);else intactLines+=range.to-range.from}if(intactLines==to-from&&from==display.showingFrom&&to==display.showingTo){updateViewOffset(cm);return}intact.sort(function(a,b){return a.from-b.from});try{var focused=document.activeElement}catch(e){}if(intactLines<(to-from)*.7)display.lineDiv.style.display="none";patchDisplay(cm,from,to,intact,positionsChangedFrom);display.lineDiv.style.display="";if(focused&&document.activeElement!=focused&&focused.offsetHeight)focused.focus();var different=from!=display.showingFrom||to!=display.showingTo||display.lastSizeC!=display.wrapper.clientHeight;if(different)display.lastSizeC=display.wrapper.clientHeight;display.showingFrom=from;display.showingTo=to;startWorker(cm,100);var prevBottom=display.lineDiv.offsetTop;for(var node=display.lineDiv.firstChild,height;node;node=node.nextSibling)if(node.lineObj){if(ie_lt8){var bot=node.offsetTop+node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=getRect(node);height=box.bottom-box.top}var diff=node.lineObj.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(node.lineObj,height);var widgets=node.lineObj.widgets;if(widgets)for(var i=0;i<widgets.length;++i)widgets[i].height=widgets[i].node.offsetHeight}}updateViewOffset(cm);return true}function updateViewOffset(cm){var off=cm.display.viewOffset=heightAtLine(cm,getLine(cm.doc,cm.display.showingFrom));cm.display.mover.style.top=off+"px"}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;i<l;++i){var change=changes[i],intact2=[],diff=change.diff||0;for(var j=0,l2=intact.length;j<l2;++j){var range=intact[j];if(change.to<=range.from&&change.diff){intact2.push({from:range.from+diff,to:range.to+diff})}else if(change.to<=range.from||change.from>=range.to){intact2.push(range)}else{if(change.from>range.from)intact2.push({from:range.from,to:change.from});if(change.to<range.to)intact2.push({from:change.to+diff,to:range.to+diff})}}intact=intact2}return intact}function getDimensions(cm){var d=cm.display,left={},width={};for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft;width[cm.options.gutters[i]]=n.offsetWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,from,to,intact,updateNumbersFrom){var dims=getDimensions(cm);var display=cm.display,lineNumbers=cm.options.lineNumbers;if(!intact.length&&(!webkit||!cm.display.currentWheelTarget))removeChildren(display.lineDiv);var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display="none";node.lineObj=null}else{node.parentNode.removeChild(node)}return next}var nextIntact=intact.shift(),lineN=from;cm.doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==lineN)nextIntact=intact.shift();if(lineIsHidden(cm.doc,line)){if(line.height!=0)updateLineHeight(line,0);if(line.widgets&&cur.previousSibling)for(var i=0;i<line.widgets.length;++i)if(line.widgets[i].showIfHidden){var prev=cur.previousSibling;if(/pre/i.test(prev.nodeName)){var wrap=elt("div",null,null,"position: relative");prev.parentNode.replaceChild(wrap,prev);wrap.appendChild(prev);prev=wrap}var wnode=prev.appendChild(elt("div",[line.widgets[i].node],"CodeMirror-linewidget"));positionLineWidget(line.widgets[i],wnode,prev,dims)}}else if(nextIntact&&nextIntact.from<=lineN&&nextIntact.to>lineN){while(cur.lineObj!=line)cur=rm(cur);if(lineNumbers&&updateNumbersFrom<=lineN&&cur.lineNumber)setTextContent(cur.lineNumber,lineNumberFor(cm.options,lineN));cur=cur.nextSibling}else{if(line.widgets)for(var j=0,search=cur,reuse;search&&j<20;++j,search=search.nextSibling)if(search.lineObj==line&&/div/i.test(search.nodeName)){reuse=search;break}var lineNode=buildLineElement(cm,line,lineN,dims,reuse);if(lineNode!=reuse){container.insertBefore(lineNode,cur)}else{while(cur!=reuse)cur=rm(cur);cur=cur.nextSibling}lineNode.lineObj=line}++lineN});while(cur)cur=rm(cur)}function buildLineElement(cm,line,lineNo,dims,reuse){var lineElement=lineContent(cm,line);var markers=line.gutterMarkers,display=cm.display,wrap;if(!cm.options.lineNumbers&&!markers&&!line.bgClass&&!line.wrapClass&&!line.widgets)return lineElement;if(reuse){reuse.alignable=null;var isOk=true,widgetsSeen=0;for(var n=reuse.firstChild,next;n;n=next){next=n.nextSibling;if(!/\bCodeMirror-linewidget\b/.test(n.className)){reuse.removeChild(n)}else{for(var i=0,first=true;i<line.widgets.length;++i){var widget=line.widgets[i],isFirst=false;if(!widget.above){isFirst=first;first=false}if(widget.node==n.firstChild){positionLineWidget(widget,n,reuse,dims);++widgetsSeen;if(isFirst)reuse.insertBefore(lineElement,n);break}}if(i==line.widgets.length){isOk=false;break}}}if(isOk&&widgetsSeen==line.widgets.length){wrap=reuse;reuse.className=line.wrapClass||""}}if(!wrap){wrap=elt("div",null,line.wrapClass,"position: relative");wrap.appendChild(lineElement)}if(line.bgClass)wrap.insertBefore(elt("div",null,line.bgClass+" CodeMirror-linebackground"),wrap.firstChild);if(cm.options.lineNumbers||markers){var gutterWrap=wrap.insertBefore(elt("div",null,null,"position: absolute; left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px"),wrap.firstChild);if(cm.options.fixedGutter)(wrap.alignable||(wrap.alignable=[])).push(gutterWrap);if(cm.options.lineNumbers&&(!markers||!markers["CodeMirror-linenumbers"]))wrap.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineNo),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+display.lineNumInnerWidth+"px"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}if(ie_lt8)wrap.style.zIndex=2;if(line.widgets&&wrap!=reuse)for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");positionLineWidget(widget,node,wrap,dims);if(widget.above)wrap.insertBefore(node,cm.options.lineNumbers&&line.height!=0?gutterWrap:lineElement);else wrap.appendChild(node);signalLater(widget,"redraw")}return wrap}function positionLineWidget(widget,node,wrap,dims){if(widget.noHScroll){(wrap.alignable||(wrap.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+"px"}node.style.width=width+"px"}if(widget.coverGutter){node.style.zIndex=5;node.style.position="relative";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+"px"}}function updateSelection(cm){var display=cm.display;var collapsed=posEq(cm.doc.sel.from,cm.doc.sel.to);if(collapsed||cm.options.showCursorWhenSelecting)updateSelectionCursor(cm);else display.cursor.style.display=display.otherCursor.style.display="none";if(!collapsed)updateSelectionRange(cm);else display.selectionDiv.style.display="none";if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,cm.doc.sel.head,"div");var wrapOff=getRect(display.wrapper),lineOff=getRect(display.lineDiv);display.inputDiv.style.top=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top))+"px";display.inputDiv.style.left=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))+"px"}}function updateSelectionCursor(cm){var display=cm.display,pos=cursorCoords(cm,cm.doc.sel.head,"div");display.cursor.style.left=pos.left+"px";display.cursor.style.top=pos.top+"px";display.cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px";display.cursor.style.display="";if(pos.other){display.otherCursor.style.display="";display.otherCursor.style.left=pos.other.left+"px";display.otherCursor.style.top=pos.other.top+"px";display.otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+"px"}else{display.otherCursor.style.display="none"}}function updateSelectionRange(cm){var display=cm.display,doc=cm.doc,sel=cm.doc.sel;var fragment=document.createDocumentFragment();var clientWidth=display.lineSpace.offsetWidth,pl=paddingLeft(cm.display);function add(left,top,width,bottom){if(top<0)top=0;fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(width==null?clientWidth-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg,retTop){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length,rVal=retTop?Infinity:-Infinity;function coords(ch){return charCoords(cm,Pos(line,ch),"div",lineObj)}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left}else{rightPos=coords(to-1);if(dir=="rtl"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp}left=leftPos.left;right=rightPos.right}if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=pl;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top)}if(toArg==null&&to==lineLen)right=clientWidth;if(fromArg==null&&from==0)left=pl;rVal=retTop?Math.min(rightPos.top,rVal):Math.max(rightPos.bottom,rVal);if(left<pl+1)left=pl;add(left,rightPos.top,right-left,rightPos.bottom)});return rVal}if(sel.from.line==sel.to.line){drawForLine(sel.from.line,sel.from.ch,sel.to.ch)}else{var fromObj=getLine(doc,sel.from.line);var cur=fromObj,merged,path=[sel.from.line,sel.from.ch],singleLine;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find();path.push(found.from.ch,found.to.line,found.to.ch);if(found.to.line==sel.to.line){path.push(sel.to.ch);singleLine=true;break}cur=getLine(doc,found.to.line)}if(singleLine){for(var i=0;i<path.length;i+=3)drawForLine(path[i],path[i+1],path[i+2])}else{var middleTop,middleBot,toObj=getLine(doc,sel.to.line);if(sel.from.ch)middleTop=drawForLine(sel.from.line,sel.from.ch,null,false);else middleTop=heightAtLine(cm,fromObj)-display.viewOffset;if(!sel.to.ch)middleBot=heightAtLine(cm,toObj)-display.viewOffset;else middleBot=drawForLine(sel.to.line,collapsedSpanAtStart(toObj)?null:0,sel.to.ch,true);if(middleTop<middleBot)add(pl,middleTop,null,middleBot)}}removeChildrenAndAdd(display.selectionDiv,fragment);display.selectionDiv.style.display=""}function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursor.style.visibility=display.otherCursor.style.visibility="";display.blinker=setInterval(function(){display.cursor.style.visibility=display.otherCursor.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate)}function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.showingTo)cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.showingTo)return;var end=+new Date+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changed=[],prevChange;doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.showingTo+500),function(line){if(doc.frontier>=cm.display.showingFrom){var oldStyles=line.styles;line.styles=highlightLine(cm,line,state);var ischange=!oldStyles||oldStyles.length!=line.styles.length;for(var i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];if(ischange){if(prevChange&&prevChange.end==doc.frontier)prevChange.end++;else changed.push(prevChange={start:doc.frontier,end:doc.frontier+1})}line.stateAfter=copyState(doc.mode,state)}else{processLine(cm,line,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null}++doc.frontier;if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}});if(changed.length)operation(cm,function(){for(var i=0;i<changed.length;++i)regChange(this,changed[i].start,changed[i].end)})()}function findStartLine(cm,n){var minindent,minline,doc=cm.doc;for(var search=n,lim=n-100;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter)return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function getStateBefore(cm,n){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line,state);var save=pos==n-1||pos%5==0||pos>=display.showingFrom&&pos<display.showingTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos});return state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingLeft(display){var e=removeChildrenAndAdd(display.measure,elt("pre",null,null,"text-align: left")).appendChild(elt("span","x"));return e.offsetLeft}function measureChar(cm,line,ch,data){var dir=-1;data=data||measureLine(cm,line);for(var pos=ch;;pos+=dir){var r=data[pos];if(r)break;if(dir<0&&pos==0)dir=1}return{left:pos<ch?r.right:r.left,right:pos>ch?r.left:r.right,top:r.top,bottom:r.bottom}}function findCachedMeasurement(cm,line){var cache=cm.display.measureLineCache;for(var i=0;i<cache.length;++i){var memo=cache[i];if(memo.text==line.text&&memo.markedSpans==line.markedSpans&&cm.display.scroller.clientWidth==memo.width&&memo.classes==line.textClass+"|"+line.bgClass+"|"+line.wrapClass)return memo.measure}}function measureLine(cm,line){var measure=findCachedMeasurement(cm,line);if(!measure){measure=measureLineInner(cm,line);var cache=cm.display.measureLineCache;var memo={text:line.text,width:cm.display.scroller.clientWidth,markedSpans:line.markedSpans,measure:measure,classes:line.textClass+"|"+line.bgClass+"|"+line.wrapClass};if(cache.length==16)cache[++cm.display.measureLineCachePos%16]=memo;else cache.push(memo)}return measure}function measureLineInner(cm,line){var display=cm.display,measure=emptyArray(line.text.length);var pre=lineContent(cm,line,measure);if(ie&&!ie_lt8&&!cm.options.lineWrapping&&pre.childNodes.length>100){var fragment=document.createDocumentFragment();var chunk=10,n=pre.childNodes.length;for(var i=0,chunks=Math.ceil(n/chunk);i<chunks;++i){var wrap=elt("div",null,null,"display: inline-block");for(var j=0;j<chunk&&n;++j){wrap.appendChild(pre.firstChild);--n}fragment.appendChild(wrap)}pre.appendChild(fragment)}removeChildrenAndAdd(display.measure,pre);var outer=getRect(display.lineDiv);var vranges=[],data=emptyArray(line.text.length),maxBot=pre.offsetHeight;if(ie_lt9&&display.measure.first!=pre)removeChildrenAndAdd(display.measure,pre);for(var i=0,cur;i<measure.length;++i)if(cur=measure[i]){var size=getRect(cur);var top=Math.max(0,size.top-outer.top),bot=Math.min(size.bottom-outer.top,maxBot);for(var j=0;j<vranges.length;j+=2){var rtop=vranges[j],rbot=vranges[j+1];if(rtop>bot||rbot<top)continue;if(rtop<=top&&rbot>=bot||top<=rtop&&bot>=rbot||Math.min(bot,rbot)-Math.max(top,rtop)>=bot-top>>1){vranges[j]=Math.min(top,rtop);vranges[j+1]=Math.max(bot,rbot);break}}if(j==vranges.length)vranges.push(top,bot);var right=size.right;if(cur.measureRight)right=getRect(cur.measureRight).left;data[i]={left:size.left-outer.left,right:right-outer.left,top:j}}for(var i=0,cur;i<data.length;++i)if(cur=data[i]){var vr=cur.top;cur.top=vranges[vr];cur.bottom=vranges[vr+1]}return data}function measureLineWidth(cm,line){var hasBadSpan=false;if(line.markedSpans)for(var i=0;i<line.markedSpans;++i){var sp=line.markedSpans[i];if(sp.collapsed&&(sp.to==null||sp.to==line.text.length))hasBadSpan=true}var cached=!hasBadSpan&&findCachedMeasurement(cm,line);if(cached)return measureChar(cm,line,line.text.length,cached).right;var pre=lineContent(cm,line);var end=pre.appendChild(zeroWidthElement(cm.display.measure));removeChildrenAndAdd(cm.display.measure,pre);return getRect(end).right-getRect(cm.display.lineDiv).left}function clearCaches(cm){cm.display.measureLineCache.length=cm.display.measureLineCachePos=0;cm.display.cachedCharWidth=cm.display.cachedTextHeight=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size}if(context=="line")return rect;if(!context)context="local";var yOff=heightAtLine(cm,lineObj);if(context!="local")yOff-=cm.display.viewOffset;if(context=="page"){var lOff=getRect(cm.display.lineSpace);yOff+=lOff.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop);var xOff=lOff.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft);rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context=="div")return coords;var left=coords.left,top=coords.top;if(context=="page"){left-=window.pageXOffset||(document.documentElement||document.body).scrollLeft;top-=window.pageYOffset||(document.documentElement||document.body).scrollTop}var lineSpaceBox=getRect(cm.display.lineSpace);left-=lineSpaceBox.left;top-=lineSpaceBox.top;if(context=="local"||!context){var editorBox=getRect(cm.display.wrapper);left+=editorBox.left;top+=editorBox.top}return{left:left,top:top}}function charCoords(cm,pos,context,lineObj){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch),context)}function cursorCoords(cm,pos,context,lineObj,measurement){lineObj=lineObj||getLine(cm.doc,pos.line);if(!measurement)measurement=measureLine(cm,lineObj);function get(ch,right){var m=measureChar(cm,lineObj,ch,measurement);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context)}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var main,other,linedir=order[0].level;for(var i=0;i<order.length;++i){var part=order[i],rtl=part.level%2,nb,here;if(part.from<ch&&part.to>ch)return get(ch,rtl);var left=rtl?part.to:part.from,right=rtl?part.from:part.to;if(left==ch){if(i&&part.level<(nb=order[i-1]).level)here=get(nb.level%2?nb.from:nb.to-1,true);else here=get(rtl&&part.from!=part.to?ch-1:ch);if(rtl==linedir)main=here;else other=here}else if(right==ch){var nb=i<order.length-1&&order[i+1];if(!rtl&&nb&&nb.from==nb.to)continue;if(nb&&part.level<nb.level)here=get(nb.level%2?nb.to-1:nb.from);else here=get(rtl?ch:ch-1,true);if(rtl==linedir)main=here;else other=here}}if(linedir&&!ch)other=get(order[0].to-1);if(!main)return other;if(other)main.other=other;return main}function PosMaybeOutside(line,ch,outside){var pos=new Pos(line,ch);if(outside)pos.outside=true;return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosMaybeOutside(doc.first,0,true);var lineNo=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineNo>last)return PosMaybeOutside(doc.first+doc.size-1,getLine(doc,last).text.length,true);if(x<0)x=0;for(;;){var lineObj=getLine(doc,lineNo);var found=coordsCharInner(cm,lineObj,lineNo,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find();if(merged&&found.ch>=mergedPos.from.ch)lineNo=mergedPos.to.line;else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(cm,lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var measurement=measureLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,measurement);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosMaybeOutside(lineNo,to,toOutside);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var after=x-fromX<toX-x,ch=after?from:to;while(isExtendingChar.test(lineObj.text.charAt(ch)))++ch;var pos=PosMaybeOutside(lineNo,ch,after?fromOutside:toOutside);pos.after=after;return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1e3;dist=step}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt("pre");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode("x"));measureText.appendChild(elt("br"))}measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt("span","x");var pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var width=anchor.offsetWidth;if(width>2)display.cachedCharWidth=width;return width||10}var nextOpId=0;function startOperation(cm){cm.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:false,cursorActivity:false,updateMaxLine:false,updateScrollPos:false,id:++nextOpId};if(!delayedCallbackDepth++)delayedCallbacks=[]}function endOperation(cm){var op=cm.curOp,doc=cm.doc,display=cm.display;cm.curOp=null;if(op.updateMaxLine)computeMaxLength(cm);if(display.maxLineChanged&&!cm.options.lineWrapping&&display.maxLine){var width=measureLineWidth(cm,display.maxLine);display.sizer.style.minWidth=Math.max(0,width+3+scrollerCutOff)+"px";display.maxLineChanged=false;var maxScrollLeft=Math.max(0,display.sizer.offsetLeft+display.sizer.offsetWidth-display.scroller.clientWidth);if(maxScrollLeft<doc.scrollLeft&&!op.updateScrollPos)setScrollLeft(cm,Math.min(display.scroller.scrollLeft,maxScrollLeft),true)}var newScrollPos,updated;if(op.updateScrollPos){newScrollPos=op.updateScrollPos}else if(op.selectionChanged&&display.scroller.clientHeight){var coords=cursorCoords(cm,doc.sel.head);newScrollPos=calculateScrollPos(cm,coords.left,coords.top,coords.left,coords.bottom)}if(op.changes.length||newScrollPos&&newScrollPos.scrollTop!=null){updated=updateDisplay(cm,op.changes,newScrollPos&&newScrollPos.scrollTop);if(cm.display.scroller.offsetHeight)cm.doc.scrollTop=cm.display.scroller.scrollTop}if(!updated&&op.selectionChanged)updateSelection(cm);if(op.updateScrollPos){display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=newScrollPos.scrollTop;display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=newScrollPos.scrollLeft;alignHorizontally(cm);if(op.scrollToPos)scrollPosIntoView(cm,clipPos(cm.doc,op.scrollToPos),op.scrollToPosMargin)}else if(newScrollPos){scrollCursorIntoView(cm)}if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)resetInput(cm,op.userSelChange);var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)if(!hidden[i].lines.length)signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)if(unhidden[i].lines.length)signal(unhidden[i],"unhide");var delayed;if(!--delayedCallbackDepth){delayed=delayedCallbacks;delayedCallbacks=null}if(op.textChanged)signal(cm,"change",cm,op.textChanged);if(op.cursorActivity)signal(cm,"cursorActivity",cm);if(delayed)for(var i=0;i<delayed.length;++i)delayed[i]()}function operation(cm1,f){return function(){var cm=cm1||this,withOp=!cm.curOp;if(withOp)startOperation(cm);try{var result=f.apply(cm,arguments)}finally{if(withOp)endOperation(cm)}return result}}function docOperation(f){return function(){var withOp=this.cm&&!this.cm.curOp,result;if(withOp)startOperation(this.cm);try{result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}function runInOp(cm,f){var withOp=!cm.curOp,result;if(withOp)startOperation(cm);try{result=f()}finally{if(withOp)endOperation(cm)}return result}function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;cm.curOp.changes.push({from:from,to:to,diff:lendiff})}function slowPoll(cm){if(cm.display.pollingFast)return;cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm);if(cm.state.focused)slowPoll(cm)})}function fastPoll(cm){var missed=false;cm.display.pollingFast=true;function p(){var changed=readInput(cm);if(!changed&&!missed){missed=true;cm.display.poll.set(60,p)}else{cm.display.pollingFast=false;slowPoll(cm)}}cm.display.poll.set(20,p)}function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc,sel=doc.sel;if(!cm.state.focused||hasSelection(input)||isReadOnly(cm))return false;var text=input.value;if(text==prevInput&&posEq(sel.from,sel.to))return false;if(ie&&!ie_lt9&&cm.display.inputHasSelection===text){resetInput(cm,true);return false}var withOp=!cm.curOp;if(withOp)startOperation(cm);sel.shift=false;var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same))++same;var from=sel.from,to=sel.to;if(same<prevInput.length)from=Pos(from.line,from.ch-(prevInput.length-same));else if(cm.state.overwrite&&posEq(from,to)&&!cm.state.pasteIncoming)to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+(text.length-same)));var updateInput=cm.curOp.updateInput;makeChange(cm.doc,{from:from,to:to,text:splitLines(text.slice(same)),origin:cm.state.pasteIncoming?"paste":"+input"},"end");cm.curOp.updateInput=updateInput;if(text.length>1e3||text.indexOf("\n")>-1)input.value=cm.display.prevInput="";else cm.display.prevInput=text;if(withOp)endOperation(cm);cm.state.pasteIncoming=false;return true}function resetInput(cm,user){var minimal,selected,doc=cm.doc;if(!posEq(doc.sel.from,doc.sel.to)){cm.display.prevInput="";minimal=hasCopyEvent&&(doc.sel.to.line-doc.sel.from.line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?"-":selected||cm.getSelection();cm.display.input.value=content;if(cm.state.focused)selectInput(cm.display.input);if(ie&&!ie_lt9)cm.display.inputHasSelection=content}else if(user){cm.display.prevInput=cm.display.input.value="";if(ie&&!ie_lt9)cm.display.inputHasSelection=null}cm.display.inaccurateSelection=minimal}function focusInput(cm){if(cm.options.readOnly!="nocursor"&&(!mobile||document.activeElement!=cm.display.input))cm.display.input.focus()}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown));if(ie)on(d.scroller,"dblclick",operation(cm,function(e){var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=findWordAt(getLine(cm.doc,pos.line).text,pos);extendSelection(cm.doc,word.from,word.to)}));else on(d.scroller,"dblclick",e_preventDefault);on(d.lineSpace,"selectstart",function(e){if(!eventInWidget(d,e))e_preventDefault(e)});if(!captureMiddleClick)on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)});on(d.scroller,"scroll",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,"scroll",cm)}});on(d.scrollbarV,"scroll",function(){if(d.scroller.clientHeight)setScrollTop(cm,d.scrollbarV.scrollTop)});on(d.scrollbarH,"scroll",function(){if(d.scroller.clientHeight)setScrollLeft(cm,d.scrollbarH.scrollLeft)});on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)});on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)});function reFocus(){if(cm.state.focused)setTimeout(bind(focusInput,cm),0)}on(d.scrollbarH,"mousedown",reFocus);on(d.scrollbarV,"mousedown",reFocus);on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});function onResize(){d.cachedCharWidth=d.cachedTextHeight=null;clearCaches(cm);runInOp(cm,bind(regChange,cm))}on(window,"resize",onResize);function unregister(){for(var p=d.wrapper.parentNode;p&&p!=document.body;p=p.parentNode){}if(p)setTimeout(unregister,5e3);else off(window,"resize",onResize)}setTimeout(unregister,5e3);on(d.input,"keyup",operation(cm,function(e){if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;if(e.keyCode==16)cm.doc.sel.shift=false}));on(d.input,"input",bind(fastPoll,cm));on(d.input,"keydown",operation(cm,onKeyDown));on(d.input,"keypress",operation(cm,onKeyPress));on(d.input,"focus",bind(onFocus,cm));on(d.input,"blur",bind(onBlur,cm));function drag_(e){if(cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_stop(e)}if(cm.options.dragDrop){on(d.scroller,"dragstart",function(e){onDragStart(cm,e)});on(d.scroller,"dragenter",drag_);on(d.scroller,"dragover",drag_);on(d.scroller,"drop",operation(cm,onDrop))}on(d.scroller,"paste",function(e){if(eventInWidget(d,e))return;focusInput(cm);fastPoll(cm)});on(d.input,"paste",function(){cm.state.pasteIncoming=true;fastPoll(cm)});function prepareCopy(){if(d.inaccurateSelection){d.prevInput="";d.inaccurateSelection=false;d.input.value=cm.getSelection();selectInput(d.input)}}on(d.input,"cut",prepareCopy);on(d.input,"copy",prepareCopy);if(khtml)on(d.sizer,"mouseup",function(){if(document.activeElement==d.input)d.input.blur();focusInput(cm)})}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n)return true;if(/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==display.sizer&&n!=display.mover)return true}}function posFromMouse(cm,e,liberal){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarH.firstChild||target==display.scrollbarV||target==display.scrollbarV.firstChild||target==display.scrollbarFiller)return null}var x,y,space=getRect(display.lineSpace);try{x=e.clientX;y=e.clientY}catch(e){return null}return coordsChar(cm,x-space.left,y-space.top)}var lastClick,lastDoubleClick;function onMouseDown(e){var cm=this,display=cm.display,doc=cm.doc,sel=doc.sel;sel.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true},100)}return}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);switch(e_button(e)){case 3:if(captureMiddleClick)onContextMenu.call(cm,cm,e);return;case 2:if(start)extendSelection(cm.doc,start);setTimeout(bind(focusInput,cm),20);e_preventDefault(e);return}if(!start){if(e_target(e)==display.scroller)e_preventDefault(e);return}if(!cm.state.focused)onFocus(cm);var now=+new Date,type="single";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start)){type="triple";e_preventDefault(e);setTimeout(bind(focusInput,cm),20);selectLine(cm,start.line)}else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type="double";lastDoubleClick={time:now,pos:start};e_preventDefault(e);var word=findWordAt(getLine(doc,start.line).text,start);extendSelection(cm.doc,word.from,word.to)}else{lastClick={time:now,pos:start}}var last=start;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&type=="single"){var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,"mouseup",dragEnd);off(display.scroller,"drop",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);extendSelection(cm.doc,start);focusInput(cm)}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,"mouseup",dragEnd);on(display.scroller,"drop",dragEnd);return}e_preventDefault(e);if(type=="single")extendSelection(cm.doc,clipPos(doc,start));var startstart=sel.from,startend=sel.to,lastPos=start;function doSelect(cur){if(posEq(lastPos,cur))return;lastPos=cur;if(type=="single"){extendSelection(cm.doc,clipPos(doc,start),cur);return}startstart=clipPos(doc,startstart);startend=clipPos(doc,startend);if(type=="double"){var word=findWordAt(getLine(doc,cur.line).text,cur);if(posLess(cur,startstart))extendSelection(cm.doc,word.from,startend);else extendSelection(cm.doc,startstart,word.to)}else if(type=="triple"){if(posLess(cur,startstart))extendSelection(cm.doc,startend,clipPos(doc,Pos(cur.line,0)));else extendSelection(cm.doc,startstart,clipPos(doc,Pos(cur.line+1,0)))}}var editorSize=getRect(display.wrapper);var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true);if(!cur)return;if(!posEq(cur,last)){if(!cm.state.focused)onFocus(cm);last=cur;doSelect(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e)}),50)}}function done(e){counter=Infinity;var cur=posFromMouse(cm,e);if(cur)doSelect(cur);e_preventDefault(e);focusInput(cm);off(document,"mousemove",move);off(document,"mouseup",up)}var move=operation(cm,function(e){if(!ie&&!e_button(e))done(e);else extend(e)});var up=operation(cm,done);on(document,"mousemove",move);on(document,"mouseup",up)}function onDrop(e){var cm=this;if(eventInWidget(cm.display,e)||cm.options.onDragEvent&&cm.options.onDragEvent(cm,addStop(e)))return;e_preventDefault(e);var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||isReadOnly(cm))return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result;if(++read==n){pos=clipPos(cm.doc,pos);makeChange(cm.doc,{from:pos,to:pos,text:splitLines(text.join("\n")),origin:"paste"},"around")}};reader.readAsText(file)};for(var i=0;i<n;++i)loadFile(files[i],i)}else{if(cm.state.draggingText&&!(posLess(pos,cm.doc.sel.from)||posLess(cm.doc.sel.to,pos))){cm.state.draggingText(e);setTimeout(bind(focusInput,cm),20);return}try{var text=e.dataTransfer.getData("Text");if(text){var curFrom=cm.doc.sel.from,curTo=cm.doc.sel.to;setSelection(cm.doc,pos,pos);if(cm.state.draggingText)replaceRange(cm.doc,"",curFrom,curTo,"paste");cm.replaceSelection(text,null,"paste");focusInput(cm);onFocus(cm)}}catch(e){}}}function clickInGutter(cm,e){var display=cm.display;try{var mX=e.clientX,mY=e.clientY}catch(e){return false}if(mX>=Math.floor(getRect(display.gutters).right))return false;e_preventDefault(e);if(!hasHandler(cm,"gutterClick"))return true;var lineBox=getRect(display.lineDiv);if(mY>lineBox.bottom)return true;mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&getRect(g).right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signalLater(cm,"gutterClick",cm,line,gutter,e);break}}return true}function onDragStart(cm,e){if(ie&&!cm.state.draggingText){e_stop(e);return}if(eventInWidget(cm.display,e))return;var txt=cm.getSelection();e.dataTransfer.setData("Text",txt);if(e.dataTransfer.setDragImage){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");if(opera){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}if(safari){if(cm.display.dragImg){img=cm.display.dragImg}else{cm.display.dragImg=img;img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";cm.display.wrapper.appendChild(img)}}e.dataTransfer.setDragImage(img,0,0);if(opera)img.parentNode.removeChild(img)}}function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplay(cm,[],val);if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;if(cm.display.scrollbarV.scrollTop!=val)cm.display.scrollbarV.scrollTop=val;if(gecko)updateDisplay(cm,[])}function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;if(cm.display.scrollbarH.scrollLeft!=val)cm.display.scrollbarH.scrollLeft=val}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;var display=cm.display,scroll=display.scroller;if(!(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight))return;if(dy&&mac&&webkit){for(var cur=e.target;cur!=scroll;cur=cur.parentNode){if(cur.lineObj){cm.display.currentWheelTarget=cur;break}}}if(dx&&!gecko&&!opera&&wheelPixelsPerUnit!=null){if(dy)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));e_preventDefault(e);display.wheelStartX=null;return}if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplay(cm,[],{top:top,bottom:bot})}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples},200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}function doHandleBinding(cm,bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound)return false}if(cm.display.pollingFast&&readInput(cm))cm.display.pollingFast=false;var doc=cm.doc,prevShift=doc.sel.shift,done=false;try{if(isReadOnly(cm))cm.state.suppressEdits=true;if(dropShift)doc.sel.shift=false;done=bound(cm)!=Pass}finally{doc.sel.shift=prevShift;cm.state.suppressEdits=false}return done}function allKeyMaps(cm){var maps=cm.state.keyMaps.slice(0);if(cm.options.extraKeys)maps.push(cm.options.extraKeys);maps.push(cm.options.keyMap);return maps}var maybeTransition;function handleKeyBinding(cm,e){var startMap=getKeyMap(cm.options.keyMap),next=startMap.auto;clearTimeout(maybeTransition);if(next&&!isModifierKey(e))maybeTransition=setTimeout(function(){if(getKeyMap(cm.options.keyMap)==startMap)cm.options.keyMap=next.call?next.call(null,cm):next},50);var name=keyName(e,true),handled=false;if(!name)return false;var keymaps=allKeyMaps(cm);if(e.shiftKey){handled=lookupKey("Shift-"+name,keymaps,function(b){return doHandleBinding(cm,b,true)})||lookupKey(name,keymaps,function(b){if(typeof b=="string"&&/^go[A-Z]/.test(b))return doHandleBinding(cm,b)})}else{handled=lookupKey(name,keymaps,function(b){return doHandleBinding(cm,b)})}if(handled=="stop")handled=false;if(handled){e_preventDefault(e);restartBlink(cm);if(ie_lt9){e.oldKeyCode=e.keyCode;e.keyCode=0}}return handled}function handleCharBinding(cm,e,ch){var handled=lookupKey("'"+ch+"'",allKeyMaps(cm),function(b){return doHandleBinding(cm,b,true)});if(handled){e_preventDefault(e);restartBlink(cm)}return handled}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(!cm.state.focused)onFocus(cm);if(ie&&e.keyCode==27){e.returnValue=false}if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var code=e.keyCode;cm.doc.sel.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(opera){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection("")}}function onKeyPress(e){var cm=this;if(cm.options.onKeyEvent&&cm.options.onKeyEvent(cm,addStop(e)))return;var keyCode=e.keyCode,charCode=e.charCode;if(opera&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if((opera&&(!e.which||e.which<10)||khtml)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!isReadOnly(this)&&this.doc.mode.electricChars.indexOf(ch)>-1)setTimeout(operation(cm,function(){indentLine(cm,cm.doc.sel.to.line,"smart")}),75);if(handleCharBinding(cm,e,ch))return;if(ie&&!ie_lt9)cm.display.inputHasSelection=null;fastPoll(cm)}function onFocus(cm){if(cm.options.readOnly=="nocursor")return;if(!cm.state.focused){signal(cm,"focus",cm);cm.state.focused=true;if(cm.display.wrapper.className.search(/\bCodeMirror-focused\b/)==-1)cm.display.wrapper.className+=" CodeMirror-focused";resetInput(cm,true)}slowPoll(cm);restartBlink(cm)}function onBlur(cm){if(cm.state.focused){signal(cm,"blur",cm);cm.state.focused=false;cm.display.wrapper.className=cm.display.wrapper.className.replace(" CodeMirror-focused","")}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.doc.sel.shift=false},150)}var detectingSelectAll;function onContextMenu(cm,e){var display=cm.display,sel=cm.doc.sel;if(eventInWidget(display,e))return;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||opera)return;if(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))operation(cm,setSelection)(cm.doc,pos,pos);var oldCSS=display.input.style.cssText;display.inputDiv.style.position="absolute";display.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);";focusInput(cm);resetInput(cm,true);if(posEq(sel.from,sel.to))display.input.value=display.prevInput=" ";function rehide(){display.inputDiv.style.position="relative";display.input.style.cssText=oldCSS;if(ie_lt9)display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos;slowPoll(cm);if(display.input.selectionStart!=null&&(!ie||ie_lt9)){clearTimeout(detectingSelectAll);var extval=display.input.value=" "+(posEq(sel.from,sel.to)?"":display.input.value),i=0;display.prevInput=" ";display.input.selectionStart=1;display.input.selectionEnd=extval.length;var poll=function(){if(display.prevInput==" "&&display.input.selectionStart==0)operation(cm,commands.selectAll)(cm);else if(i++<10)detectingSelectAll=setTimeout(poll,500);else resetInput(cm)};detectingSelectAll=setTimeout(poll,200)}}if(captureMiddleClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup);setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else{setTimeout(rehide,50)}}function changeEnd(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))}function clipPostChange(doc,change,pos){if(!posLess(change.from,pos))return clipPos(doc,pos);var diff=change.text.length-1-(change.to.line-change.from.line);if(pos.line>change.to.line+diff){var preLine=pos.line-diff,lastLine=doc.first+doc.size-1;if(preLine>lastLine)return Pos(lastLine,getLine(doc,lastLine).text.length);return clipToLen(pos,getLine(doc,preLine).text.length)}if(pos.line==change.to.line+diff)return clipToLen(pos,lst(change.text).length+(change.text.length==1?change.from.ch:0)+getLine(doc,change.to.line).text.length-change.to.ch);var inside=pos.line-change.from.line;return clipToLen(pos,change.text[inside].length+(inside?0:change.from.ch))}function computeSelAfterChange(doc,change,hint){if(hint&&typeof hint=="object")return{anchor:clipPostChange(doc,change,hint.anchor),head:clipPostChange(doc,change,hint.head)};if(hint=="start")return{anchor:change.from,head:change.from};var end=changeEnd(change);if(hint=="around")return{anchor:change.from,head:end};if(hint=="end")return{anchor:end,head:end};var adjustPos=function(pos){if(posLess(pos,change.from))return pos;if(!posLess(change.to,pos))return end;var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=end.ch-change.to.ch;return Pos(line,ch)};return{anchor:adjustPos(doc.sel.anchor),head:adjustPos(doc.sel.head)}}function filterChange(doc,change){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,update:function(from,to,text,origin){if(from)this.from=clipPos(doc,from);if(to)this.to=clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin},cancel:function(){this.canceled=true}};signal(doc,"beforeChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeChange",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,selUpdate,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,selUpdate,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange")){change=filterChange(doc,change);if(!change)return}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=1;--i)makeChangeNoReadonly(doc,{from:split[i].from,to:split[i].to,text:[""]});if(split.length)makeChangeNoReadonly(doc,{from:split[0].from,to:split[0].to,text:change.text},selUpdate)}else{makeChangeNoReadonly(doc,change,selUpdate)}}function makeChangeNoReadonly(doc,change,selUpdate){var selAfter=computeSelAfterChange(doc,change,selUpdate);addToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}function makeChangeFromHistory(doc,type){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history;var event=(type=="undo"?hist.done:hist.undone).pop();if(!event)return;hist.dirtyCounter+=type=="undo"?-1:1;var anti={changes:[],anchorBefore:event.anchorAfter,headBefore:event.headAfter,anchorAfter:event.anchorBefore,headAfter:event.headBefore};(type=="undo"?hist.undone:hist.done).push(anti);for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;anti.changes.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change,null):{anchor:event.anchorBefore,head:event.headBefore};makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}function shiftDoc(doc,distance){function shiftPos(pos){return Pos(pos.line+distance,pos.ch)}doc.first+=distance;if(doc.cm)regChange(doc.cm,doc.first,doc.first,distance);doc.sel.head=shiftPos(doc.sel.head);doc.sel.anchor=shiftPos(doc.sel.anchor);doc.sel.from=shiftPos(doc.sel.from);doc.sel.to=shiftPos(doc.sel.to)}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change,null);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans,selAfter);else updateDoc(doc,change,spans,selAfter)}function makeChangeSingleDocInEditor(cm,change,spans,selAfter){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(doc,getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}})}if(!posLess(doc.sel.head,change.from)&&!posLess(change.to,doc.sel.head))cm.curOp.cursorActivity=true;updateDoc(doc,change,spans,selAfter,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(doc,line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true}doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;regChange(cm,from.line,to.line+1,lendiff);if(hasHandler(cm,"change")){var changeObj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(cm.curOp.textChanged){for(var cur=cm.curOp.textChanged;cur.next;cur=cur.next){}cur.next=changeObj}else cm.curOp.textChanged=changeObj}}function replaceRange(doc,code,from,to,origin){if(!to)to=from;if(posLess(to,from)){var tmp=to;to=from;from=tmp}if(typeof code=="string")code=splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin},null)}function Pos(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch}CodeMirror.Pos=Pos;function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function copyPos(x){return Pos(x.line,x.ch)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function extendSelection(doc,pos,other,bias){if(doc.sel.shift||doc.sel.extend){var anchor=doc.sel.anchor;if(other){var posBefore=posLess(pos,anchor);if(posBefore!=posLess(other,anchor)){anchor=pos;pos=other}else if(posBefore!=posLess(pos,other)){pos=other}}setSelection(doc,anchor,pos,bias)}else{setSelection(doc,pos,other||pos,bias)}if(doc.cm)doc.cm.curOp.userSelChange=true}function filterSelectionChange(doc,anchor,head){var obj={anchor:anchor,head:head};signal(doc,"beforeSelectionChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeSelectionChange",doc.cm,obj);obj.anchor=clipPos(doc,obj.anchor);obj.head=clipPos(doc,obj.head);return obj}function setSelection(doc,anchor,head,bias,checkAtomic){if(!checkAtomic&&hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange")){var filtered=filterSelectionChange(doc,anchor,head);head=filtered.head;anchor=filtered.anchor}var sel=doc.sel;sel.goalColumn=null;if(checkAtomic||!posEq(anchor,sel.anchor))anchor=skipAtomic(doc,anchor,bias,checkAtomic!="push");if(checkAtomic||!posEq(head,sel.head))head=skipAtomic(doc,head,bias,checkAtomic!="push");if(posEq(sel.anchor,anchor)&&posEq(sel.head,head))return;sel.anchor=anchor;sel.head=head;var inv=posLess(head,anchor);sel.from=inv?head:anchor;sel.to=inv?anchor:head;if(doc.cm)doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=doc.cm.curOp.cursorActivity=true;signalLater(doc,"cursorActivity",doc)}function reCheckSelection(cm){setSelection(cm.doc,cm.doc.sel.from,cm.doc.sel.to,null,"push")}function skipAtomic(doc,pos,bias,mayClear){var flipped=false,curPos=pos;var dir=bias||1;doc.cantEdit=false;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear){signal(m,"beforeCursorEnter");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue}}}if(!m.atomic)continue;var newPos=m.find()[dir<0?"from":"to"];if(posEq(newPos,curPos)){newPos.ch+=dir;if(newPos.ch<0){if(newPos.line>doc.first)newPos=clipPos(doc,Pos(newPos.line-1));else newPos=null}else if(newPos.ch>line.text.length){if(newPos.line<doc.first+doc.size-1)newPos=Pos(newPos.line+1,0);else newPos=null}if(!newPos){if(flipped){if(!mayClear)return skipAtomic(doc,pos,bias,true);doc.cantEdit=true;return Pos(doc.first,0)}flipped=true;newPos=pos;dir=-dir}}curPos=newPos;continue search}}}return curPos}}function scrollCursorIntoView(cm){var coords=scrollPosIntoView(cm,cm.doc.sel.head);if(!cm.state.focused)return;var display=cm.display,box=getRect(display.sizer),doScroll=null,pTop=paddingTop(cm.display);if(coords.top+pTop+box.top<0)doScroll=true;else if(coords.bottom+pTop+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var hidden=display.cursor.style.display=="none";if(hidden){display.cursor.style.display="";display.cursor.style.left=coords.left+"px";display.cursor.style.top=coords.top-display.viewOffset+"px"}display.cursor.scrollIntoView(doScroll);if(hidden)display.cursor.style.display="none"}}function scrollPosIntoView(cm,pos,margin){if(margin==null)margin=0;for(;;){var changed=false,coords=cursorCoords(cm,pos);var scrollPos=calculateScrollPos(cm,coords.left,coords.top-margin,coords.left,coords.bottom+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true}if(!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,pt=paddingTop(display);y1+=pt;y2+=pt;if(y1<0)y1=0;var screen=display.scroller.clientHeight-scrollerCutOff,screentop=display.scroller.scrollTop,result={};var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<pt+10,atBottom=y2+pt>docBottom-10;if(y1<screentop){result.scrollTop=atTop?0:y1}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop}var screenw=display.scroller.clientWidth-scrollerCutOff,screenleft=display.scroller.scrollLeft;x1+=display.gutters.offsetWidth;x2+=display.gutters.offsetWidth;var gutterw=display.gutters.offsetWidth;var atLeft=x1<gutterw+10;if(x1<screenleft+gutterw||atLeft){if(atLeft)x1=0;result.scrollLeft=Math.max(0,x1-10-gutterw)}else if(x2>screenw+screenleft-3){result.scrollLeft=x2+10-screenw}return result}function updateScrollPos(cm,left,top){cm.curOp.updateScrollPos={scrollLeft:left==null?cm.doc.scrollLeft:left,scrollTop:top==null?cm.doc.scrollTop:top}}function addToScrollPos(cm,left,top){var pos=cm.curOp.updateScrollPos||(cm.curOp.updateScrollPos={scrollLeft:cm.doc.scrollLeft,scrollTop:cm.doc.scrollTop});var scroll=cm.display.scroller;pos.scrollTop=Math.max(0,Math.min(scroll.scrollHeight-scroll.clientHeight,pos.scrollTop+top));pos.scrollLeft=Math.max(0,Math.min(scroll.scrollWidth-scroll.clientWidth,pos.scrollLeft+left))}function indentLine(cm,n,how,aggressive){var doc=cm.doc;if(!how)how="add";if(how=="smart"){if(!cm.doc.mode.indent)how="prev";else var state=getStateBefore(cm,n)}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);var curSpaceString=line.text.match(/^\s*/)[0],indentation;if(how=="smart"){indentation=cm.doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass){if(!aggressive)return;how="prev"}}if(how=="prev"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0}else if(how=="add"){indentation=curSpace+cm.options.indentUnit}else if(how=="subtract"){indentation=curSpace-cm.options.indentUnit}indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+="	"}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString)replaceRange(cm.doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input");line.stateAfter=null}function changeLine(cm,handle,op){var no=handle,line=handle,doc=cm.doc;if(typeof handle=="number")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no))regChange(cm,no,no+1);else return null;return line}function findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch;var lineObj=getLine(doc,line);var possible=true;function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return possible=false;line=l;return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0}else return possible=false}else ch=next;return true}if(unit=="char")moveOnce();else if(unit=="column")moveOnce(true);else if(unit=="word"||unit=="group"){var sawType=null,group=unit=="group";for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||"\n";var type=isWordChar(cur)?"w":!group?null:/\s/.test(cur)?null:"p";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce()}break}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break}}var result=skipAtomic(doc,Pos(line,ch),dir,true);if(!possible)result.hitSide=true;return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit=="page"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display))}else if(unit=="line"){y=dir>0?pos.bottom+3:pos.top-3}for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}function findWordAt(line,pos){var start=pos.ch,end=pos.ch;if(line){if(pos.after===false||end==line.length)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar)?isWordChar:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end}return{from:Pos(pos.line,start),to:Pos(pos.line,end)}}function selectLine(cm,line){extendSelection(cm.doc,Pos(line,0),clipPos(cm.doc,Pos(line+1,0)))}CodeMirror.prototype={focus:function(){window.focus();focusInput(this);onFocus(this);fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!="mode")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](map)},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i)if((typeof map=="string"?maps[i].name:maps[i])==map){maps.splice(i,1);return true}},addOverlay:operation(null,function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this)}),removeOverlay:operation(null,function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){if(overlays[i].modeSpec==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}}),indentLine:operation(null,function(n,dir,aggressive){if(typeof dir!="string"){if(dir==null)dir=this.options.smartIndent?"smart":"prev";else dir=dir?"add":"subtract"}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive)}),indentSelection:operation(null,function(how){var sel=this.doc.sel;if(posEq(sel.from,sel.to))return indentLine(this,sel.from.line,how);var e=sel.to.line-(sel.to.ch?0:1);for(var i=sel.from.line;i<=e;++i)indentLine(this,i,how)}),getTokenAt:function(pos){var doc=this.doc;pos=clipPos(doc,pos);var state=getStateBefore(this,pos.line),mode=this.doc.mode;var line=getLine(doc,pos.line);var stream=new StringStream(line.text,this.options.tabSize);while(stream.pos<pos.ch&&!stream.eol()){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,type:style||null,state:state}},getStateAfter:function(line){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1)},cursorCoords:function(start,mode){var pos,sel=this.doc.sel;if(start==null)pos=sel.head;else if(typeof start=="object")pos=clipPos(this.doc,start);else pos=start?sel.from:sel.to;return cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||"page");return coordsChar(this,coords.left,coords.top)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:operation(null,function(line,gutterID,value){return changeLine(this,line,function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true})}),clearGutter:operation(null,function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regChange(cm,i,i+1);if(isEmpty(line.gutterMarkers))line.gutterMarkers=null}++i})}),addLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":"wrapClass";if(!line[prop])line[prop]=cls;else if(new RegExp("\\b"+cls+"\\b").test(line[prop]))return false;else line[prop]+=" "+cls;return true})}),removeLineClass:operation(null,function(handle,where,cls){return changeLine(this,handle,function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":"wrapClass";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var upd=cur.replace(new RegExp("^"+cls+"\\b\\s*|\\s*\\b"+cls+"\\b"),"");if(upd==cur)return false;line[prop]=upd||null}return true})}),addLineWidget:operation(null,function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if(typeof line=="number"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null}else{var n=lineNo(line);if(n==null)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position="absolute";display.sizer.appendChild(node);if(vert=="over"){top=pos.top}else if(vert=="above"||vert=="near"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert=="above"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth}node.style.top=top+paddingTop(display)+"px";node.style.left=node.style.right="";if(horiz=="right"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right="0px"}else{if(horiz=="left")left=0;else if(horiz=="middle")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+"px"}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:operation(null,onKeyDown),execCommand:function(cmd){return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break}return cur},moveH:operation(null,function(dir,unit){var sel=this.doc.sel,pos;if(sel.shift||sel.extend||posEq(sel.from,sel.to))pos=findPosH(this.doc,sel.head,dir,unit,this.options.rtlMoveVisually);else pos=dir<0?sel.from:sel.to;extendSelection(this.doc,pos,pos,dir)}),deleteH:operation(null,function(dir,unit){var sel=this.doc.sel;if(!posEq(sel.from,sel.to))replaceRange(this.doc,"",sel.from,sel.to,"+delete");else replaceRange(this.doc,"",sel.from,findPosH(this.doc,sel.head,dir,unit,false),"+delete");this.curOp.userSelChange=true}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){var coords=cursorCoords(this,cur,"div");if(x==null)x=coords.left;else coords.left=x;cur=findPosV(this,coords,dir,unit);if(cur.hitSide)break}return cur},moveV:operation(null,function(dir,unit){var sel=this.doc.sel;var pos=cursorCoords(this,sel.head,"div");if(sel.goalColumn!=null)pos.left=sel.goalColumn;var target=findPosV(this,pos,dir,unit);if(unit=="page")addToScrollPos(this,0,charCoords(this,target,"div").top-pos.top);extendSelection(this.doc,target,target,dir);sel.goalColumn=pos.left}),toggleOverwrite:function(){if(this.state.overwrite=!this.state.overwrite)this.display.cursor.className+=" CodeMirror-overwrite";else this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},hasFocus:function(){return this.state.focused},scrollTo:operation(null,function(x,y){updateScrollPos(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:operation(null,function(pos,margin){if(typeof pos=="number")pos=Pos(pos,0);if(!margin)margin=0;var coords=pos;if(!pos||pos.line!=null){this.curOp.scrollToPos=pos?clipPos(this.doc,pos):this.doc.sel.head;this.curOp.scrollToPosMargin=margin;coords=cursorCoords(this,this.curOp.scrollToPos)}var sPos=calculateScrollPos(this,coords.left,coords.top-margin,coords.right,coords.bottom+margin);updateScrollPos(this,sPos.scrollLeft,sPos.scrollTop)}),setSize:function(width,height){function interpret(val){return typeof val=="number"||/^\d+$/.test(String(val))?val+"px":val}if(width!=null)this.display.wrapper.style.width=interpret(width);if(height!=null)this.display.wrapper.style.height=interpret(height);this.refresh()},on:function(type,f){on(this,type,f)},off:function(type,f){off(this,type,f)},operation:function(f){return runInOp(this,f)},refresh:operation(null,function(){clearCaches(this);updateScrollPos(this,this.doc.scrollLeft,this.doc.scrollTop);regChange(this)}),swapDoc:operation(null,function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);resetInput(this,true);updateScrollPos(this,doc.scrollLeft,doc.scrollTop);return old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var optionHandlers=CodeMirror.optionHandlers={};var defaults=CodeMirror.defaults={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old)}:handle}var Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},true);option("mode",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm)},true);option("indentUnit",2,loadMode,true);option("indentWithTabs",false);option("smartIndent",true);option("tabSize",4,function(cm){loadMode(cm);clearCaches(cm);regChange(cm)},true);option("electricChars",true);option("rtlMoveVisually",!windows);option("theme","default",function(cm){themeChanged(cm);guttersChanged(cm)},true);option("keyMap","default",keyMapChanged);option("extraKeys",null);option("onKeyEvent",null);option("onDragEvent",null);option("lineWrapping",false,wrappingChanged,true);option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option("fixedGutter",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0";cm.refresh()},true);option("lineNumbers",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option("firstLineNumber",1,guttersChanged,true);option("lineNumberFormatter",function(integer){return integer},guttersChanged,true);option("showCursorWhenSelecting",false,updateSelection,true);option("readOnly",false,function(cm,val){if(val=="nocursor"){onBlur(cm);cm.display.input.blur()}else if(!val)resetInput(cm,true)});option("dragDrop",true);option("cursorBlinkRate",530);option("cursorHeight",1);option("workTime",100);option("workDelay",100);option("flattenSpans",true);option("pollInterval",100);option("undoDepth",40,function(cm,val){cm.doc.history.undoDepth=val});option("historyEventDelay",500);option("viewportMargin",10,function(cm){cm.refresh()},true);option("maxHighlightLength",1e4,function(cm){loadMode(cm);cm.refresh()},true);option("moveInputWithCursor",true,function(cm,val){if(!val)cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0});option("tabindex",null,function(cm,val){cm.display.input.tabIndex=val||""});option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!="null")CodeMirror.defaults.mode=name;if(arguments.length>2){mode.dependencies=[];for(var i=2;i<arguments.length;++i)mode.dependencies.push(arguments[i])}modes[name]=mode};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec};CodeMirror.resolveMode=function(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");if(typeof spec=="string")return{name:spec};else return spec||{name:"null"}};CodeMirror.getMode=function(options,spec){spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj["_"+prop]=modeObj[prop];modeObj[prop]=exts[prop]}}modeObj.name=spec.name;return modeObj};CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}});CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};function copyState(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val}return nstate}CodeMirror.copyState=copyState;function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true}CodeMirror.startState=startState;CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);state=info.state;mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()))},killLine:function(cm){var from=cm.getCursor(true),to=cm.getCursor(false),sel=!posEq(from,to);if(!sel&&cm.getLine(from.line).length==from.ch)cm.replaceRange("",from,Pos(from.line+1,0),"+delete");else cm.replaceRange("",from,sel?to:Pos(from.line),"+delete")},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange("",Pos(l,0),Pos(l),"+delete")},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelection(lineStart(cm,cm.getCursor().line))},goLineStartSmart:function(cm){var cur=cm.getCursor(),start=lineStart(cm,cur.line);var line=cm.getLineHandle(start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\S/));var inWS=cur.line==start.line&&cur.ch<=firstNonWS&&cur.ch;cm.extendSelection(Pos(start.line,inWS?0:firstNonWS))}else cm.extendSelection(start)},goLineEnd:function(cm){cm.extendSelection(lineEnd(cm,cm.getCursor().line))},goLineRight:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div"))},goLineLeft:function(cm){var top=cm.charCoords(cm.getCursor(),"div").top+5;cm.extendSelection(cm.coordsChar({left:0,top:top},"div"))},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	","end","+input")},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection("add");else cm.replaceSelection("	","end","+input")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);if(cur.ch>0&&cur.ch<line.length-1)cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1))},newlineAndIndent:function(cm){operation(cm,function(){cm.replaceSelection("\n","end","+input");cm.indentLine(cm.getCursor().line,null,true)})()},toggleOverwrite:function(cm){cm.toggleOverwrite()}};var keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"};keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};function getKeyMap(val){if(typeof val=="string")return keyMap[val];else return val}function lookupKey(name,maps,handle){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===false)return"stop";if(found!=null&&handle(found))return true;if(map.nofallthrough)return"stop";var fallthrough=map.fallthrough;if(fallthrough==null)return false;if(Object.prototype.toString.call(fallthrough)!="[object Array]")return lookup(fallthrough);for(var i=0,e=fallthrough.length;i<e;++i){var done=lookup(fallthrough[i]);if(done)return done}return false}for(var i=0;i<maps.length;++i){var done=lookup(maps[i]);if(done)return done}}function isModifierKey(event){var name=keyNames[event.keyCode];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod"}function keyName(event,noShift){if(opera&&event.keyCode==34&&event["char"])return false;var name=keyNames[event.keyCode];if(name==null||event.altGraphKey)return false;if(event.altKey)name="Alt-"+name;if(flipCtrlCmd?event.metaKey:event.ctrlKey)name="Ctrl-"+name;if(flipCtrlCmd?event.ctrlKey:event.metaKey)name="Cmd-"+name;if(!noShift&&event.shiftKey)name="Shift-"+name;return name}CodeMirror.lookupKey=lookupKey;CodeMirror.isModifierKey=isModifierKey;CodeMirror.keyName=keyName;CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)options.tabindex=textarea.tabindex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||textarea.getAttribute("autofocus")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}if(textarea.form){on(textarea.form,"submit",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit}}catch(e){}}}textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display="";if(textarea.form){off(textarea.form,"submit",save);if(typeof textarea.form.submit=="function")textarea.form.submit=realSubmit}};return cm};function StringStream(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0}StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match=="string")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start},eatSpace:function(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}},backUp:function(n){this.pos-=n},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match}},current:function(){return this.string.slice(this.start,this.pos)}};CodeMirror.StringStream=StringStream;function TextMarker(doc,type){this.lines=[];this.type=type;this.doc=doc}CodeMirror.TextMarker=TextMarker;TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.to!=null)max=lineNo(line);line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from!=null)min=lineNo(line);else if(this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(cm.doc,this.lines[i]),len=lineLength(cm.doc,visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}if(min!=null&&cm)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.collapsed&&this.doc.cantEdit){this.doc.cantEdit=false;if(cm)reCheckSelection(cm)}if(withOp)endOperation(cm);signalLater(this,"clear")};TextMarker.prototype.find=function(){var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null||span.to!=null){var found=lineNo(line);if(span.from!=null)from=Pos(found,span.from);if(span.to!=null)to=Pos(found,span.to)}}if(this.type=="bookmark")return from;return from&&{from:from,to:to}};TextMarker.prototype.getOptions=function(copyWidget){var repl=this.replacedWith;return{className:this.className,inclusiveLeft:this.inclusiveLeft,inclusiveRight:this.inclusiveRight,atomic:this.atomic,collapsed:this.collapsed,replacedWith:copyWidget?repl&&repl.cloneNode(true):repl,readOnly:this.readOnly,startStyle:this.startStyle,endStyle:this.endStyle}};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type);if(type=="range"&&!posLess(from,to))return marker;if(options)copyObj(options,marker);if(marker.replacedWith){marker.collapsed=true;marker.replacedWith=elt("span",[marker.replacedWith],"CodeMirror-widget")}if(marker.collapsed)sawCollapsedSpans=true;if(marker.addToHistory)addToHistory(doc,{from:from,to:to,origin:"markText"},{head:doc.sel.head,anchor:doc.sel.anchor},NaN);var curLine=from.line,size=0,collapsedAtStart,collapsedAtEnd,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(doc,line)==cm.display.maxLine)updateMaxLine=true;var span={from:null,to:null,marker:marker};size+=line.text.length;if(curLine==from.line){span.from=from.ch;size-=from.ch}if(curLine==to.line){span.to=to.ch;size-=line.text.length-to.ch}if(marker.collapsed){if(curLine==to.line)collapsedAtEnd=collapsedSpanAt(line,to.ch);if(curLine==from.line)collapsedAtStart=collapsedSpanAt(line,from.ch);else updateLineHeight(line,0)}addMarkedSpan(line,span);++curLine});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0)});if(marker.clearOnEnter)on(marker,"beforeCursorEnter",function(){marker.clear()});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory()}if(marker.collapsed){if(collapsedAtStart!=collapsedAtEnd)throw new Error("Inserting collapsed marker overlapping an existing one");marker.size=size;marker.atomic=true}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.className||marker.startStyle||marker.endStyle||marker.collapsed)regChange(cm,from.line,to.line+1);if(marker.atomic)reCheckSelection(cm)}return marker}function SharedTextMarker(markers,primary){this.markers=markers;this.primary=primary;for(var i=0,me=this;i<markers.length;++i){markers[i].parent=this;on(markers[i],"clear",function(){me.clear()})}}CodeMirror.SharedTextMarker=SharedTextMarker;SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")};SharedTextMarker.prototype.find=function(){return this.primary.find()};SharedTextMarker.prototype.getOptions=function(copyWidget){var inner=this.primary.getOptions(copyWidget);inner.shared=true;return inner};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.replacedWith;linkedDocs(doc,function(doc){if(widget)options.replacedWith=widget.cloneNode(true);markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)});return new SharedTextMarker(markers,primary)}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)if(spans[i]!=span)(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||marker.type=="bookmark"&&span.from==startCh&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||marker.type=="bookmark"&&span.from==endCh&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:span.to==null?null:span.to-endCh,marker:marker})}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=posEq(change.from,change.to);var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span)}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span)}}}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i)if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark)}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find();for(var j=0;j<parts.length;++j){var p=parts[j];if(posLess(p.to,m.from)||posLess(m.to,p.from))continue;var newParts=[j,1];if(posLess(p.from,m.from)||!mk.inclusiveLeft&&posEq(p.from,m.from))newParts.push({from:p.from,to:m.from});if(posLess(m.to,p.to)||!mk.inclusiveRight&&posEq(p.to,m.to))newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1}}return parts}function collapsedSpanAt(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if((sp.from==null||sp.from<ch)&&(sp.to==null||sp.to>ch)&&(!found||found.width<sp.marker.width))found=sp.marker}return found}function collapsedSpanAtStart(line){return collapsedSpanAt(line,-1)}function collapsedSpanAtEnd(line){return collapsedSpanAt(line,line.text.length+1)}function visualLine(doc,line){var merged;while(merged=collapsedSpanAtStart(line))line=getLine(doc,merged.find().from.line);return line}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find().to,endLine=getLine(doc,end.line);return lineIsHiddenInner(doc,endLine,getMarkedSpanFor(endLine.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&sp.from==span.to&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true}}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}var LineWidget=CodeMirror.LineWidget=function(cm,node,options){for(var opt in options)if(options.hasOwnProperty(opt))this[opt]=options[opt];this.cm=cm;this.node=node};function widgetOperation(f){return function(){var withOp=!this.cm.curOp;if(withOp)startOperation(this.cm);try{var result=f.apply(this,arguments)}finally{if(withOp)endOperation(this.cm)}return result}}LineWidget.prototype.clear=widgetOperation(function(){var ws=this.line.widgets,no=lineNo(this.line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i)if(ws[i]==this)ws.splice(i--,1);if(!ws.length)this.line.widgets=null;updateLineHeight(this.line,Math.max(0,this.line.height-widgetHeight(this)));regChange(this.cm,no,no+1)});LineWidget.prototype.changed=widgetOperation(function(){var oldH=this.height;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;updateLineHeight(this.line,this.line.height+diff);var no=lineNo(this.line);regChange(this.cm,no,no+1)});function widgetHeight(widget){if(widget.height!=null)return widget.height;if(!widget.node.parentNode||widget.node.parentNode.nodeType!=1)removeChildrenAndAdd(widget.cm.display.measure,elt("div",[widget.node],null,"position: relative"));return widget.height=widget.node.offsetHeight}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);if(widget.noHScroll)cm.display.alignWidgets=true;changeLine(cm,handle,function(line){(line.widgets||(line.widgets=[])).push(widget);widget.line=line;if(!lineIsHidden(cm.doc,line)||widget.showIfHidden){var aboveVisible=heightAtLine(cm,line)<cm.display.scroller.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,0,widget.height)}return true});return widget}function makeLine(text,markedSpans,estimateHeight){var line={text:text};attachMarkedSpans(line,markedSpans);line.height=estimateHeight?estimateHeight(line):1;return line}function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}function runMode(cm,text,mode,state,f){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curText="",curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;if(text==""&&mode.blankLine)mode.blankLine(state);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;stream.pos=Math.min(text.length,stream.start+5e4);style=null}else{style=mode.token(stream,state)}var substr=stream.current();stream.start=stream.pos;if(!flattenSpans||curStyle!=style){if(curText)f(curText,curStyle);curText=substr;curStyle=style}else curText=curText+substr}if(curText)f(curText,curStyle)}function highlightLine(cm,line,state){var st=[cm.state.modeGen];runMode(cm,line.text,cm.doc.mode,state,function(txt,style){st.push(txt,style)});for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1;runMode(cm,line.text,overlay.mode,true,function(txt,style){var start=i,len=txt.length;while(len){var cur=st[i],len_=cur.length;if(len_<=len){len-=len_}else{st.splice(i,1,cur.slice(0,len),st[i+1],cur.slice(len));len=0}i+=2}if(!style)return;if(overlay.opaque){st.splice(start,i-start,txt,style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=cur?cur+" "+style:style}}})}return st}function getLineStyles(cm,line){if(!line.styles||line.styles[0]!=cm.state.modeGen)line.styles=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)));return line.styles}function processLine(cm,line,state){var mode=cm.doc.mode;var stream=new StringStream(line.text,cm.options.tabSize);if(line.text==""&&mode.blankLine)mode.blankLine(state);while(!stream.eol()&&stream.pos<=cm.options.maxHighlightLength){mode.token(stream,state);stream.start=stream.pos}}var styleToClassCache={};function styleToClass(style){if(!style)return null;return styleToClassCache[style]||(styleToClassCache[style]="cm-"+style.replace(/ +/g," cm-"))}function lineContent(cm,realLine,measure){var merged,line=realLine,lineBefore,sawBefore,simple=true;while(merged=collapsedSpanAtStart(line)){simple=false;line=getLine(cm.doc,merged.find().from.line);if(!lineBefore)lineBefore=line}var builder={pre:elt("pre"),col:0,pos:0,display:!measure,measure:null,addedOne:false,cm:cm};if(line.textClass)builder.pre.className=line.textClass;do{builder.measure=line==realLine&&measure;builder.pos=0;builder.addToken=builder.measure?buildTokenMeasure:buildToken;if((ie||webkit)&&cm.getOption("lineWrapping"))builder.addToken=buildTokenSplitSpaces(builder.addToken);if(measure&&sawBefore&&line!=realLine&&!builder.addedOne){measure[0]=builder.pre.appendChild(zeroWidthElement(cm.display.measure));builder.addedOne=true}var next=insertLineContent(line,builder,getLineStyles(cm,line));sawBefore=line==lineBefore;if(next){line=getLine(cm.doc,next.to.line);simple=false}}while(next);if(measure&&!builder.addedOne)measure[0]=builder.pre.appendChild(simple?elt("span"," "):zeroWidthElement(cm.display.measure));if(!builder.pre.firstChild&&!lineIsHidden(cm.doc,realLine))builder.pre.appendChild(document.createTextNode(" "));var order;if(measure&&ie&&(order=getOrder(line))){var l=order.length-1;if(order[l].from==order[l].to)--l;var last=order[l],prev=order[l-1];if(last.from+1==last.to&&prev&&last.level<prev.level){var span=measure[builder.pos-1];if(span)span.parentNode.insertBefore(span.measureRight=zeroWidthElement(cm.display.measure),span.nextSibling)}}signal(cm,"renderLine",cm,realLine,builder.pre);return builder.pre}var tokenSpecialChars=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;function buildToken(builder,text,style,startStyle,endStyle){if(!text)return;if(!tokenSpecialChars.test(text)){builder.col+=text.length;var content=document.createTextNode(text)}else{var content=document.createDocumentFragment(),pos=0;while(true){tokenSpecialChars.lastIndex=pos;var m=tokenSpecialChars.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){content.appendChild(document.createTextNode(text.slice(pos,pos+skipped)));builder.col+=skipped}if(!m)break;pos+=skipped+1;if(m[0]=="	"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));builder.col+=tabWidth}else{var token=elt("span","•","cm-invalidchar");token.title="\\u"+m[0].charCodeAt(0).toString(16);content.appendChild(token);builder.col+=1}}}if(style||startStyle||endStyle||builder.measure){var fullStyle=style||"";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;return builder.pre.appendChild(elt("span",[content],fullStyle))}builder.pre.appendChild(content)}function buildTokenMeasure(builder,text,style,startStyle,endStyle){var wrapping=builder.cm.options.lineWrapping;for(var i=0;i<text.length;++i){var ch=text.charAt(i),start=i==0;if(ch>=""&&ch<""&&i<text.length-1){ch=text.slice(i,i+2);++i}else if(i&&wrapping&&spanAffectsWrapping.test(text.slice(i-1,i+1))){builder.pre.appendChild(elt("wbr"))}var span=builder.measure[builder.pos]=buildToken(builder,ch,style,start&&startStyle,i==text.length-1&&endStyle);if(ie&&wrapping&&ch==" "&&i&&!/\s/.test(text.charAt(i-1))&&i<text.length-1&&!/\s/.test(text.charAt(i+1)))span.style.whiteSpace="normal";builder.pos+=ch.length}if(text.length)builder.addedOne=true}function buildTokenSplitSpaces(inner){function split(old){var out=" ";for(var i=0;i<old.length-2;++i)out+=i%2?" ":" ";out+=" ";return out}return function(builder,text,style,startStyle,endStyle){return inner(builder,text.replace(/ {3,}/,split),style,startStyle,endStyle)}}function buildCollapsedSpan(builder,size,widget){if(widget){if(!builder.display)widget=widget.cloneNode(true);builder.pre.appendChild(widget);if(builder.measure&&size){builder.measure[builder.pos]=widget;builder.addedOne=true}}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,styles[i],styleToClass(styles[i+1]));return}var allText=line.text,len=allText.length;var pos=0,i=1,text="",style;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle="";collapsed=null;nextChange=Infinity;var foundBookmark=null;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(sp.from<=pos&&(sp.to==null||sp.to>pos)){if(sp.to!=null&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=""}if(m.className)spanStyle+=" "+m.className;if(m.startStyle&&sp.from==pos)spanStartStyle+=" "+m.startStyle;if(m.endStyle&&sp.to==nextChange)spanEndStyle+=" "+m.endStyle;if(m.collapsed&&(!collapsed||collapsed.marker.width<m.width))collapsed=sp}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}if(m.type=="bookmark"&&sp.from==pos&&m.replacedWith)foundBookmark=m.replacedWith}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len:collapsed.to)-pos,collapsed.from!=null&&collapsed.marker.replacedWith);if(collapsed.to==null)return collapsed.marker.find()}if(foundBookmark&&!collapsed)buildCollapsedSpan(builder,0,foundBookmark)}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"")}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=""}text=styles[i++];style=styleToClass(styles[i++])}}}function updateDoc(doc,change,markedSpans,selAfter,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,"change",line,change)}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(from.ch==0&&to.ch==0&&lastText==""){for(var i=0,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added)}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{for(var added=[],i=1,e=text.length-1;i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));added.push(makeLine(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,e=text.length-1,added=[];i<e;++i)added.push(makeLine(text[i],spansFor(i),estimateHeight));if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added)}signalLater(doc,"change",doc,change);setSelection(doc,selAfter.anchor,selAfter.head,null,true)}function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,e=lines.length,height=0;i<e;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;i<e;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return true}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0,e=children.length;i<e;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0)break;at=0}else at-=sz}if(this.size-n<25){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;i<e;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0,e=this.children.length;i<e;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0}else at-=sz}}};var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([makeLine("",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.history=makeHistory();this.frontier=firstLine;var start=Pos(firstLine,0);this.sel={from:start,to:start,head:start,anchor:start,shift:false,extend:false,goalColumn:null};this.id=++nextDocId;this.modeOption=mode;if(typeof text=="string")text=splitLines(text);updateDoc(this,{from:start,to:start,text:text},null,{head:start,anchor:start})};Doc.prototype=createObj(BranchChunk.prototype,{iter:function(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){var height=0;for(var i=0,e=lines.length;i<e;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||"\n")},setValue:function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:"setValue"},{head:top,anchor:top},true)},replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||"\n")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},setLine:function(line,text){if(isLine(this,line))replaceRange(this,text,Pos(line,0),clipPos(this,Pos(line)))},removeLine:function(line){if(line)replaceRange(this,"",clipPos(this,Pos(line-1)),clipPos(this,Pos(line)));else replaceRange(this,"",Pos(0,0),clipPos(this,Pos(1,0)))},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var sel=this.sel,pos;if(start==null||start=="head")pos=sel.head;else if(start=="anchor")pos=sel.anchor;else if(start=="end"||start===false)pos=sel.to;else pos=sel.from;return copyPos(pos)},somethingSelected:function(){return!posEq(this.sel.head,this.sel.anchor)},setCursor:docOperation(function(line,ch,extend){var pos=clipPos(this,typeof line=="number"?Pos(line,ch||0):line);if(extend)extendSelection(this,pos);else setSelection(this,pos,pos)}),setSelection:docOperation(function(anchor,head){setSelection(this,clipPos(this,anchor),clipPos(this,head||anchor))}),extendSelection:docOperation(function(from,to){extendSelection(this,clipPos(this,from),to&&clipPos(this,to))}),getSelection:function(lineSep){return this.getRange(this.sel.from,this.sel.to,lineSep)},replaceSelection:function(code,collapse,origin){makeChange(this,{from:this.sel.from,to:this.sel.to,text:splitLines(code),origin:origin},collapse||"around")},undo:docOperation(function(){makeChangeFromHistory(this,"undo")}),redo:docOperation(function(){makeChangeFromHistory(this,"redo")}),setExtending:function(val){this.sel.extend=val},historySize:function(){var hist=this.history;return{undo:hist.done.length,redo:hist.undone.length}},clearHistory:function(){this.history=makeHistory()},markClean:function(){this.history.dirtyCounter=0;this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return this.history.dirtyCounter==0},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=makeHistory();hist.done=histData.done.slice(0);hist.undone=histData.undone.slice(0)},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker)}return markers},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)if(sps[i].from!=null)markers.push(sps[i].marker)});return markers},posFromIndex:function(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true}off-=sz;++lineNo});return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1});return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:false,goalColumn:this.sel.goalColumn};if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];return copy},unlinkDoc:function(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},true);other.history=makeHistory();other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor".split(" ");for(var prop in Doc.prototype)if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared)}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)computeMaxLength(cm);cm.options.mode=doc.modeOption;regChange(cm)}function getLine(chunk,n){n-=chunk.first;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n});return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text)});return out}function updateLineHeight(line,height){var diff=height-line.height;for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0,e=chunk.children.length;i<e;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;i<e;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(cm,lineObj){lineObj=visualLine(cm.doc,lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height}}return h}function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order}function makeHistory(){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans;++n})}function historyChangeFromChange(doc,change){var histChange={from:change.from,to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},true);return histChange}function addToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur=lst(hist.done);if(cur&&(hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)=="+"&&doc.cm&&hist.lastTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)=="*"))){var last=lst(cur.changes);if(posEq(change.from,change.to)&&posEq(change.from,last.to)){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}cur.anchorAfter=selAfter.anchor;cur.headAfter=selAfter.head}else{cur={changes:[historyChangeFromChange(doc,change)],anchorBefore:doc.sel.anchor,headBefore:doc.sel.head,anchorAfter:selAfter.anchor,headAfter:selAfter.head};hist.done.push(cur);while(hist.done.length>hist.undoDepth)hist.done.shift();if(hist.dirtyCounter<0)hist.dirtyCounter=NaN;else hist.dirtyCounter++}hist.lastTime=time;hist.lastOp=opId;hist.lastOrigin=change.origin}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i)}else if(out)out.push(spans[i])}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup){for(var i=0,copy=[];i<events.length;++i){var event=events[i],changes=event.changes,newChanges=[];copy.push({changes:newChanges,anchorBefore:event.anchorBefore,headBefore:event.headBefore,anchorAfter:event.anchorAfter,headAfter:event.headAfter});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change)if(m=prop.match(/^spans_(\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}return copy}function rebaseHistSel(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(!sub.copied){cur.from=copyPos(cur.from);cur.to=copyPos(cur.to)}if(to<cur.from.line){cur.from.line+=diff;cur.to.line+=diff}else if(from<=cur.to.line){ok=false;break}}if(!sub.copied){sub.anchorBefore=copyPos(sub.anchorBefore);sub.headBefore=copyPos(sub.headBefore);sub.anchorAfter=copyPos(sub.anchorAfter);sub.readAfter=copyPos(sub.headAfter);sub.copied=true}if(!ok){array.splice(0,i+1);i=0}else{rebaseHistSel(sub.anchorBefore);rebaseHistSel(sub.headBefore);rebaseHistSel(sub.anchorAfter);rebaseHistSel(sub.headAfter)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}function stopMethod(){e_stop(this)}function addStop(event){if(!event.stop)event.stop=stopMethod;return event}function e_preventDefault(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false}function e_stopPropagation(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true}function e_stop(e){e_preventDefault(e);e_stopPropagation(e)}CodeMirror.e_stop=e_stop;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2}if(mac&&e.ctrlKey&&b==1)b=3;return b}function on(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f)}}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}}function signal(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<arr.length;++i)arr[i].apply(null,args)}var delayedCallbacks,delayedCallbackDepth=0;function signalLater(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);if(!delayedCallbacks){++delayedCallbackDepth;delayedCallbacks=[];setTimeout(fireDelayed,0)}function bnd(f){return function(){f.apply(null,args)}}for(var i=0;i<arr.length;++i)delayedCallbacks.push(bnd(arr[i]))}function fireDelayed(){--delayedCallbackDepth;var delayed=delayedCallbacks;delayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}CodeMirror.on=on;CodeMirror.off=off;CodeMirror.signal=signal;var scrollerCutOff=30;var Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}};function Delayed(){this.id=null}Delayed.prototype={set:function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms)}};function countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\s\u00a0]/);if(end==-1)end=string.length}for(var i=startIndex||0,n=startValue||0;i<end;++i){if(string.charAt(i)=="	")n+=tabSize-n%tabSize;else++n}return n}CodeMirror.countColumn=countColumn;var spaceStrs=[""];function spaceStr(n){while(spaceStrs.length<=n)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){if(ios){node.selectionStart=0;node.selectionEnd=node.value.length}else node.select()}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;i<e;++i)if(collection[i]==elt)return i;return-1}function createObj(base,props){function Obj(){}Obj.prototype=base;var inst=new Obj;if(props)copyObj(props,inst);return inst}function copyObj(obj,target){if(!target)target={};for(var prop in obj)if(obj.hasOwnProperty(prop))target[prop]=obj[prop];return target}function emptyArray(size){for(var a=[],i=0;i<size;++i)a.push(undefined);return a}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}var nonASCIISingleCaseWordChar=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/;function isWordChar(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return false;return true}var isExtendingChar=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content=="string")setTextContent(e,content);else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function setTextContent(e,str){if(ie_lt9){e.innerHTML="";e.appendChild(document.createTextNode(str))}else e.textContent=str}function getRect(node){return node.getBoundingClientRect()}CodeMirror.replaceGetRect=function(f){getRect=f};var dragAndDrop=function(){if(ie_lt9)return false;var div=elt("div");return"draggable"in div||"dragDrop"in div}();var spanAffectsWrapping=/^$/;if(gecko)spanAffectsWrapping=/$'/;else if(safari&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent))spanAffectsWrapping=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/;else if(webkit)spanAffectsWrapping=/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.]|\?[\w~`@#$%\^&*(_=+{[|><]/;var knownScrollbarWidth;function scrollbarWidth(measure){if(knownScrollbarWidth!=null)return knownScrollbarWidth;var test=elt("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");removeChildrenAndAdd(measure,test);if(test.offsetWidth)knownScrollbarWidth=test.offsetHeight-test.clientHeight;return knownScrollbarWidth||0}var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt("span","​");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!ie_lt8}if(zwspSupported)return elt("span","​");else return elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}var splitLines="\n\nb".split(/\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\n",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)=="\r"?nl-1:nl);var rt=line.indexOf("\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\r\n?|\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints("StartToEnd",range)!=0};var hasCopyEvent=function(){var e=elt("div");if("oncopy"in e)return true;e.setAttribute("oncopy","return;");return typeof e.oncopy=="function"}();var keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]="F"+i})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from)f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?"rtl":"ltr")}}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order))}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(cm.doc,line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch)}function lineEnd(cm,lineN){var merged,line;while(merged=collapsedSpanAtEnd(line=getLine(cm.doc,lineN)))lineN=merged.find().to.line;var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN,ch)}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var moveOneUnit=byUnit?function(pos,dir){do pos+=dir;while(pos>0&&isExtendingChar.test(line.text.charAt(pos)));return pos}:function(pos,dir){return pos+dir};var linedir=bidi[0].level;for(var i=0;i<bidi.length;++i){var part=bidi[i],sticky=part.level%2==linedir;if(part.from<start&&part.to>start||sticky&&(part.from==start||part.to==start))break}var target=moveOneUnit(start,part.level%2?-dir:dir);while(target!=null){if(part.level%2==linedir){if(target<part.from||target>part.to){part=bidi[i+=dir];target=part&&(dir>0==part.level%2?moveOneUnit(part.to,-1):moveOneUnit(part.from,1))}else break}else{if(target==bidiLeft(part)){part=bidi[--i];target=part&&bidiRight(part)}else if(target==bidiRight(part)){part=bidi[++i];target=part&&bidiLeft(part)}else break}}return target<0||target>line.text.length?null:target}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar.test(line.text.charAt(target)))target+=dir;return target<0||target>line.text.length?null:target}var bidiOrdering=function(){var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL";var arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr";function charType(code){if(code<=255)return lowTypes.charAt(code);else if(1424<=code&&code<=1524)return"R";else if(1536<=code&&code<=1791)return arabicTypes.charAt(code-1536);else if(1792<=code&&code<=2220)return"r";else return"L"}var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType="L";return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type=="m")types[i]=prev;else prev=type}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type=="1"&&cur=="r")types[i]="n";else if(isStrong.test(type)){cur=type;if(type=="r")types[i]="R"}}for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type=="+"&&prev=="1"&&types[i+1]=="1")types[i]="1";else if(type==","&&prev==types[i+1]&&(prev=="1"||prev=="n"))types[i]=prev;prev=type}for(var i=0;i<len;++i){var type=types[i];if(type==",")types[i]="N";else if(type=="%"){for(var end=i+1;end<len&&types[end]=="%";++end){}var replace=i&&types[i-1]=="!"||end<len-1&&types[end]=="1"?"1":"N";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur=="L"&&type=="1")types[i]="L";else if(isStrong.test(type))cur=type}for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)=="L";var after=(end<len-1?types[end]:outerType)=="L";var replace=before||after?"L":"R";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push({from:start,to:i,level:0})}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!="L";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,{from:pos,to:j,level:1});var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,{from:nstart,to:j,level:2});pos=j}else++j}if(pos<i)order.splice(at,0,{from:pos,to:i,level:1})}}if(order[0].level==1&&(m=str.match(/^\s+/))){order[0].from=m[0].length;order.unshift({from:0,to:m[0].length,level:0})}if(lst(order).level==1&&(m=str.match(/\s+$/))){lst(order).to-=m[0].length;order.push({from:len-m[0].length,to:len,level:0})}if(order[0].level!=lst(order).level)order.push({from:len,to:len,level:order[0].level});return order}}();CodeMirror.version="3.12";return CodeMirror}();(function(){if(!CodeMirror.modeURL)CodeMirror.modeURL="js/mode/%N.js";var loading={};function splitCallback(cont,n){var countDown=n;return function(){if(--countDown==0)cont()}}function ensureDeps(mode,cont){var deps=CodeMirror.modes[mode].dependencies;if(!deps)return cont();var missing=[];for(var i=0;i<deps.length;++i){if(!CodeMirror.modes.hasOwnProperty(deps[i]))missing.push(deps[i])}if(!missing.length)return cont();var split=splitCallback(cont,missing.length);for(var i=0;i<missing.length;++i)CodeMirror.requireMode(missing[i],split)}CodeMirror.requireMode=function(mode,cont){if(typeof mode!="string")mode=mode.name;if(CodeMirror.modes.hasOwnProperty(mode))return ensureDeps(mode,cont);if(loading.hasOwnProperty(mode))return loading[mode].push(cont);var script=document.createElement("script");script.src=CodeMirror.modeURL.replace(/%N/g,mode);var others=document.getElementsByTagName("script")[0];others.parentNode.insertBefore(script,others);var list=loading[mode]=[cont];var count=0,poll=setInterval(function(){if(++count>100)return clearInterval(poll);if(CodeMirror.modes.hasOwnProperty(mode)){clearInterval(poll);loading[mode]=null;ensureDeps(mode,function(){for(var i=0;i<list.length;++i)list[i]()})}},200)};CodeMirror.autoLoadMode=function(instance,mode){if(!CodeMirror.modes.hasOwnProperty(mode))CodeMirror.requireMode(mode,function(){instance.setOption("mode",instance.getOption("mode"))})}})();var strings_cn={"hide-title":"收起","show-title":"展开",pleaseinput:"请输入用户名",unauthorized:"用户名和密码不匹配",doesntmatch:"两次输入的密码不一致",namelength:"用户名的长度必须在6-20之间",passlength:"密码的长度不能大于32",registerok:'注册成功，请进入<a href="javascript:;" onclick="loginview()">登录</a>页面',"name exists":"用户名已存在","inner error":"服务器出错","name invalid":"用户名只能由字母或数字组成",loadfailed:"无法连接到服务器",inputfilename:"请输入文件名",conflict:"文件已存在",newfile:"新建文件",newfolder:"新建文件夹",inputpass:"请输入密码","password incorrect":"旧密码错误",createfilesuccess:"创建文件成功",createfoldersuccess:"创建文件夹成功",changepassword:"修改密码",changepassworddone:"修改密码成功",changeavatar:"修改头像",error:"出错",filenameinvalid:"文件名中不能包括 / \\ @","delete":"删除",rename:"重命名",needrelogin:"需要重新登录",inputusername:"请输入用户名",selectuser:"请选择一个用户","member already exists":"此用户已存在于共享列表中","member doesn't exists":"用户不存在","file exists":"文件已存在","can't add yourself":"不能共享给文件主人",changeavatarok:"头像修改成功",openeditor:"编辑",systemmessage:"系统消息",join:"加入了房间",leave:"离开了房间",console:"控制台","'s":"的",runsaprogram:"开始运行当前程序",programfinish:"程序运行结束，返回值为","kill-title":"终止","run-title":"运行",programkilledby:"程序被终止。中断信号为","not supported":"不支持的类型","saving...":"正在保存...",saved:"已保存",unsaved:"当前文件还没有保存，退出会造成数据丢失",unshared:"失去了对当前文件的共享权","you unshared":"你已经失去了对当前文件的共享权",deleted:"当前文件已被删除",info:"消息",gotshared:"获得了对当前文件的共享权",movedto:"当前文件名被修改成了",filename:"文件名",state:"状态",timestamp:"修改时间",nofile:"没有文件",owner:"所有者",shared:"共享",sharemanage:"共享管理","export":"导出","import":"导入",file:"文件",folder:"文件夹",login:"登录",username:"用户名",password:"密码",register:"注册",logout:"登出",confirm:"确认密码",owningfiles:"拥有的文件",sharedfiles:"共享的文件","currentdir:":"当前目录：",shareduser:"共享用户","maximum-title":"最大化",back:"返回",send:"发送",popushteam:"popush开发小组敬上",ok:"确定",cancel:"取消",name:"名称",clicktochange:"点击图片以更换头像（支持jpg，png格式）：",add:"增加","newuser:":"新用户名：",sshareduser:"的共享用户：",oldpassword:"旧密码",newpassword:"新密码",deleteconfirm:"确认删除",suretodelete:"确认要删除",newname:"新名称","debug-title":"调试","stop-debug-title":"停止调试",startdebug:"开始调试当前程序",filenamelength:"文件名必须小于32个字符",addexpression:"添加监视",console:"控制台","step-title":"逐语句","next-title":"逐过程","continue-title":"继续",finished:"<已终止>",waiting:"<暂挂>",nosource:"<断点不在源代码内>","too large":"头像大小不能超过1M",esctoexit:"按 Esc 退出最大化","finish-title":"跳出过程",voice:"语音",removeexpression:"删除监视",novoice:"该浏览器不支持语音，请使用<br />Chrome 18+或Opera 12+","only-platform":"只是另外一个协作编程平台","only-contain":"只能包含字母和数字",changeLanguage:"English Version"};function getElementsByClassName(classname){var d=document;var e=d.getElementsByTagName("*");var c=new RegExp("\\b"+classname+"\\b");var r=[];for(var i=0,l=e.length;i<l;i++){var cn=e[i].className;if(c.test(cn)){r.push(e[i])}}return r}if(typeof document.getElementsByClassName!="function"){document.getElementsByClassName=getElementsByClassName}var allFileLists=[];var exttoicon={c:"c",clj:"clj",coffee:"coffee",cpp:"cpp",cs:"cs",css:"css",go:"go",h:"h",htm:"htm",html:"html",hpp:"hpp",java:"java",js:"js",json:"json",lisp:"lisp",lua:"lua",md:"md",pas:"pas",php:"php",pl:"pl",py:"py",rb:"rb",sql:"sql",tex:"tex",vbs:"vbs",xml:"xml"};function fileList(table){var obj=$(table);var header='<tr class="head"><th class="col1">&nbsp;</th>'+'<th class="col2">'+strings["filename"]+'</th><th class="col3">'+strings["state"]+"</th>"+'<th class="col4">'+strings["timestamp"]+'</th><th class="col5">&nbsp;</th></tr>';var elements=[];var mode=3;var getpic=function(type,shared,ext){var s="images/ext/";if(type=="dir"){s+="dict"}else{if(exttoicon[ext])s+=exttoicon[ext];else s+="file"}s+=".png";return s};var n=allFileLists.length;var oldhtml="";var haveloading=false;function formatDate(t){var o=t.getMonth()+1;var h=t.getHours();var m=t.getMinutes();var s=t.getSeconds();return t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+t.getDate()+" "+(h<10?"0"+h:h)+":"+(m<10?"0"+m:m)+":"+(s<10?"0"+s:s)}r={elements:elements,clear:function(){obj.html(header+'<tr class="no-file"><td></td><td localization>'+strings["nofile"]+"</td><td></td><td></td><td></td></tr>");elements=[];this.elements=elements},getmode:function(){return mode},setmode:function(newmode){mode=newmode;if(mode&2)header='<tr class="head"><th class="col1">&nbsp;</th>'+'<th class="col2" localization>'+strings["filename"]+'</th><th class="col3" localization>'+strings["state"]+"</th>"+'<th class="col4" localization>'+strings["timestamp"]+'</th><th class="col5">&nbsp;</th></tr>';else header='<tr class="head"><th class="col1">&nbsp;</th>'+'<th class="col2" localization>'+strings["filename"]+'</th><th class="col3 owner" localization>'+strings["owner"]+"</th>"+'<th class="col4" localization>'+strings["timestamp"]+'</th><th class="col5">&nbsp;</th></tr>'},add:function(o){obj.find(".no-file").remove();var i=elements.length;var namesplit=o.name.split("/");namesplit=namesplit[namesplit.length-1];namesplit=namesplit.split(".");var ext=namesplit[namesplit.length-1];if(namesplit.length==1)ext="unknown";var toAppend="<tr>"+'<td class="col1"><img src="'+getpic(o.type,o.shared,ext)+'" height="32" width="32" /></td>'+'<td class="col2"><a href="javascript:;" onclick="allFileLists['+n+"].onname(allFileLists["+n+"].elements["+i+'])">'+htmlescape(o.showname)+"</a></td>"+(mode&2?'<td class="col3" localization>'+(o.shared?strings["shared"]:"")+"</td>":'<td class="col3 owner"><img class="user-'+o.owner.name+'" src="'+o.owner.avatar+'" width="32" height="32"/>'+o.owner.name+"</td>")+'<td class="col4">'+o.time+"</td>"+'<td class="col5"><div class="dropdown">'+'<a href="javascript:;" class="dropdown-toggle'+(mode?"":" disabled")+' opreation" data-toggle="dropdown">&nbsp;</a>'+'<ul class="dropdown-menu">'+(mode&1?'<li><a href="javascript:;" onclick="allFileLists['+n+"].onshare(allFileLists["+n+"].elements["+i+'])" localization>'+strings["sharemanage"]+"</a></li>":"")+(mode&2?'<li><a href="javascript:;" onclick="allFileLists['+n+"].ondelete(allFileLists["+n+"].elements["+i+'])" localization>'+strings["delete"]+"</a></li>"+'<li><a href="javascript:;" onclick="allFileLists['+n+"].onrename(allFileLists["+n+"].elements["+i+'])" localization>'+strings["rename"]+"</a></li>":"")+"</ul>"+"</div>"+"</td>"+"</tr>";obj.append(toAppend);return elements.push(o)},formdocs:function(docs,filter,alwaysshared,parent){this.clear();var all=[];var i;if(filter===undefined)filter=function(o){return true};for(i=0;i<docs.length;i++){var o=docs[i];if(!filter(o))continue;var n={};n["path"]=o.path;var paths=o.path.split("/");if((mode&2)==0&&paths.length==3){n["name"]=paths[1]+"/"+paths[2];n["showname"]=paths[2]+"@"+paths[1]}else{n["showname"]=n["name"]=paths[paths.length-1]}n["type"]=o.type;if(!alwaysshared)n["shared"]=o.members&&o.members.length?true:false;else n["shared"]=true;n["members"]=o.members;if(!o.owner&&parent)n["owner"]=parent.owner;else n["owner"]=o.owner;if(o.modifyTime){var t=new Date(o.modifyTime);n["time"]=formatDate(t)}else{n["time"]="-"}n["toString"]=function(){return"{ path:"+this.path+", name:"+this.name+", type:"+this.type+", shared:"+this.shared+", time:"+this.time+" }"};all.push(n)}all.sort(function(a,b){if(a.type==b.type)return a.name>b.name?1:-1;else return a.type=="dir"?-1:1});for(i=0;i<all.length;i++){var o=all[i];this.add(o)}},loading:function(){oldhtml=obj.html();haveloading=true;setTimeout("allFileLists["+n+"].loadingthen();",300)},loadingthen:function(){if(haveloading)obj.html(header+'<tr class="loading"><td></td><td><img src="images/loading.gif"/></td><td></td><td></td><td></td></tr>')},removeloading:function(){obj.html(oldhtml);haveloading=false},onname:function(o){alert("onname")},onshare:function(o){alert("onshare")},ondelete:function(o){alert("ondelete")},onrename:function(o){alert("onrename")},ondownload:function(o){alert("ondownload")}};allFileLists.push(r);return r}var allUserLists=[];function userList(div){var obj=$(div);var elements=[];var n=allUserLists.length;var selected;r={elements:elements,clear:function(){obj.html("");elements=[];this.elements=elements;selected=null},add:function(user){var i=elements.length;obj.append('<li><a href="javascript:;" onclick="allUserLists['+n+"].onselect("+i+')">'+'<img class="userlistimg user-'+user.name+'" height="32" width="32" src="'+user.avatar+'">'+user.name+"</a></li>");return elements.push(user)},getselection:function(){return selected},onselect:function(i){obj.find("li").removeClass("active");obj.find("li:eq("+i+")").addClass("active");selected=elements[i]},fromusers:function(users){this.clear();users.sort(function(a,b){return a.name>b.name?1:-1});for(var i=0;i<users.length;i++){this.add(users[i])}}};allUserLists.push(r);return r}function userListAvatar(div){var obj=$(div);var elements={};var n=allUserLists.length;r={elements:elements,clear:function(){obj.html("");elements={};this.elements=elements},add:function(user,owner){var userobj=$('<img id="avatar'+n+"-"+user.name+'" src="'+user.avatar+'" width="40" height="40"'+' class="pull-left online shared-character user-'+user.name+'" />');obj.append(userobj);$("#avatar"+n+"-"+user.name).popover({html:true,content:'<img class="pull-left popover-character user-'+user.name+'" src="'+user.avatar+'" width="48" height="48" />'+"<b>"+user.name+'</b><br /><span></span><div style="clear:both;"></div>',placement:"bottom",trigger:"hover"});user.obj=userobj;user.online=false;user.owner=false;if(owner)user.owner=true;elements[user.name]=user},remove:function(username){$("#avatar"+n+"-"+username).remove();if(elements[username])delete elements[username]},fromdoc:function(doc){this.clear();doc.members.sort(function(a,b){return a.name>b.name?1:-1});this.add(doc.owner,true);for(var i=0;i<doc.members.length;i++){var user=doc.members[i];this.add(user)}},refreshpopover:function(user){$("#avatar"+n+"-"+user.name).popover("destroy");$("#avatar"+n+"-"+user.name).popover({html:true,content:'<img class="pull-left popover-character user-'+user.name+'" src="'+user.avatar+'" width="48" height="48" />'+"<b>"+user.name+'</b><br /><span></span><div style="clear:both;"></div>',placement:"bottom",trigger:"hover"})},setonline:function(username,online){if(online)$("#avatar"+n+"-"+username).addClass("online");else $("#avatar"+n+"-"+username).removeClass("online");elements[username].online=online},setalloffline:function(){for(var i in elements){var user=elements[i];$("#avatar"+n+"-"+user.name).removeClass("online");user.online=false}},sort:function(){var arr=[];for(var i in elements){arr.push(elements[i])}arr.sort(function(a,b){return a.owner&&!b.owner?-1:!a.owner&&b.owner?1:a.online&&!b.online?-1:!a.online&&b.online?1:a.name>b.name?1:-1});for(var i=0;i<arr.length;i++){obj.append(arr[i].obj)}}};allUserLists.push(r);return r}var allExpressionLists=[];function expressionList(table){var obj=$(table);var n=allExpressionLists.length;var elemid=1;var elements={};var editingelem=null;var r={elements:elements,clear:function(){obj.html('<tr class="new"><td class="col1">&nbsp;</td>'+'<td class="col2" onclick="allExpressionLists['+n+'].addExpression()" title="'+strings["addexpression"]+'"><i class="icon-plus"></i></td>'+'<td class="col3"></td></tr>');elemid=1},addExpression:function(expression){this.doneall();var id=elemid;elemid++;var elem=$('<tr id="express-elem-'+n+"-"+id+'" onmouseover="$(this).find(\'a\').show()" onmouseout="$(this).find(\'a\').hide()">'+'<td class="col1">'+"</td>"+'<td class="col2">'+'<span class="title" onclick="allExpressionLists['+n+"].renameExpression("+id+')"></span>'+'<input type="text" onkeydown="if(event.keyCode==13)allExpressionLists['+n+"].renameExpressionDone("+id+')" '+'onblur="allExpressionLists['+n+'].doneall()"/></td>'+'<td class="col3"></td>'+"</tr>");if(expression===undefined){elem.find("span").hide();obj.find(".new").before(elem);elem.find("input").focus();elements[id]={elem:elem,expression:"",notnew:false};editingelem=id}else{elem.find("input").hide();elem.find("span").text(expression);obj.find(".new").before(elem);elements[id]={elem:elem,expression:expression,notnew:true}}},removeElement:function(id){elements[id].elem.remove();if(elements[id].elem==editingelem)editingelem=null;delete elements[id]},removeExpression:function(id){this.doneall();this.removeElement(id)},renameExpression:function(id){this.doneall();var input=elements[id].elem.find("input");var span=elements[id].elem.find(".title");var expression=span.text();span.hide();input.val($.trim(expression));input.show();input.focus();input.select();editingelem=id},renameExpressionDone:function(id){var input=elements[id].elem.find("input");var span=elements[id].elem.find(".title");var expression=$.trim(input.val());input.hide();if(expression==""){elements[id].elem.remove();delete elements[id];editingelem=null;return}else span.text(expression);span.show();elements[id].expression=expression},doneall:function(){if(editingelem){r.renameExpressionDone(editingelem);editingelem=null}},findElementByExpression:function(expression){for(var k in elements){var element=elements[k];if(element.expression==expression){return element}}},removeElementByExpression:function(expression){for(var k in elements){var element=elements[k];if(element.expression==expression){this.removeElement(k);return}}},seteditingelem:function(elem){editingelem=elem},geteditingelem:function(){return editingelem},setValue:function(expression,value){var v=this.findElementByExpression(expression);if(!v)return;var elem=v.elem;if(value!==null)elem.find(".col3").text(value);else elem.find(".col3").html('<span style="color:red">undefined</span>')}};allExpressionLists.push(r);return r}var currentUser;var currentDir;var currentDirString;var dirMode="owned";var newfiletype="doc";var filelisterror=function(){};var docshowfilter=function(o){return true};var filelist;var userlist;var currentsharedoc;var memberlist;var memberlistdoc;var expressionlist;var movehandler;var dochandler;var doccallback;var loadDone=false;var failed=false;var loadings={};var gutterclick;var firstconnect=true;var loginLock=false;var registerLock=false;var viewswitchLock=false;var operationLock=false;var Browser={};var ua=navigator.userAgent.toLowerCase();var s;(s=ua.match(/msie ([\d.]+)/))?Browser.ie=s[1]:(s=ua.match(/firefox\/([\d.]+)/))?Browser.firefox=s[1]:(s=ua.match(/chrome\/([\d.]+)/))?Browser.chrome=s[1]:(s=ua.match(/opera.([\d.]+)/))?Browser.opera=s[1]:(s=ua.match(/version\/([\d.]+).*safari/))?Browser.safari=s[1]:0;var novoice=false;function loading(id){if(loadings[id])return;var o=$("#"+id);o.after('<p id="'+id+'-loading" align="center" style="margin:1px 0 2px 0"><img src="images/loading.gif"/></p>');o.hide();loadings[id]={self:o,loading:$("#"+id+"-loading")}}function removeloading(id){if(!loadings[id])return;loadings[id].self.show();loadings[id].loading.remove();delete loadings[id]}function cleanloading(){for(var k in loadings){removeloading(k)}}function showmessage(id,stringid,type){var o=$("#"+id);o.removeClass("alert-error");o.removeClass("alert-success");o.removeClass("alert-info");if(type&&type!=""&&type!="warning")o.addClass("alert-"+type);if(strings[stringid])$("#"+id+" span").html(strings[stringid]);else $("#"+id+" span").html(stringid);o.slideDown()}function showmessageindialog(id,stringid,index){if(index===undefined){$("#"+id+" .control-group").addClass("error");if(strings[stringid])$("#"+id+" .help-inline").text(strings[stringid]);else $("#"+id+" .help-inline").text(stringid)}else{$("#"+id+" .control-group:eq("+index+")").addClass("error");if(strings[stringid])$("#"+id+" .help-inline:eq("+index+")").text(strings[stringid]);else $("#"+id+" .help-inline:eq("+index+")").text(stringid)}}function showmessagebox(title,content,timeout){if(strings[title])$("#messagedialogLabel").html(strings[title]);else $("#messagedialogLabel").html(title);if(strings[content])$("#messagedialogContent").html(strings[content]);else $("#messagedialogContent").html(content);$("#messagedialog").modal("show");t=setTimeout("$('#messagedialog').modal('hide');",timeout*1e3)}function pressenter(e,func){e=e||event;if(e.keyCode==13&&loadDone)func()}function loadfailed(){if(loadDone)return;failed=true;$("#loading-init").remove();showmessage("login-message","loadfailed")}function getdirstring(){if(dirMode=="owned")return"/"+currentDir.join("/");else{var name=currentDir.shift();var r="/"+currentDir.join("/");if(currentDir.length==0){r="/"+name}currentDir.unshift(name);return r}}function getdirlink(before){var s="";if(!before){before=""}for(var i=0,j=currentDir.length-1;i<currentDir.length;i++,j--){var t=currentDir[i];var p=t.split("/");if(p.length>1)t=p[1]+"@"+p[0];if(i==0&&dirMode=="shared")s+=' / <a href="javascript:;" onclick="'+before+"backto("+j+');">shared@'+htmlescape(t)+"</a>";else s+=' / <a href="javascript:;" onclick="'+before+"backto("+j+');">'+htmlescape(t)+"</a>"}return s}var languagemap={c:"clike",clj:"clojure",coffee:"coffeescript",cpp:"clike",cs:"clike",css:"css",go:"go",h:"clike",htm:"htmlmixed",html:"htmlmixed",hpp:"clike",java:"clike",js:"javascript",json:"javascript",lisp:"commonlisp",lua:"lua",md:"markdown",pas:"pascal",php:"php",pl:"perl",py:"python",rb:"ruby",sql:"sql",tex:"stex",vbs:"vb",xml:"xml"};var modemap={c:"text/x-csrc",clj:"text/x-clojure",coffee:"text/x-coffeescript",cpp:"text/x-c++src",cs:"text/x-csharp",css:"text/css",go:"text/x-go",h:"text/x-csrc",htm:"text/html",html:"text/html",hpp:"text/x-c++src",java:"text/x-java",js:"text/javascript",json:"application/json",lisp:"text/x-common-lisp",lua:"text/x-lua",md:"text/x-markdown",pas:"text/x-pascal",php:"application/x-httpd-php",pl:"text/x-perl",py:"text/x-python",rb:"text/x-ruby",sql:"text/x-sql",tex:"text/x-latex",vbs:"text/x-vb",xml:"application/xml"};function changelanguage(language){if(languagemap[language]){if(modemap[language])editor.setOption("mode",modemap[language]);else editor.setOption("mode",languagemap[language]);CodeMirror.autoLoadMode(editor,languagemap[language])}else{editor.setOption("mode","text/plain");CodeMirror.autoLoadMode(editor,"")}}function isFullScreen(cm){return/\bCodeMirror-fullscreen\b/.test(cm.getWrapperElement().className)}function winHeight(){return window.innerHeight||(document.documentElement||document.body).clientHeight}function setFullScreen(cm,full){var wrap=cm.getWrapperElement();if(full){$("#editormain").css("position","static");$("#editormain-inner").css("position","static");$("#fullscreentip").fadeIn();setTimeout("$('#fullscreentip').fadeOut();",1e3);wrap.className+=" CodeMirror-fullscreen";wrap.style.height=winHeight()+"px";document.documentElement.style.overflow="hidden"}else{$("#editormain").css("position","fixed");$("#editormain-inner").css("position","relative");$("#fullscreentip").hide();wrap.className=wrap.className.replace(" CodeMirror-fullscreen","");wrap.style.height="";document.documentElement.style.overflow=""}cm.refresh();cm.focus()}function allselffilter(o){return currentDir.length>1||o.owner.name==currentUser.name}function allsharefilter(o){return currentDir.length>1||o.owner.name!=currentUser.name}function htmlescape(text){return text.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/ /gm,"&nbsp;").replace(/\n/gm,"<br />")}function backtologin(){$("#big-one .container").removeAttr("style");$("#big-one").animate({height:"120px",padding:"60px","margin-bottom":"30px"},"fast",function(){$("#big-one").removeAttr("style");$("#big-one .container").css("margin","auto");$("#login-inputName").focus();resize()});$("#nav-head").fadeOut("fast");$("#filecontrol").hide();$("#editor").hide();$("#login").fadeIn("fast");$("#footer").show();$(".modal").modal("hide")}var socket=io.connect(SOCKET_IO);socket.on("unauthorized",function(){backtologin();showmessage("login-message","needrelogin","error");if(!window.joinedARoom){return}window.joinedARoom=false;window.voiceConnection.myLocalStream.stop();window.voiceConnection.leave();while(window.userArray.length>0){$(window.audioArray[window.userArray.shift()]).remove()}delete window.voiceConnection});socket.on("version",function(data){if(data.version!=VERSION){location.reload("Refresh")}if(failed)return;if(!firstconnect){backtologin()}firstconnect=false;$("#loading-init").remove();cleanloading();if($.cookie("sid")){socket.emit("relogin",{sid:$.cookie("sid")});loading("login-control");loginLock=true}else{$("#login-control").fadeIn("fast")}loadDone=true});socket.on("connect",function(){socket.emit("version",{})});socket.on("register",function(data){if(data.err){showmessage("register-message",data.err,"error")}else{showmessage("register-message","registerok");$("#register-inputName").val("");$("#register-inputPassword").val("");$("#register-confirmPassword").val("")}removeloading("register-control");registerLock=false});socket.on("login",function(data){if(data.err){if(data.err=="expired"){$.removeCookie("sid")}else{showmessage("login-message",data.err,"error")}}else{operationLock=false;$("#login-inputName").val("");$("#login-inputPassword").val("");$("#login-message").hide();$("#ownedfile").show();$("#ownedfileex").hide();$("#sharedfile").removeClass("active");$("#share-manage-link").hide();$("#big-one").animate({height:"40px",padding:"0","margin-bottom":"20px"},"fast");$("#nav-head").fadeIn("fast");$("#login").hide();$("#editor").hide();$("#filecontrol").fadeIn("fast");$("#nav-user-name").text(data.user.name);$("#nav-avatar").attr("src",data.user.avatar);currentUser=data.user;$.cookie("sid",data.sid,{expires:7});dirMode="owned";docshowfilter=allselffilter;currentDir=[data.user.name];currentDirString=getdirstring();$("#current-dir").html(getdirlink());filelist.setmode(3);filelist.formdocs(data.user.docs,docshowfilter);memberlist.clear();memberlist.add(data.user)}cleanloading();loginLock=false});socket.on("doc",function(data){dochandler(data)});function refreshlistdone(data){filelist.removeloading();if(data.err){filelisterror();showmessagebox("error","failed",1)}else{$("#current-dir").html(getdirlink());if(dirMode=="owned")filelist.setmode(filelist.getmode()|2);else filelist.setmode(0);if(currentDir.length==1){if(dirMode=="owned")filelist.setmode(filelist.getmode()|1);filelist.formdocs(data.doc,docshowfilter);memberlist.clear();memberlist.add(currentUser)}else{filelist.setmode(filelist.getmode()&~1);filelist.formdocs(data.doc.docs,docshowfilter,data.doc.members.length>0,data.doc);memberlist.fromdoc(data.doc);memberlistdoc.fromdoc(data.doc)}if(doccallback)doccallback()}operationLock=false}function sharedone(data){if(!data.err){userlist.fromusers(data.doc.members)}$("#share-message").hide();removeloading("share-buttons");operationLock=false}socket.on("new",function(data){if(data.err){showmessageindialog("newfile",data.err)}else{$("#newfile").modal("hide");if(newfiletype=="doc")showmessagebox("newfile","createfilesuccess",1);else showmessagebox("newfolder","createfoldersuccess",1)}removeloading("newfile-buttons");operationLock=false;refreshfilelist(function(){})});socket.on("password",function(data){if(data.err){showmessageindialog("changepassword",data.err,0)}else{$("#changepassword").modal("hide");showmessagebox("changepassword","changepassworddone",1)}removeloading("changepassword-buttons");operationLock=false});socket.on("delete",function(data){$("#delete").modal("hide");if(data.err){showmessagebox("delete",data.err,1);operationLock=false}else{operationLock=false;refreshfilelist(function(){})}removeloading("delete-buttons")});socket.on("move",function(data){movehandler(data)});function renamedone(data){if(data.err){showmessageindialog("rename",data.err,0);operationLock=false}else{$("#rename").modal("hide");operationLock=false;refreshfilelist(function(){})}removeloading("rename-buttons")}socket.on("share",function(data){if(data.err){showmessage("share-message",data.err,"error");operationLock=false;removeloading("share-buttons")}else{dochandler=sharedone;socket.emit("doc",{path:currentsharedoc.path})}});socket.on("unshare",function(data){if(data.err){showmessage("share-message",data.err,"error");operationLock=false;removeloading("share-buttons")}else{dochandler=sharedone;socket.emit("doc",{path:currentsharedoc.path})}});socket.on("avatar",function(data){if(data.err){showmessage("changeavatar-message",data.err,"error")}else{currentUser.avatar=data.url;$("#nav-avatar").attr("src",currentUser.avatar);$("#changeavatar-img").attr("src",currentUser.avatar);$("img.user-"+currentUser.name).attr("src",currentUser.avatar);memberlist.refreshpopover(currentUser);memberlistdoc.refreshpopover(currentUser);showmessage("changeavatar-message","changeavatarok")}operationLock=false});function loginview(){if(viewswitchLock)return;viewswitchLock=true;$("#register .blink").fadeOut("fast");$("#register-message").slideUp();$("#register-padding").fadeOut("fast",function(){$("#login").show();$("#login .blink").fadeIn("fast");$("#register").hide();$("#login-inputName").val("");$("#login-inputPassword").val("");$("#login-message").hide();$("#login-padding").slideUp("fast",function(){$("#login-inputName").focus();viewswitchLock=false});resize()})}function registerview(){if(viewswitchLock)return;viewswitchLock=true;$("#login .blink").fadeOut("fast");$("#login-message").slideUp();$("#login-padding").slideDown("fast",function(){$("#register").show();$("#register .blink").fadeIn("fast");$("#login").hide();$("#register-inputName").val("");$("#register-inputPassword").val("");$("#register-confirmPassword").val("");$("#register-message").hide();$("#register-padding").fadeIn("fast",function(){$("#register-inputName").focus();viewswitchLock=false});resize()})}function login(){var name=$("#login-inputName").val();var pass=$("#login-inputPassword").val();if(name==""){showmessage("login-message","pleaseinput","error");return}if(loginLock)return;loginLock=true;loading("login-control");socket.emit("login",{name:$("#login-inputName").val(),password:$("#login-inputPassword").val()})}function logout(){socket.emit("logout",{});$.removeCookie("sid");backtologin()}function register(){var name=$("#register-inputName").val();var pass=$("#register-inputPassword").val();var confirm=$("#register-confirmPassword").val();if(!/^[A-Za-z0-9]*$/.test(name)){showmessage("register-message","name invalid");return}if(name.length<6||name.length>20){showmessage("register-message","namelength");return}if(pass.length>32){showmessage("register-message","passlength");return}if(pass!=confirm){showmessage("register-message","doesntmatch");return}if(registerLock)return;registerLock=true;loading("register-control");socket.emit("register",{name:name,password:pass,avatar:"images/character.png"})}function newfileopen(){$("#newfile-inputName").val("");$("#newfile .control-group").removeClass("error");$("#newfile .help-inline").text("");$("#newfileLabel").text(strings["newfile"]);newfiletype="doc"}function newfolderopen(){$("#newfile-inputName").val("");$("#newfile .control-group").removeClass("error");$("#newfile .help-inline").text("");$("#newfileLabel").text(strings["newfolder"]);newfiletype="dir"}function newfile(){var name=$("#newfile-inputName").val();name=$.trim(name);if(name==""){showmessageindialog("newfile","inputfilename");return}if(/\/|\\|@/.test(name)){showmessageindialog("newfile","filenameinvalid");return}if(name.length>32){showmessageindialog("newfile","filenamelength");return}if(operationLock)return;operationLock=true;loading("newfile-buttons");socket.emit("new",{type:newfiletype,path:currentDirString+"/"+name})}function changepasswordopen(){$("#changepassword-old").val("");$("#changepassword-new").val("");$("#changepassword-confirm").val("");$("#changepassword .control-group").removeClass("error");$("#changepassword .help-inline").text("")}function changeavataropen(){$("#changeavatar-message").hide();$("#changeavatar-img").attr("src",currentUser.avatar)}function changepassword(){var old=$("#changepassword-old").val();var pass=$("#changepassword-new").val();var confirm=$("#changepassword-confirm").val();$("#changepassword .control-group").removeClass("error");$("#changepassword .help-inline").text("");if(pass!=confirm){showmessageindialog("changepassword","doesntmatch",2);return}if(operationLock)return;operationLock=true;loading("changepassword-buttons");socket.emit("password",{password:old,newPassword:pass})}function sharedfilelist(){if(dirMode=="shared")return;if(operationLock)return;operationLock=true;dirMode="shared";docshowfilter=allsharefilter;currentDir=[currentUser.name];currentDirString=getdirstring();$("#current-dir").html(getdirlink());refreshfilelist(function(){});$("#ownedfile").hide();$("#ownedfileex").show();$("#sharedfile").addClass("active")}function ownedfilelist(){if(operationLock)return;operationLock=true;dirMode="owned";docshowfilter=allselffilter;currentDir=[currentUser.name];currentDirString=getdirstring();$("#current-dir").html(getdirlink());refreshfilelist(function(){});$("#ownedfile").show();$("#ownedfileex").hide();$("#sharedfile").removeClass("active")}var editor;var chatstate=false;var oldwidth;function togglechat(o){if(viewswitchLock)return;if(chatstate){$("#editormain").parent().removeClass("span12");$("#editormain").parent().addClass("span9");$("#chatbox").show();$(o).html('<i class="icon-forward"></i>');$(o).attr("title",strings["hide-title"])}else{$("#chatbox").hide();$("#editormain").parent().removeClass("span9");$("#editormain").parent().addClass("span12");$(o).html('<i class="icon-backward"></i>');$(o).attr("title",strings["show-title"])}var o=$("#chat-show").get(0);o.scrollTop=o.scrollHeight;editor.refresh();resize();chatstate=!chatstate}function refreshfilelist(error,callback){operationLock=true;filelist.loading();dochandler=refreshlistdone;doccallback=callback;socket.emit("doc",{path:currentDirString});filelisterror=error}var deleteconfirm=function(){};var rename=function(){};function share(){var name=$("#share-inputName").val();if(name==""){showmessage("share-message","inputusername","error");return}if(operationLock)return;operationLock=true;loading("share-buttons");socket.emit("share",{path:currentsharedoc.path,name:name})}function unshare(){var selected=userlist.getselection();if(!selected){showmessage("share-message","selectuser","error");return}if(operationLock)return;operationLock=true;loading("share-buttons");socket.emit("unshare",{path:currentsharedoc.path,name:selected.name})}function closeshare(){if(operationLock)return;refreshfilelist(function(){});$("#share").modal("hide")}function shareopen(o){$("#share-name").text(o.name);$("#share-inputName").val("");$("#share-message").hide();userlist.fromusers(o.members);$("#share").modal("show");currentsharedoc=o}function changeavatar(o){if(o.files.length<0){showmessage("changeavatar-message","selectuser","error");return}if(operationLock)return;operationLock=true;var file=o.files[0];var reader=new FileReader;reader.onloadend=function(){if(reader.error){showmessage("changeavatar-message",reader.error,"error");operationLock=false}else{var s=reader.result;var t=s.substr(s.indexOf("base64")+7);if(t.length>1048576){showmessage("changeavatar-message","too large","error")}socket.emit("avatar",{type:file.type,avatar:t})}};reader.readAsDataURL(file)}function initfilelistevent(fl){fl.onname=function(o){if(operationLock)return;if(o.type=="dir"){currentDir.push(o.name);currentDirString=getdirstring();refreshfilelist(function(){currentDir.pop();currentDirString=getdirstring()})}else if(o.type=="doc"){openeditor(o)}};fl.ondelete=function(o){if(o.type=="dir")$("#delete").find(".folder").text(strings["folder"]);else $("#delete").find(".folder").text(strings["file"]);$("#delete-name").text(o.name);$("#delete").modal("show");deleteconfirm=function(){if(operationLock)return;operationLock=true;loading("delete-buttons");socket.emit("delete",{path:o.path})}};fl.onrename=function(o){$("#rename-inputName").val(o.name);$("#rename .control-group").removeClass("error");$("#rename .help-inline").text("");$("#rename").modal("show");rename=function(){var name=$("#rename-inputName").val();name=$.trim(name);if(name==""){showmessageindialog("rename","inputfilename");return}if(/\/|\\|@/.test(name)){showmessageindialog("rename","filenameinvalid");return}if(name==o.name){$("#rename").modal("hide");return}if(operationLock)return;operationLock=true;loading("rename-buttons");movehandler=renamedone;socket.emit("move",{path:o.path,newPath:currentDirString+"/"+name})}};fl.onshare=function(o){shareopen(o)}}function backto(n){if(operationLock)return;operationLock=true;var temp=[];for(var i=0;i<n;i++){temp.push(currentDir.pop())}currentDirString=getdirstring();refreshfilelist(function(){for(var i=0;i<n;i++){currentDir.push(temp.pop())}currentDirString=getdirstring()})}function getCookie(c_name){if(document.cookie.length>0){c_start=document.cookie.indexOf(c_name+"=");if(c_start!=-1){c_start=c_start+c_name.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1)c_end=document.cookie.length;return unescape(document.cookie.substring(c_start,c_end))}}return""}function loadjsfile(filename){var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",filename)}function setCookie(c_name,value,expiredays){var exdate=new Date;exdate.setDate(exdate.getDate()+expiredays);document.cookie=c_name+"="+escape(value)+(expiredays==null?"":";expires="+exdate.toGMTString())}function checkCookie(){var language=getCookie("language");if(language=="cn"){strings=strings_cn}else if(language=="en"){strings=strings_en}else{setCookie("language","cn",365);strings=strings_cn}}function changeLanguage(){var language=getCookie("language");if(language=="cn"){setCookie("language","en",365);strings_old=strings;strings=strings_en}else{setCookie("language","cn",365);strings_old=strings;strings=strings_cn}$("[title]").attr("title",function(index,old){for(var name in strings_old){if(strings_old[name]==old)return strings[name]}return old});$("[localization]").html(function(index,old){for(var name in strings_old){if(strings_old[name]==old)return strings[name]}return old})}$(document).ready(function(){setTimeout("loadfailed()",1e4);checkCookie();CodeMirror.on(window,"resize",function(){var showing=document.getElementsByClassName("CodeMirror-fullscreen")[0];if(!showing)return;showing.CodeMirror.getWrapperElement().style.height=winHeight()+"px"});editor=CodeMirror.fromTextArea($("#editor-textarea").get(0),{lineNumbers:true,lineWrapping:true,indentUnit:4,indentWithTabs:true,extraKeys:{Esc:function(cm){if(isFullScreen(cm))setFullScreen(cm,false);resize()},"Ctrl-S":saveevent},gutters:["runat","CodeMirror-linenumbers","breakpoints"]});editor.on("gutterClick",function(cm,n){gutterclick(cm,n)});gutterclick=function(cm,n){};registereditorevent();filelist=fileList("#file-list-table");filelist.clear();initfilelistevent(filelist);userlist=userList("#share-user-list");userlist.clear();memberlist=userListAvatar("#member-list");memberlistdoc=userListAvatar("#member-list-doc");expressionlist=expressionList("#varlist-table");docshowfilter=allselffilter;$("#newfile").on("shown",function(){$("#newfile-inputName").focus()});$("#changepassword").on("shown",function(){$("#changepassword-old").focus()});$("#rename").on("shown",function(){$("#rename-inputName").focus()});$("#share").on("shown",function(){$("#share-inputName").focus()});$("[localization]").html(function(index,old){if(strings[old])return strings[old];return old});$("[title]").attr("title",function(index,old){if(strings[old])return strings[old];return old});if(!ENABLE_RUN){$("#editor-run").remove();if(!ENABLE_DEBUG){$("#editor-console").remove()}}if(!ENABLE_DEBUG){$("#editor-debug").remove()}$("body").show();$("#login-inputName").focus();if((!Browser.chrome||parseInt(Browser.chrome)<18)&&(!Browser.opera||parseInt(Browser.opera)<12)){novoice=true;$("#voice-on").addClass("disabled");$("#voice-on").removeAttr("title");$("#voice-on").popover({html:true,content:strings["novoice"],placement:"left",trigger:"hover",container:"body"})}resize();$(window).resize(resize);$(window).scroll(function(){$("#editormain-inner").css("left",-$(window).scrollLeft()+"px")})});var runLock=false;var debugLock=false;var waiting=false;var runable=true;var runableext=["c","cpp","js","py","pl","rb","lua","java"];var debugable=true;var debugableext=["c","cpp"];var cursors={};var docobj;var lock=false;var doc;var q=[];var timer=null;var ext;var bq=[];var bps="";var runningline=-1;var consoleopen=false;var old_text;var old_bps;q._push=q.push;q.push=function(element){this._push(element);setsaving()};q._shift=q.shift;q.shift=function(){var r=this._shift();if(this.length==0&&bufferfrom==-1){setsaved()}return r};function runenabled(){return runable&&!debugLock&&(!issaving||runLock)}function debugenabled(){return debugable&&!runLock&&(!issaving||debugLock)}function setrunanddebugstate(){$("#editor-run").removeClass("disabled");$("#editor-debug").removeClass("disabled");if(!runenabled())$("#editor-run").addClass("disabled");if(!debugenabled())$("#editor-debug").addClass("disabled")}var savetimestamp;var issaving=false;var savetimeout=500;function setsaving(){$("#current-doc-state").addClass("red");$("#current-doc-state").text(strings["saving..."]);$("#editor-back").attr("title","");$("#editor-back").popover({html:true,content:strings["unsaved"],placement:"right",trigger:"hover",container:"body"});savetimestamp=0;issaving=true;setrunanddebugstate()}function setsaved(){savetimestamp=(new Date).getTime();setTimeout("setsavedthen("+savetimestamp+")",savetimeout);savetimeout=500}function setsavedthen(timestamp){if(savetimestamp==timestamp){$("#current-doc-state").removeClass("red");$("#current-doc-state").text(strings["saved"]);$("#editor-back").popover("destroy");$("#editor-back").attr("title",strings["back"]);issaving=false;setrunanddebugstate()}}function isrunable(ext){for(var i=0;i<runableext.length;i++){if(runableext[i]==ext)return true}return false}function isdebugable(ext){for(var i=0;i<debugableext.length;i++){if(debugableext[i]==ext)return true}return false}function newcursor(content){var cursor=$('<div class="cursor">'+'<div class="cursor-not-so-inner">'+'<div class="cursor-inner">'+'<div class="cursor-inner-inner">'+"</div>"+"</div>"+"</div>"+"</div>").get(0);$(cursor).find(".cursor-inner").popover({html:true,content:"<b>"+content+"</b>",placement:"bottom",trigger:"hover"});return cursor}function sendbreak(from,to,text){var req={version:doc.version,from:from,to:to,text:text};if(bq.length==0){socket.emit("bps",req)}bq.push(req)}function addbreakpointat(cm,n){var addlen=n-bps.length;if(addlen>0){var addtext="";for(var i=bps.length;i<n-1;i++){addtext+="0"}addtext+="1";sendbreak(bps.length,bps.length,addtext)}else{sendbreak(n,n+1,"1")}var element=$('<div><img src="images/breakpoint.png" /></div>').get(0);cm.setGutterMarker(n,"breakpoints",element)}function removebreakpointat(cm,n){var info=cm.lineInfo(n);if(info.gutterMarkers&&info.gutterMarkers["breakpoints"]){cm.setGutterMarker(n,"breakpoints",null);sendbreak(n,n+1,"0");return true}return false}function havebreakat(cm,n){var info=cm.lineInfo(n);if(info&&info.gutterMarkers&&info.gutterMarkers["breakpoints"]){return"1"}return"0"}function checkrunanddebug(ext){if(ENABLE_RUN){runable=isrunable(ext)}if(ENABLE_DEBUG){debugable=isdebugable(ext);if(debugable){gutterclick=function(cm,n){if(debugLock&&!waiting)return;if(!removebreakpointat(cm,n)){addbreakpointat(cm,n)}}}else{gutterclick=function(cm,n){}}removeallbreakpoints()}setrunanddebugstate()}function runtoline(n){if(runningline>=0){editor.removeLineClass(runningline,"*","running");editor.setGutterMarker(runningline,"runat",null)}if(n>=0){editor.addLineClass(n,"*","running");editor.setGutterMarker(n,"runat",$('<div><img src="images/arrow.png" width="16" height="16" style="min-width:16px;min-width:16px;" /></div>').get(0));editor.scrollIntoView({line:n,ch:0})}runningline=n}function removeallbreakpoints(){for(var i=0;i<bps.length;i++){if(bps[i]=="1"){var info=editor.lineInfo(i);if(info.gutterMarkers&&info.gutterMarkers["breakpoints"]){editor.setGutterMarker(i,"breakpoints",null)}}}bps.replace("1","0")}function initbreakpoints(bpsstr){bps=bpsstr;for(var i=bpsstr.length;i<editor.lineCount();i++){bps+="0"}for(var i=0;i<bps.length;i++){if(bps[i]=="1"){var element=$('<div><img src="images/breakpoint.png" /></div>').get(0);editor.setGutterMarker(i,"breakpoints",element)}}}var oldscrolltop=0;function openeditor(o){if(operationLock)return;operationLock=true;filelist.loading();docobj=o;socket.emit("join",{path:o.path})}function closeeditor(){$("#editor").hide();$("#filecontrol").show();$("#footer").show();socket.emit("leave",{});refreshfilelist(function(){},function(){$("body").animate({scrollTop:oldscrolltop})});leaveVoiceRoom()}function chat(){var text=$("#chat-input").val();if(text=="")return;socket.emit("chat",{text:text});$("#chat-input").val("")}function stdin(){if(debugLock&&waiting)return;var text=$("#console-input").val();if(runLock||debugLock){socket.emit("stdin",{data:text+"\n"})}else{appendtoconsole(text+"\n","stdin")}$("#console-input").val("")}function saveevent(cm){if(savetimestamp!=0)setsavedthen(savetimestamp);savetimestamp=0}function appendtochatbox(name,type,content,time){$("#chat-show-inner").append('<p class="chat-element"><span class="chat-name '+type+'">'+name+"&nbsp;&nbsp;"+time.toTimeString().substr(0,8)+"</span><br />"+content+"</p>");var o=$("#chat-show").get(0);o.scrollTop=o.scrollHeight}function appendtoconsole(content,type){if(type){type=' class="'+type+'"'}else{type=""}$("#console-inner").append("<span"+type+'">'+htmlescape(content)+"</span>");var o=$("#console-inner").get(0);o.scrollTop=o.scrollHeight}$(function(){expressionlist.renameExpression=function(id){this.doneall();if(debugLock&&!waiting)return;var input=this.elements[id].elem.find("input");var span=this.elements[id].elem.find(".title");var expression=span.text();span.hide();input.val($.trim(expression));input.show();input.focus();input.select();this.seteditingelem(id)};expressionlist.renameExpressionDone=function(id){var input=this.elements[id].elem.find("input");var span=this.elements[id].elem.find("span");var expression=$.trim(input.val());if(debugLock&&!waiting){if(!this.elements[id].notnew){this.elements[id].elem.remove();delete this.elements[id]}else{input.hide();span.show()}}else{if(this.elements[id].notnew){socket.emit("rm-expr",{expr:this.elements[id].expression})}if(expression!=""){socket.emit("add-expr",{expr:expression})}this.elements[id].elem.remove();delete this.elements[id]}this.seteditingelem(null)};expressionlist.removeExpression=function(id){this.doneall();socket.emit("rm-expr",{expr:this.elements[id].expression})}});socket.on("add-expr",function(data){if(data.expr){expressionlist.addExpression(data.expr);expressionlist.setValue(data.expr,data.val)}});socket.on("rm-expr",function(data){expressionlist.removeElementByExpression(data.expr)});socket.on("chat",function(data){var text=htmlescape(data.text);var time=new Date(data.time);appendtochatbox(data.name,data.name==currentUser.name?"self":"",text,time)});socket.on("deleted",function(data){closeeditor();showmessagebox("info","deleted",1)});socket.on("unshared",function(data){if(data.name==currentUser.name){closeeditor();showmessagebox("info","you unshared",1)}else{memberlistdoc.remove(data.name);appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;"+strings["unshared"],new Date(data.time))}});socket.on("shared",function(data){memberlistdoc.add(data);memberlistdoc.setonline(data.name,false);memberlistdoc.sort();appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;"+strings["gotshared"],new Date(data.time))});socket.on("moved",function(data){var thepath=data.newPath.split("/");thepath.shift();var thename;var realname;if(dirMode=="owned"){realname=thename=thepath.pop();currentDir=thepath}else{var name=currentDir.shift();if(thepath.length==2){thename=thepath[1]+"@"+thepath[0];realname=thepath[1];currentDir=[]}else{realname=thename=thepath.pop();thepath.unshift(thepath.shift()+"/"+thepath.shift());currentDir=thepath}currentDir.unshift(name)}var filepart=realname.split(".");ext=filepart[filepart.length-1];changelanguage(ext);checkrunanddebug(ext);appendtochatbox(strings["systemmessage"],"system",strings["movedto"]+thename,new Date(data.time));$("#current-doc").html(htmlescape(thename))});function leaveVoiceRoom(){while(window.userArray.length>0){$(window.audioArray[window.userArray.shift()]).remove()}while(window.peerUserArray.length>0){var peerUName=window.peerUserArray.shift();if(window.peerArray[peerUName]){window.peerArray[peerUName].myOnRemoteStream=function(stream){stream.mediaElement.muted=true;return}}}if(!window.joinedARoom){return}$("#voice-on").removeClass("active");window.voiceConnection.myLocalStream.stop();window.voiceConnection.leave();delete window.voiceConnection}function voice(){if(novoice)return;if(window.voiceLock){return}window.voiceLock=true;window.voiceon=!window.voiceon;if(window.voiceon){if(window.joinedARoom){return}$("#voice-on").addClass("active");try{var username=$("#nav-user-name").html();var dataRef=new Firebase("https://popush.firebaseIO.com/"+doc.id);dataRef.once("value",function(snapShot){delete dataRef;if(snapShot.val()==null){var connection=new RTCMultiConnection(doc.id);window.voiceConnection=connection;connection.session="audio-only";connection.autoCloseEntireSession=true;connection.onstream=function(stream){if(stream.type=="remote"&&stream.extra.username!=username){stream.mediaElement.style.display="none";stream.mediaElement.muted=false;stream.mediaElement.play();document.body.appendChild(stream.mediaElement);window.userArray.push(stream.extra.username);window.audioArray[stream.extra.username]=stream.mediaElement}};connection.onUserLeft=function(userid,extra,ejected){$(window.audioArray[extra.username]).remove();if(window.peerArray[extra.username]){window.peerArray[extra.username].myOnRemoteStream=function(stream){stream.mediaElement.muted=true;return}}};connection.connect();connection.open({extra:{username:username},interval:1e3})}else{var connection=new RTCMultiConnection(doc.id);window.voiceConnection=connection;connection.session="audio-only";connection.autoCloseEntireSession=true;connection.onNewSession=function(session){if(window.joinedARoom){return}connection.join(session,{username:username})};connection.onstream=function(stream){if(stream.type=="remote"&&stream.extra.username!=username){stream.mediaElement.style.display="none";stream.mediaElement.muted=false;stream.mediaElement.play();window.userArray.push(stream.extra.username);window.audioArray[stream.extra.username]=stream.mediaElement;document.body.appendChild(stream.mediaElement)}};connection.onUserLeft=function(userid,extra,ejected){if(ejected){$("#voice-on").removeClass("active");while(window.userArray.length>0){$(window.audioArray[window.userArray.shift()]).remove()}while(window.peerUserArray.length>0){var peerUName=window.peerUserArray.shift();if(window.peerArray[peerUName]){window.peerArray[peerUName].myOnRemoteStream=function(stream){stream.mediaElement.muted=true;return}}}delete window.voiceConnection;window.voiceon=!window.voiceon}else{$(window.audioArray[extra.username]).remove();if(window.peerArray[extra.username]){window.peerArray[extra.username].myOnRemoteStream=function(stream){stream.mediaElement.muted=true;return}}}};connection.connect()}})}catch(err){alert(err)}}else{leaveVoiceRoom()}}function run(){if(!runenabled())return;if(operationLock)return;operationLock=true;if(runLock){socket.emit("kill")}else{socket.emit("run",{version:doc.version,type:ext})}}function setrun(){runLock=true;$("#editor-run").html('<i class="icon-stop"></i>');$("#editor-run").attr("title",strings["kill-title"]);$("#console-inner").html("");$("#console-input").val("");$("#editor-debug").addClass("disabled");$("#console-title").text(strings["console"]);openconsole()}function debug(){if(!debugenabled())return;if(operationLock)return;operationLock=true;if(debugLock){socket.emit("kill")}else{socket.emit("debug",{version:doc.version,type:ext})}}function setdebug(){debugLock=true;$("#editor-debug").html('<i class="icon-eye-close"></i>');$("#editor-debug").attr("title",strings["stop-debug-title"]);$("#console-inner").html("");$("#console-input").val("");$("#editor-run").addClass("disabled");$("#console-title").text(strings["console"]);openconsole()}function debugstep(){if(debugLock&&waiting){socket.emit("step",{})}}function debugnext(){if(debugLock&&waiting){socket.emit("next",{})}}function debugfinish(){if(debugLock&&waiting){socket.emit("finish",{})}}function debugcontinue(){if(debugLock&&waiting){socket.emit("resume",{})}}function toggleconsole(){if(consoleopen){closeconsole()}else{openconsole()}}function closeconsole(){if(!consoleopen)return;consoleopen=false;$("#under-editor").hide();$("#editor-console").removeClass("active");resize()}function openconsole(){if(!consoleopen){consoleopen=true;$("#under-editor").show();$("#editor-console").addClass("active");resize()}$("#console-input").focus()}function resize(){var w;var h=$(window).height();if(h<100)h=100;var cbh=h-$("#member-list-doc").height()-138;var cbhexp=cbh>100?0:100-cbh;if(cbh<100)cbh=100;$("#chat-show").css("height",cbh+"px");$("#chatbox").css("height",h-83+cbhexp+"px");w=$("#editormain").parent().width();$("#editormain").css("width",w);var underh=h>636?212:h/3;if(!consoleopen)underh=0;$("#under-editor").css("height",underh+"px");$("#console").css("width",w-w/3-2+"px");$("#varlist").css("width",w/3-1+"px");$("#console").css("height",underh-12+"px");$("#varlist").css("height",underh-12+"px");$("#varlistreal").css("height",underh-42+"px");$("#console-inner").css("height",underh-81+"px");$("#console-input").css("width",w-w/3-14+"px");if(!isFullScreen(editor))$(".CodeMirror").css("height",h-underh-$("#over-editor").height()-90+"px");w=$("#chat-show").width();if(w!=0)$("#chat-input").css("width",w-70+"px");$("#file-list .span10").css("min-height",h-235+"px");w=$("#login-box").parent("*").width();$("#login-box").css("left",(w-420)/2-30+"px");w=$("#register-box").parent("*").width();$("#register-box").css("left",(w-420)/2-30+"px");$("#fullscreentip").css("left",($(window).width()-$("#fullscreentip").width())/2+"px");$("#editormain-inner").css("left",-$(window).scrollLeft()+"px");editor.refresh()}socket.on("run",function(data){appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;&nbsp;"+strings["runsaprogram"],new Date(data.time));setrun();operationLock=false});socket.on("debug",function(data){appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;&nbsp;"+strings["startdebug"],new Date(data.time));setdebug();editor.setOption("readOnly",true);old_text=editor.getValue();old_bps=bps;editor.setValue(data.text);removeallbreakpoints();initbreakpoints(data.bps);var editordoc=editor.getDoc();var hist=editordoc.getHistory();hist.done.pop();editordoc.setHistory(hist);operationLock=false});socket.on("running",function(data){if(!debugLock)return;waiting=false;runtoline(-1);$(".debugandwait").addClass("disabled");$("#console-title").text(strings["console"])});socket.on("waiting",function(data){if(!debugLock)return;waiting=true;if(typeof data.line==="number"){runtoline(data.line-1)}else{runtoline(-1)}for(var k in data.exprs){expressionlist.setValue(k,data.exprs[k])}$(".debugandwait").removeClass("disabled");if(typeof data.line==="number")$("#console-title").text(strings["console"]+strings["waiting"]);else if(data.line!==null)$("#console-title").text(strings["console"]+strings["waiting"]+"["+data.line+"]");else $("#console-title").text(strings["console"]+strings["waiting"]+strings["nosource"])});socket.on("stdout",function(data){appendtoconsole(data.data)});socket.on("stdin",function(data){appendtoconsole(data.data,"stdin")});socket.on("stderr",function(data){appendtoconsole(data.data,"stderr")});socket.on("exit",function(data){operationLock=false;if(data.err.code!==undefined)appendtochatbox(strings["systemmessage"],"system",strings["programfinish"]+"&nbsp;"+data.err.code,new Date(data.time));else appendtochatbox(strings["systemmessage"],"system",strings["programkilledby"]+"&nbsp;"+data.err.signal,new Date(data.time));if(runLock){$("#editor-run").html('<i class="icon-play"></i>');$("#editor-run").attr("title",strings["run-title"]);runLock=false}if(debugLock){editor.setValue(old_text);removeallbreakpoints();initbreakpoints(old_bps);var editordoc=editor.getDoc();var hist=editordoc.getHistory();hist.done.pop();editordoc.setHistory(hist);editor.setOption("readOnly",false);if(q.length>0){socket.emit("change",q[0])}$("#editor-debug").html('<i class="icon-eye-open"></i>');$("#editor-debug").attr("title",strings["debug-title"]);runtoline(-1);for(var k in expressionlist.elements){expressionlist.setValue(expressionlist.elements[k].expression,null)}debugLock=false}setrunanddebugstate();$("#console-title").text(strings["console"]+strings["finished"])});socket.on("join",function(data){if(data.err){showmessageindialog("openeditor",data.err);$("#editor").slideUp("fast");$("#filecontrol").slideDown("fast")}else{memberlistdoc.setonline(data.name,true);memberlistdoc.sort();appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;"+strings["join"],new Date(data.time));var cursor=newcursor(data.name);if(cursors[data.name]&&cursors[data.name].element)$(cursors[data.name].element).remove();cursors[data.name]={element:cursor,pos:0}}});socket.on("leave",function(data){memberlistdoc.setonline(data.name,false);memberlistdoc.sort();appendtochatbox(strings["systemmessage"],"system",data.name+"&nbsp;"+strings["leave"],new Date(data.time));if(cursors[data.name]){if(cursors[data.name].element)$(cursors[data.name].element).remove();delete cursors[data.name]}});socket.on("set",function(data){savetimestamp=1;setsavedthen(1);q.length=0;bq.length=0;lock=false;$("#editor-run").html('<i class="icon-play"></i>');$("#editor-run").attr("title",strings["run-title"]);runLock=false;debugLock=false;waiting=false;$("#current-doc").html(htmlescape(docobj.showname));$("#chat-input").val("");$("#chat-show-inner").text("");$("#editor").show();$("#filecontrol").hide();$("#footer").hide();var filepart=docobj.name.split(".");ext=filepart[filepart.length-1];changelanguage(ext);checkrunanddebug(ext);editor.refresh();if(currentDir.length==1){memberlistdoc.fromdoc(docobj)}memberlistdoc.setalloffline();memberlistdoc.setonline(currentUser.name,true);for(var k in cursors){$(cursors[k].element).remove()}cursors={};oldscrolltop=$("body").scrollTop();window.voiceon=false;window.voiceLock=false;window.userArray=[];window.audioArray={};window.joinedARoom=false;window.peerArray={};window.peerUserArray=[];$("#voice-on").removeClass("active");operationLock=false;lock=true;doc=data;editor.setValue(doc.text);editor.clearHistory();editor.setOption("readOnly",false);initbreakpoints(data.bps);for(var i in data.users){memberlistdoc.setonline(i,true);if(i==currentUser.name)continue;var cursor=newcursor(i);if(cursors[i]&&cursors[i].element)$(cursors[i].element).remove();cursors[i]={element:cursor,pos:0}}memberlistdoc.sort();filelist.removeloading();$("#console-inner").html("");closeconsole();expressionlist.clear();for(var k in data.exprs){expressionlist.addExpression(k);expressionlist.setValue(k,data.exprs[k])}$("#console-title").text(strings["console"]);resize();$("body").scrollTop(99999);if(data.running){setrun()}if(data.debugging){setdebug();editor.setOption("readOnly",true);old_text=data.text;old_bps=data.bps;if(data.state=="waiting"){waiting=true;runtoline(data.line-1);$(".debugandwait").removeClass("disabled");if(data.line!==null)$("#console-title").text(strings["console"]+strings["waiting"]);else $("#console-title").text(strings["console"]+strings["waiting"]+strings["nosource"])}}setrunanddebugstate();delete data.running;delete data.debugging;delete data.state});socket.on("ok",function(data){var chg=q.shift();if(!chg)return;doc.text=doc.text.substr(0,chg.from)+chg.text+doc.text.substr(chg.to);doc.version++;doc.version=doc.version%65536;for(var i=0;i<q.length;i++){q[i].version++;q[i].version=q[i].version%65536}for(var i=0;i<bq.length;i++){bq[i].version++;bq[i].version=bq[i].version%65536}if(q.length>0){socket.emit("change",q[0])}if(bq.length>0){socket.emit("bps",bq[0])}});socket.on("bpsok",function(data){var chg=bq.shift();if(!chg)return;bps=bps.substr(0,chg.from)+chg.text+bps.substr(chg.to);if(debugLock)old_bps=old_bps.substr(0,chg.from)+chg.text+old_bps.substr(chg.to);doc.version++;doc.version=doc.version%65536;for(var i=0;i<q.length;i++){q[i].version++;q[i].version=q[i].version%65536}for(var i=0;i<bq.length;i++){bq[i].version++;bq[i].version=bq[i].version%65536}if(q.length>0){socket.emit("change",q[0])}if(bq.length>0){socket.emit("bps",bq[0])}});socket.on("bps",function(data){var tfrom=data.from;var tto=data.to;var ttext=data.text;for(var i=0;i<bq.length;i++){if(bq[i].to<=tfrom){tfrom+=bq[i].text.length+bq[i].from-bq[i].to;tto+=bq[i].text.length+bq[i].from-bq[i].to}else if(bq[i].to<=tto&&bq[i].from<=tfrom){var tdlen=tto-bq[i].to;bq[i].to=tfrom;tfrom=bq[i].from+bq[i].text.length;tto=tfrom+tdlen}else if(bq[i].to<=tto&&bq[i].from>tfrom){tto=tto+bq[i].text.length+bq[i].from-bq[i].to;ttext=bq[i].text+ttext;bq[i].from=tfrom;bq[i].to=tfrom}else if(bq[i].to>tto&&bq[i].from<=tfrom){var bqlen=bq[i].text.length;bq[i].to=bq[i].to+ttext.length+tfrom-tto;bq[i].text=bq[i].text+ttext;tfrom=bq[i].from+bqlen;tto=tfrom}else if(bq[i].to>tto&&bq[i].from<=tto){var bqdlen=bq[i].to-tto;tto=bq[i].from;bq[i].from=tfrom+ttext.length;bq[i].to=bq[i].from+bqdlen}else if(bq[i].from>tto){bq[i].from+=ttext.length+tfrom-tto;bq[i].to+=ttext.length+tfrom-tto}bq[i].version++;bq[i].version=bq[i].version%65536}for(var i=0;i<q.length;i++){q[i].version++;q[i].version=q[i].version%65536}bps=bps.substr(0,data.from)+data.text+bps.substr(data.to);if(debugLock)old_bps=old_bps.substr(0,data.from)+data.text+old_bps.substr(data.to);if(data.to==data.from+1){if(data.text=="1"){var element=$('<div><img src="images/breakpoint.png" /></div>').get(0);editor.setGutterMarker(data.from,"breakpoints",element)}else if(data.text=="0"){var info=editor.lineInfo(data.from);if(info.gutterMarkers&&info.gutterMarkers["breakpoints"]){editor.setGutterMarker(data.from,"breakpoints",null)}}}doc.version++;doc.version=doc.version%65536;if(bq.length>0){socket.emit("bps",bq[0])}});socket.on("change",function(data){lock=true;var tfrom=data.from;var tto=data.to;var ttext=data.text;for(var i=0;i<q.length;i++){if(q[i].to<=tfrom){tfrom+=q[i].text.length+q[i].from-q[i].to;tto+=q[i].text.length+q[i].from-q[i].to}else if(q[i].to<=tto&&q[i].from<=tfrom){var tdlen=tto-q[i].to;q[i].to=tfrom;tfrom=q[i].from+q[i].text.length;tto=tfrom+tdlen}else if(q[i].to<=tto&&q[i].from>tfrom){tto=tto+q[i].text.length+q[i].from-q[i].to;ttext=q[i].text+ttext;q[i].from=tfrom;q[i].to=tfrom}else if(q[i].to>tto&&q[i].from<=tfrom){var qlen=q[i].text.length;q[i].to=q[i].to+ttext.length+tfrom-tto;q[i].text=q[i].text+ttext;tfrom=q[i].from+qlen;tto=tfrom}else if(q[i].to>tto&&q[i].from<=tto){var qdlen=q[i].to-tto;tto=q[i].from;q[i].from=tfrom+ttext.length;q[i].to=q[i].from+qdlen}else if(q[i].from>tto){q[i].from+=ttext.length+tfrom-tto;q[i].to+=ttext.length+tfrom-tto}q[i].version++;q[i].version=q[i].version%65536}for(var i=0;i<bq.length;i++){bq[i].version++;bq[i].version=bq[i].version%65536}if(bufferfrom!=-1){if(bufferto==-1){if(bufferfrom<=tfrom){tfrom+=buffertext.length;tto+=buffertext.length}else if(bufferfrom<=tto){tto+=buffertext.length;ttext=buffertext+ttext;bufferfrom=tfrom}else{bufferfrom+=ttext.length+tfrom-tto}}else{if(bufferto<=tfrom){tfrom+=bufferfrom-bufferto;tto+=bufferfrom-bufferto}else if(bufferto<=tto&&bufferfrom<=tfrom){var tdlen=tto-bufferto;bufferto=tfrom;tfrom=bufferfrom;tto=tfrom+tdlen}else if(bufferto<=tto&&bufferfrom>tfrom){tto=tto+bufferfrom-bufferto;bufferfrom=-1;bufferto=-1}else if(bufferto>tto&&bufferfrom<=tfrom){bufferto=bufferto+ttext.length+tfrom-tto;buffertext=buffertext+ttext;tfrom=bufferfrom;tto=tfrom}else if(bufferto>tto&&bufferfrom<=tto){var qdlen=bufferto-tto;tto=bufferfrom;bufferfrom=tfrom+ttext.length;bufferto=bufferfrom+qdlen}else if(bufferfrom>tto){bufferfrom+=ttext.length+tfrom-tto;bufferto+=ttext.length+tfrom-tto}}}var delta=tfrom+ttext.length-tto;var editorDoc=editor.getDoc();var hist=editorDoc.getHistory();var donefrom=new Array(hist.done.length);var doneto=new Array(hist.done.length);for(var i=0;i<hist.done.length;i++){donefrom[i]=editor.indexFromPos(hist.done[i].changes[0].from);doneto[i]=editor.indexFromPos(hist.done[i].changes[0].to)}var undonefrom=new Array(hist.undone.length);var undoneto=new Array(hist.undone.length);for(var i=0;i<hist.undone.length;i++){undonefrom[i]=editorDoc.indexFromPos(hist.undone[i].changes[0].from);undoneto[i]=editorDoc.indexFromPos(hist.undone[i].changes[0].to)}for(var i=0;i<hist.done.length;i++){if(doneto[i]<=tfrom){}else if(doneto[i]<=tto&&donefrom[i]<=tfrom){hist.done[i].changes[0].to=editor.posFromIndex(tfrom)}else if(doneto[i]<=tto&&donefrom[i]>tfrom){hist.done[i].changes[0].from=editor.posFromIndex(tfrom);hist.done[i].changes[0].to=editor.posFromIndex(tfrom)}}for(var i=0;i<hist.undone.length;i++){if(undoneto[i]<=tfrom){}else if(undoneto[i]<=tto&&undonefrom[i]<=tfrom){hist.undone[i].changes[0].to=editor.posFromIndex(tfrom)}else if(undoneto[i]<=tto&&undonefrom[i]>tfrom){hist.undone[i].changes[0].from=editor.posFromIndex(tfrom);hist.undone[i].changes[0].to=editor.posFromIndex(tfrom)}}editor.replaceRange(ttext,editor.posFromIndex(tfrom),editor.posFromIndex(tto));for(var i=0;i<hist.done.length;i++){if(doneto[i]<=tfrom){}else if(doneto[i]<=tto&&donefrom[i]<=tfrom){}else if(doneto[i]<=tto&&donefrom[i]>tfrom){}else if(doneto[i]>tto&&donefrom[i]<=tfrom){hist.done[i].changes[0].to=editor.posFromIndex(doneto[i]+delta)}else if(doneto[i]>tto&&donefrom[i]<=tto){hist.done[i].changes[0].from=editor.posFromIndex(tfrom+ttext.length);hist.done[i].changes[0].to=editor.posFromIndex(donefrom[i]+doneto[i]-tto)}else if(donefrom[i]>tto){hist.done[i].changes[0].from=editor.posFromIndex(donefrom[i]+ttext.length+tfrom-tto);hist.done[i].changes[0].to=editor.posFromIndex(doneto[i]+ttext.length+tfrom-tto)}}for(var i=0;i<hist.undone.length;i++){if(undoneto[i]<=tfrom){}else if(undoneto[i]<=tto&&undonefrom[i]<=tfrom){}else if(undoneto[i]<=tto&&undonefrom[i]>tfrom){}else if(undoneto[i]>tto&&undonefrom[i]<=tfrom){hist.undone[i].changes[0].to=editor.posFromIndex(undoneto[i]+delta)}else if(undoneto[i]>tto&&undonefrom[i]<=tto){hist.undone[i].changes[0].from=editor.posFromIndex(tfrom+ttext.length);hist.undone[i].changes[0].to=editor.posFromIndex(undonefrom[i]+undoneto[i]-tto)}else if(undonefrom[i]>tto){hist.undone[i].changes[0].from=editor.posFromIndex(undonefrom[i]+ttext.length+tfrom-tto);hist.undone[i].changes[0].to=editor.posFromIndex(undoneto[i]+ttext.length+tfrom-tto)}}for(var i=0;i<hist.done.length;i++){hist.done[i].anchorAfter=hist.done[i].changes[0].from;hist.done[i].anchorBefore=hist.done[i].changes[0].from;hist.done[i].headAfter=hist.done[i].changes[0].from;hist.done[i].headBefore=hist.done[i].changes[0].from}for(var i=0;i<hist.undone.length;i++){hist.undone[i].anchorAfter=hist.undone[i].changes[0].from;hist.undone[i].anchorBefore=hist.undone[i].changes[0].from;hist.undone[i].headAfter=hist.undone[i].changes[0].from;hist.undone[i].headBefore=hist.undone[i].changes[0].from}editorDoc.setHistory(hist);doc.text=doc.text.substr(0,data.from)+data.text+doc.text.substr(data.to);doc.version++;doc.version=doc.version%65536;if(q.length>0){socket.emit("change",q[0])}var pos=editor.posFromIndex(data.from+data.text.length);cursors[data.name].pos=data.from+data.text.length;editor.addWidget(pos,cursors[data.name].element,false)});var buffertext="";var bufferfrom=-1;var bufferto=-1;var buffertimeout=SAVE_TIME_OUT;function sendbuffer(){if(bufferfrom!=-1){if(bufferto==-1){var req={version:doc.version,from:bufferfrom,to:bufferfrom,text:buffertext};if(q.length==0){socket.emit("change",req)}q.push(req);buffertext="";bufferfrom=-1}else{var req={version:doc.version,from:bufferfrom,to:bufferto,text:buffertext};if(q.length==0){socket.emit("change",req)}q.push(req);bufferfrom=-1;bufferto=-1}buffertimeout=SAVE_TIME_OUT}}function save(){setsaving();if(timer!=null){clearTimeout(timer)}timer=setTimeout("sendbuffer()",buffertimeout)}function registereditorevent(){CodeMirror.on(editor.getDoc(),"change",function(editorDoc,chg){if(debugLock){return true}if(lock){lock=false;return true}var cfrom=editor.indexFromPos(chg.from);var cto=editor.indexFromPos(chg.to);var removetext="";for(var i=0;i<chg.removed.length-1;i++){removetext+=chg.removed[i]+"\n"}removetext+=chg.removed[chg.removed.length-1];cto=cfrom+removetext.length;var cattext="";for(var i=0;i<chg.text.length-1;i++){cattext+=chg.text[i]+"\n"}cattext+=chg.text[chg.text.length-1];var delta=cfrom+cattext.length-cto;for(var k in cursors){if(cto<=cursors[k].pos){cursors[k].pos+=delta;editor.addWidget(editor.posFromIndex(cursors[k].pos),cursors[k].element,false)}else if(cfrom<cursors[k].pos){cursors[k].pos=cfrom+cattext.length;editor.addWidget(editor.posFromIndex(cursors[k].pos),cursors[k].element,false)}}var bfrom=chg.from.line;var bto=chg.to.line;if(chg.text.length!=bto-bfrom+1){sendbuffer();var req={version:doc.version,from:cfrom,to:cto,text:cattext};if(q.length==0){socket.emit("change",req)}q.push(req);var btext="";for(var i=0;i<chg.text.length;i++){btext+=havebreakat(editor,bfrom+i)}sendbreak(bfrom,bto+1,btext);return}if(chg.text.length>1){buffertimeout=buffertimeout/2}if(bufferto==-1&&cfrom==cto&&(cfrom==bufferfrom+buffertext.length||bufferfrom==-1)){if(bufferfrom==-1){buffertext=cattext;bufferfrom=cfrom}else{buffertext+=cattext}save();return}else if(bufferto==-1&&chg.origin=="+delete"&&bufferfrom!=-1&&cto==bufferfrom+buffertext.length&&cfrom>=bufferfrom){buffertext=buffertext.substr(0,cfrom-bufferfrom);if(buffertext.length==0){bufferfrom=-1;if(q.length==0){setsaved()}return}save();return}else if(chg.origin=="+delete"&&bufferfrom==-1){bufferfrom=cfrom;bufferto=cto;buffertext="";save();return}else if(bufferto!=-1&&chg.origin=="+delete"&&cto==bufferfrom){bufferfrom=cfrom;save();return}else if(bufferfrom!=-1){if(bufferto==-1){var req={version:doc.version,from:bufferfrom,to:bufferfrom,text:buffertext};if(q.length==0){socket.emit("change",req)}q.push(req);buffertext="";bufferfrom=-1}else{var req={version:doc.version,from:bufferfrom,to:bufferto,text:buffertext};if(q.length==0){socket.emit("change",req)}q.push(req);bufferfrom=-1;bufferto=-1}}var req={version:doc.version,from:cfrom,to:cto,text:cattext};if(q.length==0){socket.emit("change",req)}q.push(req)})}